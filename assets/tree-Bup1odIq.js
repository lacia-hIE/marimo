var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{c as n,fI as r,fJ as i,r as o,fK as s,R as a,j as c,e2 as u,p as l,T as d,A as f,bT as h,fL as p,aA as g,c8 as m,fM as v,fN as y,fO as b,bQ as w,fP as x,fQ as T,dx as D,fR as S,ae as R,bI as O,ah as C,cb as j,fS as E,fT as k,a as P,az as N,aF as _,af as I,fU as M,eF as q,fV as A,fW as L,cd as F,fX as H,ei as U,fY as W,bK as B,ax as z,u as V,L as $,bz as K,B as G,dL as J,aa as X,v as Y,fv as Q,_ as Z,g as ee,b1 as te,av as ne,b2 as re,F as ie,O as oe,k as se,fZ as ae,f_ as ce,aZ as ue,a4 as le,f$ as de,g0 as fe,a6 as he,a7 as pe,a8 as ge,ag as me,g1 as ve,I as ye,by as be,e7 as we,e8 as xe,ak as Te,ea as De,eb as Se,ec as Re,g2 as Oe,ed as Ce,C as je,g3 as Ee,eg as ke,g4 as Pe,ee as Ne,a$ as _e,g5 as Ie,ef as Me,e9 as qe,a_ as Ae,g6 as Le,g7 as Fe,g8 as He,b0 as Ue,bX as We,dt as Be,b_ as ze,cW as Ve,dH as $e}from"./index-CaEtVMzc.js";import{e as Ke}from"./index-BgkBZJF1.js";
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=n("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Je=n("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Xe=n("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye={},Qe=(...e)=>{nt(e[0])&&Ye[e[0]]||(nt(e[0])&&(Ye[e[0]]=new Date),((...e)=>{(null==console?void 0:console.warn)&&(nt(e[0])&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e))})(...e))},Ze=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout((()=>{e.off("initialized",n)}),0),t()};e.on("initialized",n)}},et=(e,t,n)=>{e.loadNamespaces(t,Ze(e,n))},tt=(e,t,n,r)=>{nt(n)&&(n=[n]),n.forEach((t=>{e.options.ns.indexOf(t)<0&&e.options.ns.push(t)})),e.loadLanguages(t,Ze(e,r))},nt=e=>"string"==typeof e,rt=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,it={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},ot=e=>it[e];let st={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(rt,ot)};const at=o.createContext();class ct{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach((e=>{var t;(t=this.usedNamespaces)[e]??(t[e]=!0)}))}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const ut=(e,t,n,r)=>e.getFixedT(t,n,r),lt=(e,t={})=>{var n,r,i,s;const{i18n:a}=t,{i18n:c,defaultNS:u}=o.useContext(at)||{},l=a||c||void 0;if(l&&!l.reportNamespaces&&(l.reportNamespaces=new ct),!l){Qe("You will need to pass in an i18next instance by using initReactI18next");const e=(e,t)=>{return nt(t)?t:"object"==typeof(n=t)&&null!==n&&nt(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e;var n},t=[e,{},!1];return t.t=e,t.i18n={},t.ready=!1,t}(null==(n=l.options.react)?void 0:n.wait)&&Qe("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const d={...st,...l.options.react,...t},{useSuspense:f,keyPrefix:h}=d;let p=u||(null==(r=l.options)?void 0:r.defaultNS);p=nt(p)?[p]:p||["translation"],null==(s=(i=l.reportNamespaces).addUsedNamespaces)||s.call(i,p);const g=(l.isInitialized||l.initializedStoreOnce)&&p.every((e=>((e,t,n={})=>t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:n.lng,precheck:(t,r)=>{var i;if((null==(i=n.bindI18n)?void 0:i.indexOf("languageChanging"))>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!r(t.isLanguageChangingTo,e))return!1}}):(Qe("i18n.languages were undefined or empty",t.languages),!0))(e,l,d))),m=((e,t,n,r)=>o.useCallback(ut(e,t,n,r),[e,t,n,r]))(l,t.lng||null,"fallback"===d.nsMode?p:p[0],h),v=()=>m,y=()=>ut(l,t.lng||null,"fallback"===d.nsMode?p:p[0],h),[b,w]=o.useState(v);let x=p.join();t.lng&&(x=`${t.lng}${x}`);const T=((e,t)=>{const n=o.useRef();return o.useEffect((()=>{n.current=e}),[e,t]),n.current})(x),D=o.useRef(!0);o.useEffect((()=>{const{bindI18n:e,bindI18nStore:n}=d;D.current=!0,g||f||(t.lng?tt(l,t.lng,p,(()=>{D.current&&w(y)})):et(l,p,(()=>{D.current&&w(y)}))),g&&T&&T!==x&&D.current&&w(y);const r=()=>{D.current&&w(y)};return e&&(null==l||l.on(e,r)),n&&(null==l||l.store.on(n,r)),()=>{D.current=!1,l&&(null==e||e.split(" ").forEach((e=>l.off(e,r)))),n&&l&&n.split(" ").forEach((e=>l.store.off(e,r)))}}),[l,x]),o.useEffect((()=>{D.current&&g&&w(v)}),[l,h,g]);const S=[b,l,g];if(S.t=b,S.i18n=l,S.ready=g,g)return S;if(!g&&!f)return S;throw new Promise((e=>{t.lng?tt(l,t.lng,p,(()=>e())):et(l,p,(()=>e()))}))},dt=s("flex items-center justify-center m-0 leading-none font-medium border border-foreground/10 shadow-xsSolid hover:cursor-pointer active:shadow-none dark:border-border text-sm",{variants:{color:{gray:"mo-button gray",white:"mo-button white",green:"mo-button green",red:"mo-button red",yellow:"mo-button yellow","hint-green":"mo-button hint-green",disabled:"mo-button disabled"},shape:{rectangle:"rounded",circle:"rounded-full"},size:{small:"",medium:""}},compoundVariants:[{size:"small",shape:"circle",class:"h-[24px] w-[24px] px-[5.5px] py-[5.5px]"},{size:"medium",shape:"circle",class:"px-2 py-2"},{size:"small",shape:"rectangle",class:"px-1 py-1 h-[24px] w-[24px]"},{size:"medium",shape:"rectangle",class:"px-3 py-2"}],defaultVariants:{color:"gray",size:"medium",shape:"rectangle"}}),ft=s("font-mono w-full flex-1 inline-flex items-center justify-center rounded px-2.5 text-foreground/60 h-[36px] hover:shadow-md hover:cursor-pointer focus:shadow-md focus:outline-none text-[hsl(0, 0%, 43.5%)] bg-transparent hover:bg-background focus:bg-background"),ht=a.forwardRef((({color:e,shape:t,size:n,className:r,...i},o)=>c.jsx("button",{ref:o,className:u(dt({color:e,shape:t,size:n}),r),...i,children:i.children})));ht.displayName="Button";a.forwardRef((({className:e,...t},n)=>c.jsx("input",{ref:n,className:u(ft(),e),...t}))).displayName="Input";const pt=e=>{const{openConfirm:t,closeModal:n}=l();return c.jsx(d,{content:"Shutdown",children:c.jsx(ht,{"aria-label":"Shutdown","data-testid":"shutdown-button",shape:"circle",size:"small",color:"red",className:"h-[27px] w-[27px]",onClick:r=>{r.stopPropagation(),t({title:"Shutdown",description:e.description,variant:"destructive",confirmAction:c.jsx(f,{onClick:e=>{p(),setTimeout((()=>{window.close()}),200),n()},"aria-label":"Confirm Shutdown",children:"Shutdown"})})},children:c.jsx(h,{strokeWidth:1})})})};function gt(e,t){const{delayMs:n,whenVisible:r,disabled:i=!1}=t,s=o.useRef();return o.useEffect((()=>{s.current=e}),[e]),o.useEffect((()=>{if(null===n||i)return;const e=setInterval((()=>{var e;r&&"visible"!==document.visibilityState||null==(e=s.current)||e.call(s)}),n);return()=>clearInterval(e)}),[n,r,i]),g(document,"visibilitychange",(()=>{var e;"visible"===document.visibilityState&&r&&!i&&(null==(e=s.current)||e.call(s))})),null}function mt(e){return vt(),[m.of([{key:"j",run:t=>!(!v(t,!0)||!y(t))&&(e.focusDown(),!0)}]),m.of([{key:"k",run:t=>!(!b(t)||!y(t))&&(e.focusUp(),!0)}]),w.define((e=>(bt.INSTANCES.addInstance(e),{destroy(){bt.INSTANCES.removeInstance(e)}})))]}const vt=x((()=>{T.defineAction("goToDefinition",(e=>{const t=e.cm6;return D(t)})),T.mapCommand("gd","action","goToDefinition",{},{context:"normal"})})),yt=class{constructor(){t(this,"instances",new Set),t(this,"isBroadcasting",!1)}addInstance(e){this.instances.add(e);const t=S(e);t?t.on("vim-mode-change",(t=>{if(this.isBroadcasting)return;O("mode"in t,'Expected event to have a "mode" property');const n=t.mode;this.isBroadcasting=!0,this.broadcastModeChange(e,n),this.isBroadcasting=!1})):R.warn("Expected CodeMirror instance to have CodeMirror instance state")}removeInstance(e){this.instances.delete(e)}broadcastModeChange(e,t){O("exitInsertMode"in T,"Vim does not have an exitInsertMode method"),O("exitVisualMode"in T,"Vim does not have an exitVisualMode method");for(const n of this.instances)if(n!==e){const e=S(n);if(!e){R.warn("Expected CodeMirror instance to have CodeMirror instance state");continue}const r=e.setSelections.bind(e);e.setSelections=()=>[];const i=e.state.vim;if(!i){R.warn("Expected CodeMirror instance to have Vim state");continue}switch(t){case"normal":i.insertMode&&T.exitInsertMode(e,!0),i.visualMode&&T.exitVisualMode(e,!0);break;case"insert":i.insertMode||T.handleKey(e,"i","")}e.setSelections=r}}};t(yt,"INSTANCES",new yt);let bt=yt;const wt=["default","vim"];function xt(e,t){switch(e.preset){case"default":return[m.of(k),m.of([{key:"Escape",preventDefault:!0,run:e=>(e.contentDOM.blur(),!0)}])];case"vim":return[j.highest(Tt("d",(e=>""===e.state.doc.toString()),(e=>""===e.state.doc.toString()&&(t.deleteCell(),!0)))),E({status:!1}),mt(t),m.of(k)];default:return C(e.preset),[]}}function Tt(e,t,n){let r="",i=0;return m.of([{any:(o,s)=>{const a=s.key,c=s.timeStamp;if(a!==e||!t(o))return r="",i=0,!1;if(r===e&&c-i<500){if(n(o))return r="",i=0,!0}return r=a,i=c,!1}}])}const Dt="marimo:copilot:signedIn",St=P(Dt,null,void 0,{getOnInit:!0}),Rt=N(null);function Ot(){const e="true"===localStorage.getItem(Dt),t=I();return e&&"github"===t.completion.copilot}var Ct,jt={},Et={},kt={exports:{}},Pt="object"==typeof Reflect?Reflect:null,Nt=Pt&&"function"==typeof Pt.apply?Pt.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};Ct=Pt&&"function"==typeof Pt.ownKeys?Pt.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var _t=Number.isNaN||function(e){return e!=e};function It(){It.init.call(this)}kt.exports=It,kt.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}zt(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&zt(e,"error",t,n)}(e,i,{once:!0})}))},It.EventEmitter=It,It.prototype._events=void 0,It.prototype._eventsCount=0,It.prototype._maxListeners=void 0;var Mt=10;function qt(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function At(e){return void 0===e._maxListeners?It.defaultMaxListeners:e._maxListeners}function Lt(e,t,n,r){var i,o,s,a;if(qt(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=At(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function Ft(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ht(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Ft.bind(r);return i.listener=n,r.wrapFn=i,i}function Ut(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):Bt(i,i.length)}function Wt(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function Bt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function zt(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(It,"defaultMaxListeners",{enumerable:!0,get:function(){return Mt},set:function(e){if("number"!=typeof e||e<0||_t(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Mt=e}}),It.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},It.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||_t(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},It.prototype.getMaxListeners=function(){return At(this)},It.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)Nt(a,this,t);else{var c=a.length,u=Bt(a,c);for(n=0;n<c;++n)Nt(u[n],this,t)}return!0},It.prototype.addListener=function(e,t){return Lt(this,e,t,!1)},It.prototype.on=It.prototype.addListener,It.prototype.prependListener=function(e,t){return Lt(this,e,t,!0)},It.prototype.once=function(e,t){return qt(t),this.on(e,Ht(this,e,t)),this},It.prototype.prependOnceListener=function(e,t){return qt(t),this.prependListener(e,Ht(this,e,t)),this},It.prototype.removeListener=function(e,t){var n,r,i,o,s;if(qt(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},It.prototype.off=It.prototype.removeListener,It.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},It.prototype.listeners=function(e){return Ut(this,e,!0)},It.prototype.rawListeners=function(e){return Ut(this,e,!1)},It.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Wt.call(e,t)},It.prototype.listenerCount=Wt,It.prototype.eventNames=function(){return this._eventsCount>0?Ct(this._events):[]};var Vt=kt.exports;!function(e){var t=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},n=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultNextRequest=void 0;var r=Vt;e.defaultNextRequest=function(){var e=-1;return function(){return++e}};var i=function(){function i(t,n){void 0===n&&(n=e.defaultNextRequest()),this.batch=[],this.batchStarted=!1,this.lastId=-1,this.transports=t,this.requests={},this.connectPromise=this.connect(),this.requestChannel=new r.EventEmitter,this.nextID=n}return i.prototype.connect=function(){var e=this;return Promise.all(this.transports.map((function(r){return t(e,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return r.subscribe("error",this.handleError.bind(this)),r.subscribe("notification",this.handleNotification.bind(this)),[4,r.connect()];case 1:return e.sent(),[2]}}))}))})))},i.prototype.getPrimaryTransport=function(){return this.transports[0]},i.prototype.request=function(e,r,i){return void 0===r&&(r=!1),t(this,void 0,void 0,(function(){var t,o,s,a=this;return n(this,(function(n){return t=this.nextID().toString(),o=r?null:t,s={request:this.makeRequest(e.method,e.params||[],o),internalID:t},this.batchStarted?[2,new Promise((function(e,t){a.batch.push({resolve:e,reject:t,request:s})}))]:[2,this.getPrimaryTransport().sendData(s,i)]}))}))},i.prototype.close=function(){this.requestChannel.removeAllListeners(),this.transports.forEach((function(e){e.unsubscribe(),e.close()}))},i.prototype.startBatch=function(){this.batchStarted=!0},i.prototype.stopBatch=function(){if(!1===this.batchStarted)throw new Error("cannot end that which has never started");0!==this.batch.length?(this.getPrimaryTransport().sendData(this.batch),this.batch=[],this.batchStarted=!1):this.batchStarted=!1},i.prototype.makeRequest=function(e,t,n){return n?{jsonrpc:"2.0",id:n,method:e,params:t}:{jsonrpc:"2.0",method:e,params:t}},i.prototype.handleError=function(e){this.requestChannel.emit("error",e)},i.prototype.handleNotification=function(e){this.requestChannel.emit("notification",e)},i}();e.default=i}(Et);var $t={},Kt={},Gt={},Jt={};!function(e){var t=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.convertJSONToRPCError=e.JSONRPCError=e.ERR_UNKNOWN=e.ERR_MISSIING_ID=e.ERR_TIMEOUT=void 0,e.ERR_TIMEOUT=7777,e.ERR_MISSIING_ID=7878,e.ERR_UNKNOWN=7979;var n=function(e){function n(t,n,r){var i=this.constructor,o=e.call(this,t)||this;return o.message=t,o.code=n,o.data=r,Object.setPrototypeOf(o,i.prototype),o}return t(n,e),n}(Error);e.JSONRPCError=n,e.convertJSONToRPCError=function(t){if(t.error){var r=t.error,i=r.message,o=r.code,s=r.data;return new n(i,o,s)}return new n("Unknown error",e.ERR_UNKNOWN,t)}}(Jt),Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.TransportRequestManager=void 0;var Xt=Vt,Yt=Jt,Qt=function(){function e(){this.pendingRequest={},this.pendingBatchRequest={},this.transportEventChannel=new Xt.EventEmitter}return e.prototype.addRequest=function(e,t){return this.transportEventChannel.emit("pending",e),e instanceof Array?(this.addBatchReq(e,t),Promise.resolve()):this.addReq(e.internalID,t)},e.prototype.settlePendingRequest=function(e,t){var n=this;e.forEach((function(e){var r=n.pendingRequest[e.internalID];delete n.pendingBatchRequest[e.internalID],void 0!==r&&(t?r.reject(t):(r.resolve(),null!==e.request.id&&void 0!==e.request.id||delete n.pendingRequest[e.internalID]))}))},e.prototype.isPendingRequest=function(e){return this.pendingRequest.hasOwnProperty(e)},e.prototype.resolveResponse=function(e,t){void 0===t&&(t=!0);var n=e;try{if(n=JSON.parse(e),!1===this.checkJSONRPC(n))return;return n instanceof Array?this.resolveBatch(n,t):this.resolveRes(n,t)}catch(i){var r=new Yt.JSONRPCError("Bad response format",Yt.ERR_UNKNOWN,e);return t&&this.transportEventChannel.emit("error",r),r}},e.prototype.addBatchReq=function(e,t){var n=this;return e.forEach((function(e){var t=e.resolve,r=e.reject,i=e.request.internalID;n.pendingBatchRequest[i]=!0,n.pendingRequest[i]={resolve:t,reject:r}})),Promise.resolve()},e.prototype.addReq=function(e,t){var n=this;return new Promise((function(r,i){null!==t&&t&&n.setRequestTimeout(e,t,i),n.pendingRequest[e]={resolve:r,reject:i}}))},e.prototype.checkJSONRPC=function(e){var t=[e];return e instanceof Array&&(t=e),t.every((function(e){return void 0!==e.result||void 0!==e.error||void 0!==e.method}))},e.prototype.processResult=function(e,t){if(e.error){var n=Yt.convertJSONToRPCError(e);t.reject(n)}else t.resolve(e.result)},e.prototype.resolveBatch=function(e,t){var n=this,r=e.map((function(e){return n.resolveRes(e,t)})).filter((function(e){return e}));if(r.length>0)return r[0]},e.prototype.resolveRes=function(e,t){var n,r=e.id,i=e.error,o=this.pendingRequest[r];return o?(delete this.pendingRequest[r],this.processResult(e,o),void this.transportEventChannel.emit("response",e)):void 0!==r||void 0!==i?(i&&(n=Yt.convertJSONToRPCError(e)),t&&i&&n&&this.transportEventChannel.emit("error",n),n):void this.transportEventChannel.emit("notification",e)},e.prototype.setRequestTimeout=function(e,t,n){var r=this;setTimeout((function(){delete r.pendingRequest[e],n(new Yt.JSONRPCError("Request timeout request took longer than "+t+" ms to resolve",Yt.ERR_TIMEOUT))}),t)},e}();Gt.TransportRequestManager=Qt,Object.defineProperty(Kt,"__esModule",{value:!0});var Zt=Kt.Transport=void 0,en=Gt,tn=function(){function e(){this.transportRequestManager=new en.TransportRequestManager,this.transportRequestManager.transportEventChannel.on("error",(function(){}))}return e.prototype.subscribe=function(e,t){this.transportRequestManager.transportEventChannel.addListener(e,t)},e.prototype.unsubscribe=function(e,t){if(!e)return this.transportRequestManager.transportEventChannel.removeAllListeners();e&&t&&this.transportRequestManager.transportEventChannel.removeListener(e,t)},e.prototype.parseData=function(e){return e instanceof Array?e.map((function(e){return e.request.request})):e.request},e}();Zt=Kt.Transport=tn;var nn,rn={};nn=rn,Object.defineProperty(nn,"__esModule",{value:!0}),nn.getNotifications=nn.getBatchRequests=nn.isNotification=void 0,nn.isNotification=function(e){return void 0===e.request.id||null===e.request.id},nn.getBatchRequests=function(e){return e instanceof Array?e.filter((function(e){var t=e.request.request.id;return null!=t})).map((function(e){return e.request})):[]},nn.getNotifications=function(e){return e instanceof Array?e.filter((function(e){return nn.isNotification(e.request)})).map((function(e){return e.request})):nn.isNotification(e)?[e]:[]};var on=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty($t,"__esModule",{value:!0});var sn=rn,an=Jt,cn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.connection=t,i.reqUri=n,i.resUri=r,i}return on(t,e),t.prototype.connect=function(){var e=this;return this.connection.on(this.resUri,(function(t){e.transportRequestManager.resolveResponse(t)})),Promise.resolve()},t.prototype.sendData=function(e,t){void 0===t&&(t=null);var n=this.transportRequestManager.addRequest(e,t),r=sn.getNotifications(e),i=this.parseData(e);try{return this.connection.emit(this.reqUri,i),this.transportRequestManager.settlePendingRequest(r),n}catch(s){var o=new an.JSONRPCError(s.message,an.ERR_UNKNOWN,s);return this.transportRequestManager.settlePendingRequest(r,o),Promise.reject(o)}},t.prototype.close=function(){this.connection.removeAllListeners()},t}(Kt.Transport);$t.default=cn;var un={},ln="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},dn="URLSearchParams"in ln,fn="Symbol"in ln&&"iterator"in Symbol,hn="FileReader"in ln&&"Blob"in ln&&function(){try{return new Blob,!0}catch(e){return!1}}(),pn="FormData"in ln,gn="ArrayBuffer"in ln;if(gn)var mn=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],vn=ArrayBuffer.isView||function(e){return e&&mn.indexOf(Object.prototype.toString.call(e))>-1};function yn(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function bn(e){return"string"!=typeof e&&(e=String(e)),e}function wn(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return fn&&(t[Symbol.iterator]=function(){return t}),t}function xn(e){this.map={},e instanceof xn?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function Tn(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function Dn(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function Sn(e){var t=new FileReader,n=Dn(t);return t.readAsArrayBuffer(e),n}function Rn(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function On(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:hn&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:pn&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:dn&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():gn&&hn&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=Rn(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):gn&&(ArrayBuffer.prototype.isPrototypeOf(e)||vn(e))?this._bodyArrayBuffer=Rn(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):dn&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},hn&&(this.blob=function(){var e=Tn(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=Tn(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(hn)return this.blob().then(Sn);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,n,r,i,o=Tn(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=Dn(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type),i=r?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},pn&&(this.formData=function(){return this.text().then(En)}),this.json=function(){return this.text().then(JSON.parse)},this}xn.prototype.append=function(e,t){e=yn(e),t=bn(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},xn.prototype.delete=function(e){delete this.map[yn(e)]},xn.prototype.get=function(e){return e=yn(e),this.has(e)?this.map[e]:null},xn.prototype.has=function(e){return this.map.hasOwnProperty(yn(e))},xn.prototype.set=function(e,t){this.map[yn(e)]=bn(t)},xn.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},xn.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),wn(e)},xn.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),wn(e)},xn.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),wn(e)},fn&&(xn.prototype[Symbol.iterator]=xn.prototype.entries);var Cn=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function jn(e,t){if(!(this instanceof jn))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof jn){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new xn(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new xn(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),Cn.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in ln)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function En(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function kn(e,t){if(!(this instanceof kn))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new xn(t.headers),this.url=t.url||"",this._initBody(e)}jn.prototype.clone=function(){return new jn(this,{body:this._bodyInit})},On.call(jn.prototype),On.call(kn.prototype),kn.prototype.clone=function(){return new kn(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new xn(this.headers),url:this.url})},kn.error=function(){var e=new kn(null,{status:200,statusText:""});return e.status=0,e.type="error",e};var Pn=[301,302,303,307,308];kn.redirect=function(e,t){if(-1===Pn.indexOf(t))throw new RangeError("Invalid status code");return new kn(null,{status:t,headers:{location:e}})};var Nn=ln.DOMException;try{new Nn}catch(Fm){(Nn=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),Nn.prototype.constructor=Nn}function _n(e,t){return new Promise((function(n,r){var i=new jn(e,t);if(i.signal&&i.signal.aborted)return r(new Nn("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}if(o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new xn,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(o){console.warn("Response "+o.message)}}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;setTimeout((function(){n(new kn(i,r))}),0)},o.onerror=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},o.ontimeout=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},o.onabort=function(){setTimeout((function(){r(new Nn("Aborted","AbortError"))}),0)},o.open(i.method,function(e){try{return""===e&&ln.location.href?ln.location.href:e}catch(t){return e}}(i.url),!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&(hn?o.responseType="blob":gn&&(o.responseType="arraybuffer")),t&&"object"==typeof t.headers&&!(t.headers instanceof xn||ln.Headers&&t.headers instanceof ln.Headers)){var a=[];Object.getOwnPropertyNames(t.headers).forEach((function(e){a.push(yn(e)),o.setRequestHeader(e,bn(t.headers[e]))})),i.headers.forEach((function(e,t){-1===a.indexOf(t)&&o.setRequestHeader(t,e)}))}else i.headers.forEach((function(e,t){o.setRequestHeader(t,e)}));i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",s)}),o.send(void 0===i._bodyInit?null:i._bodyInit)}))}_n.polyfill=!0,ln.fetch||(ln.fetch=_n,ln.Headers=xn,ln.Request=jn,ln.Response=kn);var In=self.fetch.bind(self),Mn=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qn=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},An=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ln=A&&A.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(un,"__esModule",{value:!0}),un.HTTPTransport=void 0;var Fn=Ln(In),Hn=rn,Un=Jt,Wn=function(e){function t(n,r){var i=e.call(this)||this;return i.onlyNotifications=function(e){return e instanceof Array?e.every((function(e){return null===e.request.request.id||void 0===e.request.request.id})):null===e.request.id||void 0===e.request.id},i.uri=n,i.credentials=r&&r.credentials,i.headers=t.setupHeaders(r&&r.headers),i.injectedFetcher=null==r?void 0:r.fetcher,i}return Mn(t,e),t.prototype.connect=function(){return Promise.resolve()},t.prototype.sendData=function(e,t){return void 0===t&&(t=null),qn(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u;return An(this,(function(l){switch(l.label){case 0:n=this.transportRequestManager.addRequest(e,t),r=Hn.getNotifications(e),i=Hn.getBatchRequests(e),o=this.injectedFetcher||Fn.default,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,o(this.uri,{method:"POST",headers:this.headers,body:JSON.stringify(this.parseData(e)),credentials:this.credentials})];case 2:return s=l.sent(),this.transportRequestManager.settlePendingRequest(r),this.onlyNotifications(e)?[2,Promise.resolve()]:[4,s.text()];case 3:return a=l.sent(),(u=this.transportRequestManager.resolveResponse(a))?(this.transportRequestManager.settlePendingRequest(i,u),[2,Promise.reject(u)]):[3,5];case 4:return c=l.sent(),u=new Un.JSONRPCError(c.message,Un.ERR_UNKNOWN,c),this.transportRequestManager.settlePendingRequest(r,u),this.transportRequestManager.settlePendingRequest(Hn.getBatchRequests(e),u),[2,Promise.reject(u)];case 5:return[2,n]}}))}))},t.prototype.close=function(){},t.setupHeaders=function(e){var t=new Headers(e);return t.set("Content-Type","application/json"),t},t}(Kt.Transport);un.HTTPTransport=Wn,un.default=Wn;var Bn={},zn=null;"undefined"!=typeof WebSocket?zn=WebSocket:"undefined"!=typeof MozWebSocket?zn=MozWebSocket:"undefined"!=typeof global?zn=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window?zn=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(zn=self.WebSocket||self.MozWebSocket);const Vn=zn,$n=L(Object.freeze(Object.defineProperty({__proto__:null,default:Vn},Symbol.toStringTag,{value:"Module"})));var Kn=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gn=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Jn=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Xn=A&&A.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bn,"__esModule",{value:!0});var Yn=Xn($n),Qn=rn,Zn=Jt,er=function(e){function t(t){var n=e.call(this)||this;return n.uri=t,n.connection=new Yn.default(t),n}return Kn(t,e),t.prototype.connect=function(){var e=this;return new Promise((function(t,n){var r=function(){e.connection.removeEventListener("open",r),t()};e.connection.addEventListener("open",r),e.connection.addEventListener("message",(function(t){var n=t.data;e.transportRequestManager.resolveResponse(n)}))}))},t.prototype.sendData=function(e,t){return void 0===t&&(t=5e3),Gn(this,void 0,void 0,(function(){var n,r,i;return Jn(this,(function(o){n=this.transportRequestManager.addRequest(e,t),r=Qn.getNotifications(e);try{this.connection.send(JSON.stringify(this.parseData(e))),this.transportRequestManager.settlePendingRequest(r)}catch(Fm){i=new Zn.JSONRPCError(Fm.message,Zn.ERR_UNKNOWN,Fm),this.transportRequestManager.settlePendingRequest(r,i),this.transportRequestManager.settlePendingRequest(Qn.getBatchRequests(e),i),n=Promise.reject(i)}return[2,n]}))}))},t.prototype.close=function(){this.connection.close()},t}(Kt.Transport);Bn.default=er;var tr={},nr=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rr=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ir=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(tr,"__esModule",{value:!0});var or=rn,sr=function(e){function t(t){var n=e.call(this)||this;return n.messageHandler=function(e){n.transportRequestManager.resolveResponse(JSON.stringify(e.data))},n.uri=t,n.postMessageID="post-message-transport-"+Math.random(),n}return nr(t,e),t.prototype.createWindow=function(e){return new Promise((function(t,n){var r,i,o;i=e,o=window.screen.height,r=window.open(i,"inspector:popup","left=0,top=0,width=400,height="+o+",resizable,scrollbars=yes,status=1"),setTimeout((function(){t(r)}),3e3)}))},t.prototype.connect=function(){var e=this,t=/^(http|https):\/\/.*$/;return new Promise((function(n,r){return rr(e,void 0,void 0,(function(){var e;return ir(this,(function(i){switch(i.label){case 0:return t.test(this.uri)||r(new Error("Bad URI")),e=this,[4,this.createWindow(this.uri)];case 1:return e.frame=i.sent(),window.addEventListener("message",this.messageHandler),n(),[2]}}))}))}))},t.prototype.sendData=function(e,t){return rr(this,void 0,void 0,(function(){var t,n;return ir(this,(function(r){return t=this.transportRequestManager.addRequest(e,null),n=or.getNotifications(e),this.frame&&(this.frame.postMessage(e.request,this.uri),this.transportRequestManager.settlePendingRequest(n)),[2,t]}))}))},t.prototype.close=function(){this.frame&&(window.removeEventListener("message",this.messageHandler),this.frame.close())},t}(Kt.Transport);tr.default=sr;var ar={},cr=A&&A.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ur=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},lr=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(ar,"__esModule",{value:!0});var dr=rn,fr=function(e){function t(t){var n=e.call(this)||this;return n.messageHandler=function(e){n.transportRequestManager.resolveResponse(JSON.stringify(e.data))},n.uri=t,n.postMessageID="post-message-transport-"+Math.random(),n}return cr(t,e),t.prototype.createWindow=function(e){var t=this;return new Promise((function(n,r){var i,o=document.createElement("iframe");o.setAttribute("id",t.postMessageID),o.setAttribute("width","0px"),o.setAttribute("height","0px"),o.setAttribute("style","visiblity:hidden;border:none;outline:none;"),o.addEventListener("load",(function(){n(i)})),o.setAttribute("src",e),window.document.body.appendChild(o),i=o.contentWindow}))},t.prototype.connect=function(){var e=this,t=/^(http|https):\/\/.*$/;return new Promise((function(n,r){return ur(e,void 0,void 0,(function(){var e;return lr(this,(function(i){switch(i.label){case 0:return t.test(this.uri)||r(new Error("Bad URI")),e=this,[4,this.createWindow(this.uri)];case 1:return e.frame=i.sent(),window.addEventListener("message",this.messageHandler),n(),[2]}}))}))}))},t.prototype.sendData=function(e,t){return ur(this,void 0,void 0,(function(){var t,n;return lr(this,(function(r){return t=this.transportRequestManager.addRequest(e,null),n=dr.getNotifications(e),this.frame&&(this.frame.postMessage(e.request,"*"),this.transportRequestManager.settlePendingRequest(n)),[2,t]}))}))},t.prototype.close=function(){var e=document.getElementById(this.postMessageID);null==e||e.remove(),window.removeEventListener("message",this.messageHandler)},t}(Kt.Transport);ar.default=fr;var hr={},pr=A&&A.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},gr=A&&A.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(hr,"__esModule",{value:!0});var mr=function(){function e(e){this.requestManager=e}return e.prototype.startBatch=function(){return this.requestManager.startBatch()},e.prototype.stopBatch=function(){return this.requestManager.stopBatch()},e.prototype.request=function(e,t){return pr(this,void 0,void 0,(function(){return gr(this,(function(n){switch(n.label){case 0:return this.requestManager.connectPromise?[4,this.requestManager.connectPromise]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2,this.requestManager.request(e,!1,t)]}}))}))},e.prototype.notify=function(e){return pr(this,void 0,void 0,(function(){return gr(this,(function(t){switch(t.label){case 0:return this.requestManager.connectPromise?[4,this.requestManager.connectPromise]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this.requestManager.request(e,!0,null)]}}))}))},e.prototype.onNotification=function(e){this.requestManager.requestChannel.addListener("notification",e)},e.prototype.onError=function(e){this.requestManager.requestChannel.addListener("error",e)},e.prototype.close=function(){this.requestManager.close()},e}();hr.default=mr,function(e){var t=A&&A.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.PostMessageIframeTransport=e.PostMessageWindowTransport=e.JSONRPCError=e.WebSocketTransport=e.EventEmitterTransport=e.HTTPTransport=e.RequestManager=e.Client=void 0;var n=t(Et);e.RequestManager=n.default;var r=t($t);e.EventEmitterTransport=r.default;var i=t(un);e.HTTPTransport=i.default;var o=t(Bn);e.WebSocketTransport=o.default;var s=t(tr);e.PostMessageWindowTransport=s.default;var a=t(ar);e.PostMessageIframeTransport=a.default;var c=Jt;Object.defineProperty(e,"JSONRPCError",{enumerable:!0,get:function(){return c.JSONRPCError}});var u=t(hr);e.Client=u.default,e.default=u.default}(jt);var vr={},yr={},br={},wr={},xr={},Tr={};function Dr(e){return"string"==typeof e||e instanceof String}function Sr(e){return Array.isArray(e)}Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.stringArray=Tr.array=Tr.func=Tr.error=Tr.number=Tr.string=Tr.boolean=void 0,Tr.boolean=function(e){return!0===e||!1===e},Tr.string=Dr,Tr.number=function(e){return"number"==typeof e||e instanceof Number},Tr.error=function(e){return e instanceof Error},Tr.func=function(e){return"function"==typeof e},Tr.array=Sr,Tr.stringArray=function(e){return Sr(e)&&e.every((e=>Dr(e)))},Object.defineProperty(xr,"__esModule",{value:!0}),xr.Message=xr.NotificationType9=xr.NotificationType8=xr.NotificationType7=xr.NotificationType6=xr.NotificationType5=xr.NotificationType4=xr.NotificationType3=xr.NotificationType2=xr.NotificationType1=xr.NotificationType0=xr.NotificationType=xr.RequestType9=xr.RequestType8=xr.RequestType7=xr.RequestType6=xr.RequestType5=xr.RequestType4=xr.RequestType3=xr.RequestType2=xr.RequestType1=xr.RequestType=xr.RequestType0=xr.AbstractMessageSignature=xr.ParameterStructures=xr.ResponseError=xr.ErrorCodes=void 0;const Rr=Tr;var Or,Cr,jr,Er;(Cr=Or||(xr.ErrorCodes=Or={})).ParseError=-32700,Cr.InvalidRequest=-32600,Cr.MethodNotFound=-32601,Cr.InvalidParams=-32602,Cr.InternalError=-32603,Cr.jsonrpcReservedErrorRangeStart=-32099,Cr.serverErrorStart=-32099,Cr.MessageWriteError=-32099,Cr.MessageReadError=-32098,Cr.PendingResponseRejected=-32097,Cr.ConnectionInactive=-32096,Cr.ServerNotInitialized=-32002,Cr.UnknownErrorCode=-32001,Cr.jsonrpcReservedErrorRangeEnd=-32e3,Cr.serverErrorEnd=-32e3;class kr extends Error{constructor(e,t,n){super(t),this.code=Rr.number(e)?e:Or.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,kr.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}xr.ResponseError=kr;class Pr{constructor(e){this.kind=e}static is(e){return e===Pr.auto||e===Pr.byName||e===Pr.byPosition}toString(){return this.kind}}xr.ParameterStructures=Pr,Pr.auto=new Pr("auto"),Pr.byPosition=new Pr("byPosition"),Pr.byName=new Pr("byName");class Nr{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Pr.auto}}xr.AbstractMessageSignature=Nr;xr.RequestType0=class extends Nr{constructor(e){super(e,0)}};xr.RequestType=class extends Nr{constructor(e,t=Pr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};xr.RequestType1=class extends Nr{constructor(e,t=Pr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};xr.RequestType2=class extends Nr{constructor(e){super(e,2)}};xr.RequestType3=class extends Nr{constructor(e){super(e,3)}};xr.RequestType4=class extends Nr{constructor(e){super(e,4)}};xr.RequestType5=class extends Nr{constructor(e){super(e,5)}};xr.RequestType6=class extends Nr{constructor(e){super(e,6)}};xr.RequestType7=class extends Nr{constructor(e){super(e,7)}};xr.RequestType8=class extends Nr{constructor(e){super(e,8)}};xr.RequestType9=class extends Nr{constructor(e){super(e,9)}};xr.NotificationType=class extends Nr{constructor(e,t=Pr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};xr.NotificationType0=class extends Nr{constructor(e){super(e,0)}};xr.NotificationType1=class extends Nr{constructor(e,t=Pr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};xr.NotificationType2=class extends Nr{constructor(e){super(e,2)}};xr.NotificationType3=class extends Nr{constructor(e){super(e,3)}};xr.NotificationType4=class extends Nr{constructor(e){super(e,4)}};xr.NotificationType5=class extends Nr{constructor(e){super(e,5)}};xr.NotificationType6=class extends Nr{constructor(e){super(e,6)}};xr.NotificationType7=class extends Nr{constructor(e){super(e,7)}};xr.NotificationType8=class extends Nr{constructor(e){super(e,8)}};xr.NotificationType9=class extends Nr{constructor(e){super(e,9)}},(Er=jr||(xr.Message=jr={})).isRequest=function(e){const t=e;return t&&Rr.string(t.method)&&(Rr.string(t.id)||Rr.number(t.id))},Er.isNotification=function(e){const t=e;return t&&Rr.string(t.method)&&void 0===e.id},Er.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(Rr.string(t.id)||Rr.number(t.id)||null===t.id)};var _r,Ir,Mr,qr={};Object.defineProperty(qr,"__esModule",{value:!0}),qr.LRUCache=qr.LinkedMap=qr.Touch=void 0,(Mr=Ir||(qr.Touch=Ir={})).None=0,Mr.First=1,Mr.AsOld=Mr.First,Mr.Last=2,Mr.AsNew=Mr.Last;class Ar{constructor(){this[_r]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null==(e=this._head)?void 0:e.value}get last(){var e;return null==(e=this._tail)?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Ir.None){const n=this._map.get(e);if(n)return t!==Ir.None&&this.touch(n,t),n.value}set(e,t,n=Ir.None){let r=this._map.get(e);if(r)r.value=t,n!==Ir.None&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case Ir.None:this.addItemLast(r);break;case Ir.First:this.addItemFirst(r);break;case Ir.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}[(_r=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===Ir.First||t===Ir.Last)if(t===Ir.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Ir.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}qr.LinkedMap=Ar;qr.LRUCache=class extends Ar{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Ir.AsNew){return super.get(e,t)}peek(e){return super.get(e,Ir.None)}set(e,t){return super.set(e,t,Ir.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};var Lr,Fr={};Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.Disposable=void 0,(Lr||(Fr.Disposable=Lr={})).create=function(e){return{dispose:e}};var Hr={},Ur={};let Wr;function Br(){if(void 0===Wr)throw new Error("No runtime abstraction layer installed");return Wr}Object.defineProperty(Ur,"__esModule",{value:!0}),(Br||(Br={})).install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");Wr=e},Ur.default=Br,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.Emitter=Hr.Event=void 0;const zr=Ur;var Vr;!function(e){const t={dispose(){}};e.None=function(){return t}}(Vr||(Hr.Event=Vr={}));class $r{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let r=0,i=this._callbacks.length;r<i;r++)if(this._callbacks[r]===e){if(this._contexts[r]===t)return this._callbacks.splice(r,1),void this._contexts.splice(r,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),r=this._contexts.slice(0);for(let o=0,s=n.length;o<s;o++)try{t.push(n[o].apply(r[o],e))}catch(i){(0,zr.default)().console.error(i)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class Kr{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new $r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),r.dispose=Kr._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}Hr.Emitter=Kr,Kr._noop=function(){};var Gr={};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.CancellationTokenSource=Gr.CancellationToken=void 0;const Jr=Ur,Xr=Tr,Yr=Hr;var Qr,Zr;(Zr=Qr||(Gr.CancellationToken=Qr={})).None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Yr.Event.None}),Zr.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Yr.Event.None}),Zr.is=function(e){const t=e;return t&&(t===Zr.None||t===Zr.Cancelled||Xr.boolean(t.isCancellationRequested)&&!!t.onCancellationRequested)};const ei=Object.freeze((function(e,t){const n=(0,Jr.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}));class ti{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?ei:(this._emitter||(this._emitter=new Yr.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}Gr.CancellationTokenSource=class{get token(){return this._token||(this._token=new ti),this._token}cancel(){this._token?this._token.cancel():this._token=Qr.Cancelled}dispose(){this._token?this._token instanceof ti&&this._token.dispose():this._token=Qr.None}};var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.SharedArrayReceiverStrategy=ni.SharedArraySenderStrategy=void 0;const ri=Gr;var ii,oi;(oi=ii||(ii={})).Continue=0,oi.Cancelled=1;ni.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=ii.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const n=this.buffers.get(t);if(void 0===n)return;const r=new Int32Array(n,0,1);Atomics.store(r,0,ii.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class si{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===ii.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class ai{constructor(e){this.token=new si(e)}cancel(){}dispose(){}}ni.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new ri.CancellationTokenSource:new ai(t)}};var ci={},ui={};Object.defineProperty(ui,"__esModule",{value:!0}),ui.Semaphore=void 0;const li=Ur;ui.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,li.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(Fm){this._active--,e.reject(Fm),this.runNext()}}},Object.defineProperty(ci,"__esModule",{value:!0}),ci.ReadableStreamMessageReader=ci.AbstractMessageReader=ci.MessageReader=void 0;const di=Ur,fi=Tr,hi=Hr,pi=ui;var gi,mi;(gi||(ci.MessageReader=gi={})).is=function(e){let t=e;return t&&fi.func(t.listen)&&fi.func(t.dispose)&&fi.func(t.onError)&&fi.func(t.onClose)&&fi.func(t.onPartialMessage)};class vi{constructor(){this.errorEmitter=new hi.Emitter,this.closeEmitter=new hi.Emitter,this.partialMessageEmitter=new hi.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${fi.string(e.message)?e.message:"unknown"}`)}}ci.AbstractMessageReader=vi,(mi||(mi={})).fromOptions=function(e){let t,n;const r=new Map;let i;const o=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(n=e.contentDecoder,r.set(n.name,n)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)r.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(i=e.contentTypeDecoder,o.set(i.name,i)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)o.set(t.name,t)}return void 0===i&&(i=(0,di.default)().applicationJson.decoder,o.set(i.name,i)),{charset:t,contentDecoder:n,contentDecoders:r,contentTypeDecoder:i,contentTypeDecoders:o}};ci.ReadableStreamMessageReader=class extends vi{constructor(e,t){super(),this.readable=e,this.options=mi.fromOptions(t),this.buffer=(0,di.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new pi.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const n=parseInt(t);if(isNaN(n))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,n=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(n)})).catch((e=>{this.fireError(e)}))}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,di.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};var yi={};Object.defineProperty(yi,"__esModule",{value:!0}),yi.WriteableStreamMessageWriter=yi.AbstractMessageWriter=yi.MessageWriter=void 0;const bi=Ur,wi=Tr,xi=ui,Ti=Hr;var Di,Si;(Di||(yi.MessageWriter=Di={})).is=function(e){let t=e;return t&&wi.func(t.dispose)&&wi.func(t.onClose)&&wi.func(t.onError)&&wi.func(t.write)};class Ri{constructor(){this.errorEmitter=new Ti.Emitter,this.closeEmitter=new Ti.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${wi.string(e.message)?e.message:"unknown"}`)}}yi.AbstractMessageWriter=Ri,(Si||(Si={})).fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,bi.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,bi.default)().applicationJson.encoder}};yi.WriteableStreamMessageWriter=class extends Ri{constructor(e,t){super(),this.writable=e,this.options=Si.fromOptions(t),this.errorCount=0,this.writeSemaphore=new xi.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(r){return this.handleError(r,e),Promise.reject(r)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.AbstractMessageBuffer=void 0;Oi.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,n=0,r=0,i=0;e:for(;n<this._chunks.length;){const e=this._chunks[n];for(r=0;r<e.length;){switch(e[r]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,r++;break e;default:t=0}break;default:t=0}r++}i+=e.byteLength,n++}if(4!==t)return;const o=this._read(i+r),s=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return s;for(let c=0;c<a.length-2;c++){const t=a[c],n=t.indexOf(":");if(-1===n)throw new Error(`Message header must separate key and value using ':'\n${t}`);const r=t.substr(0,n),i=t.substr(n+1).trim();s.set(e?r.toLowerCase():r,i)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const r=this._chunks[0];if(r.byteLength>e){const i=r.slice(0,e);t.set(i,n),n+=e,this._chunks[0]=r.slice(e),this._totalLength-=e,e-=e}else t.set(r,n),n+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,e-=r.byteLength}return t}};var Ci={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=Ur,n=Tr,r=xr,i=qr,o=Hr,s=Gr;var a,c,u,l,d,f,h,p,g,m,v,y,b,w,x,T,D,S,R,O,C,j,E,k,P,N,_;(a||(a={})).type=new r.NotificationType("$/cancelRequest"),(c||(e.ProgressToken=c={})).is=function(e){return"string"==typeof e||"number"==typeof e},(u||(u={})).type=new r.NotificationType("$/progress");e.ProgressType=class{constructor(){}},(l||(l={})).is=function(e){return n.func(e)},e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),(f=d||(e.Trace=d={}))[f.Off=0]="Off",f[f.Messages=1]="Messages",f[f.Compact=2]="Compact",f[f.Verbose=3]="Verbose",(p=h||(e.TraceValues=h={})).Off="off",p.Messages="messages",p.Compact="compact",p.Verbose="verbose",function(e){e.fromString=function(t){if(!n.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(d||(e.Trace=d={})),(m=g||(e.TraceFormat=g={})).Text="text",m.JSON="json",function(e){e.fromString=function(t){return n.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(g||(e.TraceFormat=g={})),(v||(e.SetTraceNotification=v={})).type=new r.NotificationType("$/setTrace"),(y||(e.LogTraceNotification=y={})).type=new r.NotificationType("$/logTrace"),(w=b||(e.ConnectionErrors=b={}))[w.Closed=1]="Closed",w[w.Disposed=2]="Disposed",w[w.AlreadyListening=3]="AlreadyListening";class I extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,I.prototype)}}e.ConnectionError=I,(x||(e.ConnectionStrategy=x={})).is=function(e){const t=e;return t&&n.func(t.cancelUndispatched)},(T||(e.IdCancellationReceiverStrategy=T={})).is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&n.func(t.createCancellationTokenSource)&&(void 0===t.dispose||n.func(t.dispose))},(D||(e.RequestCancellationReceiverStrategy=D={})).is=function(e){const t=e;return t&&"request"===t.kind&&n.func(t.createCancellationTokenSource)&&(void 0===t.dispose||n.func(t.dispose))},(R=S||(e.CancellationReceiverStrategy=S={})).Message=Object.freeze({createCancellationTokenSource:e=>new s.CancellationTokenSource}),R.is=function(e){return T.is(e)||D.is(e)},(C=O||(e.CancellationSenderStrategy=O={})).Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(a.type,{id:t}),cleanup(e){}}),C.is=function(e){const t=e;return t&&n.func(t.sendCancellation)&&n.func(t.cleanup)},(E=j||(e.CancellationStrategy=j={})).Message=Object.freeze({receiver:S.Message,sender:O.Message}),E.is=function(e){const t=e;return t&&S.is(t.receiver)&&O.is(t.sender)},(k||(e.MessageStrategy=k={})).is=function(e){const t=e;return t&&n.func(t.handleMessage)},(P||(e.ConnectionOptions=P={})).is=function(e){const t=e;return t&&(j.is(t.cancellationStrategy)||x.is(t.connectionStrategy)||k.is(t.messageStrategy))},(_=N||(N={}))[_.New=1]="New",_[_.Listening=2]="Listening",_[_.Closed=3]="Closed",_[_.Disposed=4]="Disposed",e.createMessageConnection=function(f,h,p,m){const w=void 0!==p?p:e.NullLogger;let x=0,D=0,S=0;const R="2.0";let O;const C=new Map;let E;const P=new Map,_=new Map;let M,q,A=new i.LinkedMap,L=new Map,F=new Set,H=new Map,U=d.Off,W=g.Text,B=N.New;const z=new o.Emitter,V=new o.Emitter,$=new o.Emitter,K=new o.Emitter,G=new o.Emitter,J=m&&m.cancellationStrategy?m.cancellationStrategy:j.Message;function X(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function Y(e,t){var n;r.Message.isRequest(t)?e.set(X(t.id),t):r.Message.isResponse(t)?e.set(null===(n=t.id)?"res-unknown-"+(++S).toString():"res-"+n.toString(),t):e.set("not-"+(++D).toString(),t)}function Q(e){}function Z(){return B===N.Listening}function ee(){return B===N.Closed}function te(){return B===N.Disposed}function ne(){B!==N.New&&B!==N.Listening||(B=N.Closed,V.fire(void 0))}function re(){M||0===A.size||(M=(0,t.default)().timer.setImmediate((()=>{M=void 0,function(){if(0===A.size)return;const e=A.shift();try{const t=null==m?void 0:m.messageStrategy;k.is(t)?t.handleMessage(e,ie):ie(e)}finally{re()}}()})))}function ie(e){r.Message.isRequest(e)?function(e){if(te())return;function t(t,n,i){const o={jsonrpc:R,id:e.id};t instanceof r.ResponseError?o.error=t.toJson():o.result=void 0===t?null:t,ae(o,n,i),h.write(o).catch((()=>w.error("Sending response failed.")))}function i(t,n,r){const i={jsonrpc:R,id:e.id,error:t.toJson()};ae(i,n,r),h.write(i).catch((()=>w.error("Sending response failed.")))}function o(t,n,r){void 0===t&&(t=null);const i={jsonrpc:R,id:e.id,result:t};ae(i,n,r),h.write(i).catch((()=>w.error("Sending response failed.")))}!function(e){if(U===d.Off||!q)return;if(W===g.Text){let t;U!==d.Verbose&&U!==d.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),q.log(`Received request '${e.method} - (${e.id})'.`,t)}else ue("receive-request",e)}(e);const s=C.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const u=Date.now();if(c||O){const s=e.id??String(Date.now()),d=T.is(J.receiver)?J.receiver.createCancellationTokenSource(s):J.receiver.createCancellationTokenSource(e);null!==e.id&&F.has(e.id)&&d.cancel(),null!==e.id&&H.set(s,d);try{let l;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,u);l=c(d.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byName)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,u);l=c(...e.params,d.token)}else{if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byPosition)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,u);l=c(e.params,d.token)}else O&&(l=O(e.method,e.params,d.token));const f=l;l?f.then?f.then((n=>{H.delete(s),t(n,e.method,u)}),(t=>{H.delete(s),t instanceof r.ResponseError?i(t,e.method,u):t&&n.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(H.delete(s),t(l,e.method,u)):(H.delete(s),o(l,e.method,u))}catch(l){H.delete(s),l instanceof r.ResponseError?t(l,e.method,u):l&&n.string(l.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${l.message}`),e.method,u):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):r.Message.isNotification(e)?function(e){if(te())return;let t,n;if(e.method===a.type.method){const t=e.params.id;return F.delete(t),void ce(e)}{const r=P.get(e.method);r&&(n=r.handler,t=r.type)}if(n||E)try{if(ce(e),n)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==r.ParameterStructures.byName&&w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),n();else if(Array.isArray(e.params)){const i=e.params;e.method===u.type.method&&2===i.length&&c.is(i[0])?n({token:i[0],value:i[1]}):(void 0!==t&&(t.parameterStructures===r.ParameterStructures.byName&&w.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${i.length} arguments`)),n(...i))}else void 0!==t&&t.parameterStructures===r.ParameterStructures.byPosition&&w.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params);else E&&E(e.method,e.params)}catch(i){i.message?w.error(`Notification handler '${e.method}' failed with message: ${i.message}`):w.error(`Notification handler '${e.method}' failed unexpectedly.`)}else $.fire(e)}(e):r.Message.isResponse(e)?function(e){if(te())return;if(null===e.id)e.error?w.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):w.error("Received response message without id. No further error information provided.");else{const n=e.id,i=L.get(n);if(function(e,t){if(U===d.Off||!q)return;if(W===g.Text){let n;if(U!==d.Verbose&&U!==d.Compact||(e.error&&e.error.data?n=`Error data: ${se(e.error.data)}\n\n`:e.result?n=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const r=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";q.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${r}`,n)}else q.log(`Received response ${e.id} without active response promise.`,n)}else ue("receive-response",e)}(e,i),void 0!==i){L.delete(n);try{if(e.error){const t=e.error;i.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");i.resolve(e.result)}}catch(t){t.message?w.error(`Response handler '${i.method}' failed with message: ${t.message}`):w.error(`Response handler '${i.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void w.error("Received empty message.");w.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(n.string(t.id)||n.number(t.id)){const e=t.id,n=L.get(e);n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}f.onClose(ne),f.onError((function(e){z.fire([e,void 0,void 0])})),h.onClose(ne),h.onError((function(e){z.fire(e)}));const oe=e=>{try{if(r.Message.isNotification(e)&&e.method===a.type.method){const t=e.params.id,n=X(t),i=A.get(n);if(r.Message.isRequest(i)){const r=null==m?void 0:m.connectionStrategy,o=r&&r.cancelUndispatched?r.cancelUndispatched(i,Q):void 0;if(o&&(void 0!==o.error||void 0!==o.result))return A.delete(n),H.delete(t),o.id=i.id,ae(o,e.method,Date.now()),void h.write(o).catch((()=>w.error("Sending response for canceled message failed.")))}const o=H.get(t);if(void 0!==o)return o.cancel(),void ce(e);F.add(t)}Y(A,e)}finally{re()}};function se(e){if(null!=e)switch(U){case d.Verbose:return JSON.stringify(e,null,4);case d.Compact:return JSON.stringify(e);default:return}}function ae(e,t,n){if(U!==d.Off&&q)if(W===g.Text){let r;U!==d.Verbose&&U!==d.Compact||(e.error&&e.error.data?r=`Error data: ${se(e.error.data)}\n\n`:e.result?r=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),q.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,r)}else ue("send-response",e)}function ce(e){if(U!==d.Off&&q&&e.method!==y.type.method)if(W===g.Text){let t;U!==d.Verbose&&U!==d.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),q.log(`Received notification '${e.method}'.`,t)}else ue("receive-notification",e)}function ue(e,t){if(!q||U===d.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};q.log(n)}function le(){if(ee())throw new I(b.Closed,"Connection is closed.");if(te())throw new I(b.Disposed,"Connection is disposed.")}function de(e){return void 0===e?null:e}function fe(e){return null===e?void 0:e}function he(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function pe(e,t){switch(e){case r.ParameterStructures.auto:return he(t)?fe(t):[de(t)];case r.ParameterStructures.byName:if(!he(t))throw new Error("Received parameters by name but param is not an object literal.");return fe(t);case r.ParameterStructures.byPosition:return[de(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function ge(e,t){let n;const r=e.numberOfParams;switch(r){case 0:n=void 0;break;case 1:n=pe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<r;e++)n.push(de(t[e]));if(t.length<r)for(let e=t.length;e<r;e++)n.push(null)}return n}const me={sendNotification:(e,...t)=>{let i,o;if(le(),n.string(e)){i=e;const n=t[0];let s=0,a=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(s=1,a=n);let c=t.length;const u=c-s;switch(u){case 0:o=void 0;break;case 1:o=pe(a,t[s]);break;default:if(a===r.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);o=t.slice(s,c).map((e=>de(e)))}}else{const n=t;i=e.method,o=ge(e,n)}const s={jsonrpc:R,method:i,params:o};return function(e){if(U!==d.Off&&q)if(W===g.Text){let t;U!==d.Verbose&&U!==d.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),q.log(`Sending notification '${e.method}'.`,t)}else ue("send-notification",e)}(s),h.write(s).catch((e=>{throw w.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let r;return le(),n.func(e)?E=e:t&&(n.string(e)?(r=e,P.set(e,{type:void 0,handler:t})):(r=e.method,P.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==r?P.delete(r):E=void 0}}},onProgress:(e,t,n)=>{if(_.has(t))throw new Error(`Progress handler for token ${t} already registered`);return _.set(t,n),{dispose:()=>{_.delete(t)}}},sendProgress:(e,t,n)=>me.sendNotification(u.type,{token:t,value:n}),onUnhandledProgress:K.event,sendRequest:(e,...t)=>{let i,o,a;if(le(),function(){if(!Z())throw new Error("Call listen() first.")}(),n.string(e)){i=e;const n=t[0],c=t[t.length-1];let u=0,l=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(u=1,l=n);let d=t.length;s.CancellationToken.is(c)&&(d-=1,a=c);const f=d-u;switch(f){case 0:o=void 0;break;case 1:o=pe(l,t[u]);break;default:if(l===r.ParameterStructures.byName)throw new Error(`Received ${f} parameters for 'by Name' request parameter structure.`);o=t.slice(u,d).map((e=>de(e)))}}else{const n=t;i=e.method,o=ge(e,n);const r=e.numberOfParams;a=s.CancellationToken.is(n[r])?n[r]:void 0}const c=x++;let u;a&&(u=a.onCancellationRequested((()=>{const e=J.sender.sendCancellation(me,c);return void 0===e?(w.log(`Received no promise from cancellation strategy when cancelling id ${c}`),Promise.resolve()):e.catch((()=>{w.log(`Sending cancellation messages for id ${c} failed`)}))})));const l={jsonrpc:R,id:c,method:i,params:o};return function(e){if(U!==d.Off&&q)if(W===g.Text){let t;U!==d.Verbose&&U!==d.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),q.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ue("send-request",e)}(l),"function"==typeof J.sender.enableCancellation&&J.sender.enableCancellation(l),new Promise((async(e,t)=>{const n={method:i,timerStart:Date.now(),resolve:t=>{e(t),J.sender.cleanup(c),null==u||u.dispose()},reject:e=>{t(e),J.sender.cleanup(c),null==u||u.dispose()}};try{await h.write(l),L.set(c,n)}catch(o){throw w.error("Sending request failed."),n.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,o.message?o.message:"Unknown reason")),o}}))},onRequest:(e,t)=>{le();let r=null;return l.is(e)?(r=void 0,O=e):n.string(e)?(r=null,void 0!==t&&(r=e,C.set(e,{handler:t,type:void 0}))):void 0!==t&&(r=e.method,C.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==r&&(void 0!==r?C.delete(r):O=void 0)}}},hasPendingResponse:()=>L.size>0,trace:async(e,t,r)=>{let i=!1,o=g.Text;void 0!==r&&(n.boolean(r)?i=r:(i=r.sendNotification||!1,o=r.traceFormat||g.Text)),U=e,W=o,q=U===d.Off?void 0:t,!i||ee()||te()||await me.sendNotification(v.type,{value:d.toString(e)})},onError:z.event,onClose:V.event,onUnhandledNotification:$.event,onDispose:G.event,end:()=>{h.end()},dispose:()=>{if(te())return;B=N.Disposed,G.fire(void 0);const e=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const t of L.values())t.reject(e);L=new Map,H=new Map,F=new Set,A=new i.LinkedMap,n.func(h.dispose)&&h.dispose(),n.func(f.dispose)&&f.dispose()},listen:()=>{le(),function(){if(Z())throw new I(b.AlreadyListening,"Connection is already listening")}(),B=N.Listening,f.listen(oe)},inspect:()=>{(0,t.default)().console.log("inspect")}};return me.onNotification(y.type,(e=>{if(U===d.Off||!q)return;const t=U===d.Verbose||U===d.Compact;q.log(e.message,t?e.verbose:void 0)})),me.onNotification(u.type,(e=>{const t=_.get(e.token);t?t(e.value):K.fire(e)})),me}}(Ci),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=xr;Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const n=qr;Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return n.Touch}});const r=Fr;Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=Hr;Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return i.Emitter}});const o=Gr;Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=ni;Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=ci;Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const c=yi;Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=Oi;Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const l=Ci;Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return l.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return l.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return l.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return l.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return l.MessageStrategy}});const d=Ur;e.RAL=d.default}(wr),Object.defineProperty(br,"__esModule",{value:!0});const ji=wr;class Ei extends ji.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return Ei.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}Ei.emptyBuffer=new Uint8Array(0);class ki{constructor(e){this.socket=e,this._onData=new ji.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,ji.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),ji.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),ji.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),ji.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class Pi{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),ji.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),ji.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),ji.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const Ni=new TextEncoder,_i=Object.freeze({messageBuffer:Object.freeze({create:e=>new Ei(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(Ni.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new ki(e),asWritableStream:e=>new Pi(e)}),console:console,timer:Object.freeze({setTimeout(e,t,...n){const r=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(e,...t){const n=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(n)}},setInterval(e,t,...n){const r=setInterval(e,t,...n);return{dispose:()=>clearInterval(r)}}})});function Ii(){return _i}(Ii||(Ii={})).install=function(){ji.RAL.install(_i)},br.default=Ii,function(e){var t=A&&A.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=A&&A.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0;br.default.install();const r=wr;n(wr,e);class i extends r.AbstractMessageReader{constructor(e){super(),this._onData=new r.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}e.BrowserMessageReader=i;class o extends r.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}e.BrowserMessageWriter=o,e.createMessageConnection=function(e,t,n,i){return void 0===n&&(n=r.NullLogger),r.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,r.createMessageConnection)(e,t,n,i)}}(yr);var Mi,qi,Ai,Li,Fi,Hi,Ui,Wi,Bi,zi,Vi,$i,Ki,Gi,Ji,Xi,Yi,Qi,Zi,eo,to,no,ro,io,oo,so,ao,co,uo,lo,fo,ho,po,go,mo,vo,yo,bo,wo,xo,To,Do,So,Ro,Oo,Co,jo,Eo,ko,Po,No,_o,Io,Mo,qo,Ao,Lo,Fo,Ho,Uo,Wo,Bo,zo,Vo,$o,Ko,Go,Jo,Xo,Yo,Qo,Zo,es,ts,ns,rs,is,os,ss,as,cs,us,ls,ds,fs,hs,ps,gs,ms,vs,ys,bs,ws,xs,Ts,Ds,Ss,Rs,Os,Cs,js,Es,ks,Ps,Ns,_s,Is,Ms,qs,As,Ls,Fs,Hs,Us,Ws,Bs,zs,Vs,$s,Ks,Gs,Js,Xs,Ys,Qs,Zs,ea,ta,na,ra,ia,oa,sa=yr,aa={};(Mi||(Mi={})).is=function(e){return"string"==typeof e},(qi||(qi={})).is=function(e){return"string"==typeof e},(Li=Ai||(Ai={})).MIN_VALUE=-2147483648,Li.MAX_VALUE=2147483647,Li.is=function(e){return"number"==typeof e&&Li.MIN_VALUE<=e&&e<=Li.MAX_VALUE},(Hi=Fi||(Fi={})).MIN_VALUE=0,Hi.MAX_VALUE=2147483647,Hi.is=function(e){return"number"==typeof e&&Hi.MIN_VALUE<=e&&e<=Hi.MAX_VALUE},(Wi=Ui||(Ui={})).create=function(e,t){return e===Number.MAX_VALUE&&(e=Fi.MAX_VALUE),t===Number.MAX_VALUE&&(t=Fi.MAX_VALUE),{line:e,character:t}},Wi.is=function(e){let t=e;return da.objectLiteral(t)&&da.uinteger(t.line)&&da.uinteger(t.character)},(zi=Bi||(Bi={})).create=function(e,t,n,r){if(da.uinteger(e)&&da.uinteger(t)&&da.uinteger(n)&&da.uinteger(r))return{start:Ui.create(e,t),end:Ui.create(n,r)};if(Ui.is(e)&&Ui.is(t))return{start:e,end:t};throw new Error(`Range#create called with invalid arguments[${e}, ${t}, ${n}, ${r}]`)},zi.is=function(e){let t=e;return da.objectLiteral(t)&&Ui.is(t.start)&&Ui.is(t.end)},($i=Vi||(Vi={})).create=function(e,t){return{uri:e,range:t}},$i.is=function(e){let t=e;return da.objectLiteral(t)&&Bi.is(t.range)&&(da.string(t.uri)||da.undefined(t.uri))},(Gi=Ki||(Ki={})).create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},Gi.is=function(e){let t=e;return da.objectLiteral(t)&&Bi.is(t.targetRange)&&da.string(t.targetUri)&&Bi.is(t.targetSelectionRange)&&(Bi.is(t.originSelectionRange)||da.undefined(t.originSelectionRange))},(Xi=Ji||(Ji={})).create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},Xi.is=function(e){const t=e;return da.objectLiteral(t)&&da.numberRange(t.red,0,1)&&da.numberRange(t.green,0,1)&&da.numberRange(t.blue,0,1)&&da.numberRange(t.alpha,0,1)},(Qi=Yi||(Yi={})).create=function(e,t){return{range:e,color:t}},Qi.is=function(e){const t=e;return da.objectLiteral(t)&&Bi.is(t.range)&&Ji.is(t.color)},(eo=Zi||(Zi={})).create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},eo.is=function(e){const t=e;return da.objectLiteral(t)&&da.string(t.label)&&(da.undefined(t.textEdit)||vo.is(t))&&(da.undefined(t.additionalTextEdits)||da.typedArray(t.additionalTextEdits,vo.is))},(no=to||(to={})).Comment="comment",no.Imports="imports",no.Region="region",(io=ro||(ro={})).create=function(e,t,n,r,i,o){const s={startLine:e,endLine:t};return da.defined(n)&&(s.startCharacter=n),da.defined(r)&&(s.endCharacter=r),da.defined(i)&&(s.kind=i),da.defined(o)&&(s.collapsedText=o),s},io.is=function(e){const t=e;return da.objectLiteral(t)&&da.uinteger(t.startLine)&&da.uinteger(t.startLine)&&(da.undefined(t.startCharacter)||da.uinteger(t.startCharacter))&&(da.undefined(t.endCharacter)||da.uinteger(t.endCharacter))&&(da.undefined(t.kind)||da.string(t.kind))},(so=oo||(oo={})).create=function(e,t){return{location:e,message:t}},so.is=function(e){let t=e;return da.defined(t)&&Vi.is(t.location)&&da.string(t.message)},(co=ao||(ao={})).Error=1,co.Warning=2,co.Information=3,co.Hint=4,(lo=uo||(uo={})).Unnecessary=1,lo.Deprecated=2,(fo||(fo={})).is=function(e){const t=e;return da.objectLiteral(t)&&da.string(t.href)},(po=ho||(ho={})).create=function(e,t,n,r,i,o){let s={range:e,message:t};return da.defined(n)&&(s.severity=n),da.defined(r)&&(s.code=r),da.defined(i)&&(s.source=i),da.defined(o)&&(s.relatedInformation=o),s},po.is=function(e){var t;let n=e;return da.defined(n)&&Bi.is(n.range)&&da.string(n.message)&&(da.number(n.severity)||da.undefined(n.severity))&&(da.integer(n.code)||da.string(n.code)||da.undefined(n.code))&&(da.undefined(n.codeDescription)||da.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(da.string(n.source)||da.undefined(n.source))&&(da.undefined(n.relatedInformation)||da.typedArray(n.relatedInformation,oo.is))},(mo=go||(go={})).create=function(e,t,...n){let r={title:e,command:t};return da.defined(n)&&n.length>0&&(r.arguments=n),r},mo.is=function(e){let t=e;return da.defined(t)&&da.string(t.title)&&da.string(t.command)},(yo=vo||(vo={})).replace=function(e,t){return{range:e,newText:t}},yo.insert=function(e,t){return{range:{start:e,end:e},newText:t}},yo.del=function(e){return{range:e,newText:""}},yo.is=function(e){const t=e;return da.objectLiteral(t)&&da.string(t.newText)&&Bi.is(t.range)},(wo=bo||(bo={})).create=function(e,t,n){const r={label:e};return void 0!==t&&(r.needsConfirmation=t),void 0!==n&&(r.description=n),r},wo.is=function(e){const t=e;return da.objectLiteral(t)&&da.string(t.label)&&(da.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(da.string(t.description)||void 0===t.description)},(xo||(xo={})).is=function(e){const t=e;return da.string(t)},(Do=To||(To={})).replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},Do.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},Do.del=function(e,t){return{range:e,newText:"",annotationId:t}},Do.is=function(e){const t=e;return vo.is(t)&&(bo.is(t.annotationId)||xo.is(t.annotationId))},(Ro=So||(So={})).create=function(e,t){return{textDocument:e,edits:t}},Ro.is=function(e){let t=e;return da.defined(t)&&Ao.is(t.textDocument)&&Array.isArray(t.edits)},(Co=Oo||(Oo={})).create=function(e,t,n){let r={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},Co.is=function(e){let t=e;return t&&"create"===t.kind&&da.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||da.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||da.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||xo.is(t.annotationId))},(Eo=jo||(jo={})).create=function(e,t,n,r){let i={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(i.options=n),void 0!==r&&(i.annotationId=r),i},Eo.is=function(e){let t=e;return t&&"rename"===t.kind&&da.string(t.oldUri)&&da.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||da.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||da.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||xo.is(t.annotationId))},(Po=ko||(ko={})).create=function(e,t,n){let r={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},Po.is=function(e){let t=e;return t&&"delete"===t.kind&&da.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||da.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||da.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||xo.is(t.annotationId))},(No||(No={})).is=function(e){let t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((e=>da.string(e.kind)?Oo.is(e)||jo.is(e)||ko.is(e):So.is(e))))};class ca{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,n){let r,i;if(void 0===n?r=vo.insert(e,t):xo.is(n)?(i=n,r=To.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=To.insert(e,t,i)),this.edits.push(r),void 0!==i)return i}replace(e,t,n){let r,i;if(void 0===n?r=vo.replace(e,t):xo.is(n)?(i=n,r=To.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=To.replace(e,t,i)),this.edits.push(r),void 0!==i)return i}delete(e,t){let n,r;if(void 0===t?n=vo.del(e):xo.is(t)?(r=t,n=To.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(t),n=To.del(e,r)),this.edits.push(n),void 0!==r)return r}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")}}class ua{constructor(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let n;if(xo.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error(`Id ${n} is already in use.`);if(void 0===t)throw new Error(`No annotation provided for id ${n}`);return this._annotations[n]=t,this._size++,n}nextId(){return this._counter++,this._counter.toString()}}(Io=_o||(_o={})).create=function(e){return{uri:e}},Io.is=function(e){let t=e;return da.defined(t)&&da.string(t.uri)},(qo=Mo||(Mo={})).create=function(e,t){return{uri:e,version:t}},qo.is=function(e){let t=e;return da.defined(t)&&da.string(t.uri)&&da.integer(t.version)},(Lo=Ao||(Ao={})).create=function(e,t){return{uri:e,version:t}},Lo.is=function(e){let t=e;return da.defined(t)&&da.string(t.uri)&&(null===t.version||da.integer(t.version))},(Ho=Fo||(Fo={})).create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},Ho.is=function(e){let t=e;return da.defined(t)&&da.string(t.uri)&&da.string(t.languageId)&&da.integer(t.version)&&da.string(t.text)},(Wo=Uo||(Uo={})).PlainText="plaintext",Wo.Markdown="markdown",Wo.is=function(e){const t=e;return t===Wo.PlainText||t===Wo.Markdown},(Bo||(Bo={})).is=function(e){const t=e;return da.objectLiteral(e)&&Uo.is(t.kind)&&da.string(t.value)},(Vo=zo||(zo={})).Text=1,Vo.Method=2,Vo.Function=3,Vo.Constructor=4,Vo.Field=5,Vo.Variable=6,Vo.Class=7,Vo.Interface=8,Vo.Module=9,Vo.Property=10,Vo.Unit=11,Vo.Value=12,Vo.Enum=13,Vo.Keyword=14,Vo.Snippet=15,Vo.Color=16,Vo.File=17,Vo.Reference=18,Vo.Folder=19,Vo.EnumMember=20,Vo.Constant=21,Vo.Struct=22,Vo.Event=23,Vo.Operator=24,Vo.TypeParameter=25,(Ko=$o||($o={})).PlainText=1,Ko.Snippet=2,(Go||(Go={})).Deprecated=1,(Xo=Jo||(Jo={})).create=function(e,t,n){return{newText:e,insert:t,replace:n}},Xo.is=function(e){const t=e;return t&&da.string(t.newText)&&Bi.is(t.insert)&&Bi.is(t.replace)},(Qo=Yo||(Yo={})).asIs=1,Qo.adjustIndentation=2,(Zo||(Zo={})).is=function(e){const t=e;return t&&(da.string(t.detail)||void 0===t.detail)&&(da.string(t.description)||void 0===t.description)},(es||(es={})).create=function(e){return{label:e}},(ts||(ts={})).create=function(e,t){return{items:e||[],isIncomplete:!!t}},(rs=ns||(ns={})).fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},rs.is=function(e){const t=e;return da.string(t)||da.objectLiteral(t)&&da.string(t.language)&&da.string(t.value)},(is||(is={})).is=function(e){let t=e;return!!t&&da.objectLiteral(t)&&(Bo.is(t.contents)||ns.is(t.contents)||da.typedArray(t.contents,ns.is))&&(void 0===e.range||Bi.is(e.range))},(os||(os={})).create=function(e,t){return t?{label:e,documentation:t}:{label:e}},(ss||(ss={})).create=function(e,t,...n){let r={label:e};return da.defined(t)&&(r.documentation=t),da.defined(n)?r.parameters=n:r.parameters=[],r},(cs=as||(as={})).Text=1,cs.Read=2,cs.Write=3,(us||(us={})).create=function(e,t){let n={range:e};return da.number(t)&&(n.kind=t),n},(ds=ls||(ls={})).File=1,ds.Module=2,ds.Namespace=3,ds.Package=4,ds.Class=5,ds.Method=6,ds.Property=7,ds.Field=8,ds.Constructor=9,ds.Enum=10,ds.Interface=11,ds.Function=12,ds.Variable=13,ds.Constant=14,ds.String=15,ds.Number=16,ds.Boolean=17,ds.Array=18,ds.Object=19,ds.Key=20,ds.Null=21,ds.EnumMember=22,ds.Struct=23,ds.Event=24,ds.Operator=25,ds.TypeParameter=26,(fs||(fs={})).Deprecated=1,(hs||(hs={})).create=function(e,t,n,r,i){let o={name:e,kind:t,location:{uri:r,range:n}};return i&&(o.containerName=i),o},(ps||(ps={})).create=function(e,t,n,r){return void 0!==r?{name:e,kind:t,location:{uri:n,range:r}}:{name:e,kind:t,location:{uri:n}}},(ms=gs||(gs={})).create=function(e,t,n,r,i,o){let s={name:e,detail:t,kind:n,range:r,selectionRange:i};return void 0!==o&&(s.children=o),s},ms.is=function(e){let t=e;return t&&da.string(t.name)&&da.number(t.kind)&&Bi.is(t.range)&&Bi.is(t.selectionRange)&&(void 0===t.detail||da.string(t.detail))&&(void 0===t.deprecated||da.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))},(ys=vs||(vs={})).Empty="",ys.QuickFix="quickfix",ys.Refactor="refactor",ys.RefactorExtract="refactor.extract",ys.RefactorInline="refactor.inline",ys.RefactorRewrite="refactor.rewrite",ys.Source="source",ys.SourceOrganizeImports="source.organizeImports",ys.SourceFixAll="source.fixAll",(ws=bs||(bs={})).Invoked=1,ws.Automatic=2,(Ts=xs||(xs={})).create=function(e,t,n){let r={diagnostics:e};return null!=t&&(r.only=t),null!=n&&(r.triggerKind=n),r},Ts.is=function(e){let t=e;return da.defined(t)&&da.typedArray(t.diagnostics,ho.is)&&(void 0===t.only||da.typedArray(t.only,da.string))&&(void 0===t.triggerKind||t.triggerKind===bs.Invoked||t.triggerKind===bs.Automatic)},(Ss=Ds||(Ds={})).create=function(e,t,n){let r={title:e},i=!0;return"string"==typeof t?(i=!1,r.kind=t):go.is(t)?r.command=t:r.edit=t,i&&void 0!==n&&(r.kind=n),r},Ss.is=function(e){let t=e;return t&&da.string(t.title)&&(void 0===t.diagnostics||da.typedArray(t.diagnostics,ho.is))&&(void 0===t.kind||da.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||go.is(t.command))&&(void 0===t.isPreferred||da.boolean(t.isPreferred))&&(void 0===t.edit||No.is(t.edit))},(Os=Rs||(Rs={})).create=function(e,t){let n={range:e};return da.defined(t)&&(n.data=t),n},Os.is=function(e){let t=e;return da.defined(t)&&Bi.is(t.range)&&(da.undefined(t.command)||go.is(t.command))},(js=Cs||(Cs={})).create=function(e,t){return{tabSize:e,insertSpaces:t}},js.is=function(e){let t=e;return da.defined(t)&&da.uinteger(t.tabSize)&&da.boolean(t.insertSpaces)},(ks=Es||(Es={})).create=function(e,t,n){return{range:e,target:t,data:n}},ks.is=function(e){let t=e;return da.defined(t)&&Bi.is(t.range)&&(da.undefined(t.target)||da.string(t.target))},(Ns=Ps||(Ps={})).create=function(e,t){return{range:e,parent:t}},Ns.is=function(e){let t=e;return da.objectLiteral(t)&&Bi.is(t.range)&&(void 0===t.parent||Ns.is(t.parent))},(Is=_s||(_s={})).namespace="namespace",Is.type="type",Is.class="class",Is.enum="enum",Is.interface="interface",Is.struct="struct",Is.typeParameter="typeParameter",Is.parameter="parameter",Is.variable="variable",Is.property="property",Is.enumMember="enumMember",Is.event="event",Is.function="function",Is.method="method",Is.macro="macro",Is.keyword="keyword",Is.modifier="modifier",Is.comment="comment",Is.string="string",Is.number="number",Is.regexp="regexp",Is.operator="operator",Is.decorator="decorator",(qs=Ms||(Ms={})).declaration="declaration",qs.definition="definition",qs.readonly="readonly",qs.static="static",qs.deprecated="deprecated",qs.abstract="abstract",qs.async="async",qs.modification="modification",qs.documentation="documentation",qs.defaultLibrary="defaultLibrary",(As||(As={})).is=function(e){const t=e;return da.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(Fs=Ls||(Ls={})).create=function(e,t){return{range:e,text:t}},Fs.is=function(e){const t=e;return null!=t&&Bi.is(t.range)&&da.string(t.text)},(Us=Hs||(Hs={})).create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},Us.is=function(e){const t=e;return null!=t&&Bi.is(t.range)&&da.boolean(t.caseSensitiveLookup)&&(da.string(t.variableName)||void 0===t.variableName)},(Bs=Ws||(Ws={})).create=function(e,t){return{range:e,expression:t}},Bs.is=function(e){const t=e;return null!=t&&Bi.is(t.range)&&(da.string(t.expression)||void 0===t.expression)},(Vs=zs||(zs={})).create=function(e,t){return{frameId:e,stoppedLocation:t}},Vs.is=function(e){const t=e;return da.defined(t)&&Bi.is(e.stoppedLocation)},(Ks=$s||($s={})).Type=1,Ks.Parameter=2,Ks.is=function(e){return 1===e||2===e},(Js=Gs||(Gs={})).create=function(e){return{value:e}},Js.is=function(e){const t=e;return da.objectLiteral(t)&&(void 0===t.tooltip||da.string(t.tooltip)||Bo.is(t.tooltip))&&(void 0===t.location||Vi.is(t.location))&&(void 0===t.command||go.is(t.command))},(Ys=Xs||(Xs={})).create=function(e,t,n){const r={position:e,label:t};return void 0!==n&&(r.kind=n),r},Ys.is=function(e){const t=e;return da.objectLiteral(t)&&Ui.is(t.position)&&(da.string(t.label)||da.typedArray(t.label,Gs.is))&&(void 0===t.kind||$s.is(t.kind))&&void 0===t.textEdits||da.typedArray(t.textEdits,vo.is)&&(void 0===t.tooltip||da.string(t.tooltip)||Bo.is(t.tooltip))&&(void 0===t.paddingLeft||da.boolean(t.paddingLeft))&&(void 0===t.paddingRight||da.boolean(t.paddingRight))},(Qs||(Qs={})).createSnippet=function(e){return{kind:"snippet",value:e}},(Zs||(Zs={})).create=function(e,t,n,r){return{insertText:e,filterText:t,range:n,command:r}},(ea||(ea={})).create=function(e){return{items:e}},(na=ta||(ta={})).Invoked=0,na.Automatic=1,(ra||(ra={})).create=function(e,t){return{range:e,text:t}},(ia||(ia={})).create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}},(oa||(oa={})).is=function(e){const t=e;return da.objectLiteral(t)&&qi.is(t.uri)&&da.string(t.name)};var la,da;!function(e){function t(e,n){if(e.length<=1)return e;const r=e.length/2|0,i=e.slice(0,r),o=e.slice(r);t(i,n),t(o,n);let s=0,a=0,c=0;for(;s<i.length&&a<o.length;){let t=n(i[s],o[a]);e[c++]=t<=0?i[s++]:o[a++]}for(;s<i.length;)e[c++]=i[s++];for(;a<o.length;)e[c++]=o[a++];return e}e.create=function(e,t,n,r){return new fa(e,t,n,r)},e.is=function(e){let t=e;return!!(da.defined(t)&&da.string(t.uri)&&(da.undefined(t.languageId)||da.string(t.languageId))&&da.uinteger(t.lineCount)&&da.func(t.getText)&&da.func(t.positionAt)&&da.func(t.offsetAt))},e.applyEdits=function(e,n){let r=e.getText(),i=t(n,((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),o=r.length;for(let t=i.length-1;t>=0;t--){let n=i[t],s=e.offsetAt(n.range.start),a=e.offsetAt(n.range.end);if(!(a<=o))throw new Error("Overlapping edit");r=r.substring(0,s)+n.newText+r.substring(a,r.length),o=s}return r}}(la||(la={}));class fa{constructor(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(void 0===this._lineOffsets){let e=[],t=this._content,n=!0;for(let r=0;r<t.length;r++){n&&(e.push(r),n=!1);let i=t.charAt(r);n="\r"===i||"\n"===i,"\r"===i&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return Ui.create(0,e);for(;n<r;){let i=Math.floor((n+r)/2);t[i]>e?r=i:n=i+1}let i=n-1;return Ui.create(i,e-t[i])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)}get lineCount(){return this.getLineOffsets().length}}!function(e){const t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,r){return"[object Number]"===t.call(e)&&n<=e&&e<=r},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(da||(da={}));const ha=L(Object.freeze(Object.defineProperty({__proto__:null,get AnnotatedTextEdit(){return To},get ChangeAnnotation(){return bo},get ChangeAnnotationIdentifier(){return xo},get CodeAction(){return Ds},get CodeActionContext(){return xs},get CodeActionKind(){return vs},get CodeActionTriggerKind(){return bs},get CodeDescription(){return fo},get CodeLens(){return Rs},get Color(){return Ji},get ColorInformation(){return Yi},get ColorPresentation(){return Zi},get Command(){return go},get CompletionItem(){return es},get CompletionItemKind(){return zo},get CompletionItemLabelDetails(){return Zo},get CompletionItemTag(){return Go},get CompletionList(){return ts},get CreateFile(){return Oo},get DeleteFile(){return ko},get Diagnostic(){return ho},get DiagnosticRelatedInformation(){return oo},get DiagnosticSeverity(){return ao},get DiagnosticTag(){return uo},get DocumentHighlight(){return us},get DocumentHighlightKind(){return as},get DocumentLink(){return Es},get DocumentSymbol(){return gs},get DocumentUri(){return Mi},EOL:["\n","\r\n","\r"],get FoldingRange(){return ro},get FoldingRangeKind(){return to},get FormattingOptions(){return Cs},get Hover(){return is},get InlayHint(){return Xs},get InlayHintKind(){return $s},get InlayHintLabelPart(){return Gs},get InlineCompletionContext(){return ia},get InlineCompletionItem(){return Zs},get InlineCompletionList(){return ea},get InlineCompletionTriggerKind(){return ta},get InlineValueContext(){return zs},get InlineValueEvaluatableExpression(){return Ws},get InlineValueText(){return Ls},get InlineValueVariableLookup(){return Hs},get InsertReplaceEdit(){return Jo},get InsertTextFormat(){return $o},get InsertTextMode(){return Yo},get Location(){return Vi},get LocationLink(){return Ki},get MarkedString(){return ns},get MarkupContent(){return Bo},get MarkupKind(){return Uo},get OptionalVersionedTextDocumentIdentifier(){return Ao},get ParameterInformation(){return os},get Position(){return Ui},get Range(){return Bi},get RenameFile(){return jo},get SelectedCompletionInfo(){return ra},get SelectionRange(){return Ps},get SemanticTokenModifiers(){return Ms},get SemanticTokenTypes(){return _s},get SemanticTokens(){return As},get SignatureInformation(){return ss},get StringValue(){return Qs},get SymbolInformation(){return hs},get SymbolKind(){return ls},get SymbolTag(){return fs},get TextDocument(){return la},get TextDocumentEdit(){return So},get TextDocumentIdentifier(){return _o},get TextDocumentItem(){return Fo},get TextEdit(){return vo},get URI(){return qi},get VersionedTextDocumentIdentifier(){return Mo},WorkspaceChange:class{constructor(e){this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new ua(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((e=>{if(So.is(e)){const t=new ca(e.edits,this._changeAnnotations);this._textEditChanges[e.textDocument.uri]=t}}))):e.changes&&Object.keys(e.changes).forEach((t=>{const n=new ca(e.changes[t]);this._textEditChanges[t]=n}))):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(Ao.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");const t={uri:e.uri,version:e.version};let n=this._textEditChanges[t.uri];if(!n){const e=[],r={textDocument:t,edits:e};this._workspaceEdit.documentChanges.push(r),n=new ca(e,this._changeAnnotations),this._textEditChanges[t.uri]=n}return n}{if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let n=[];this._workspaceEdit.changes[e]=n,t=new ca(n),this._textEditChanges[e]=t}return t}}initDocumentChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new ua,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let r,i,o;if(bo.is(t)||xo.is(t)?r=t:n=t,void 0===r?i=Oo.create(e,n):(o=xo.is(r)?r:this._changeAnnotations.manage(r),i=Oo.create(e,n,o)),this._workspaceEdit.documentChanges.push(i),void 0!==o)return o}renameFile(e,t,n,r){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let i,o,s;if(bo.is(n)||xo.is(n)?i=n:r=n,void 0===i?o=jo.create(e,t,r):(s=xo.is(i)?i:this._changeAnnotations.manage(i),o=jo.create(e,t,r,s)),this._workspaceEdit.documentChanges.push(o),void 0!==s)return s}deleteFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let r,i,o;if(bo.is(t)||xo.is(t)?r=t:n=t,void 0===r?i=ko.create(e,n):(o=xo.is(r)?r:this._changeAnnotations.manage(r),i=ko.create(e,n,o)),this._workspaceEdit.documentChanges.push(i),void 0!==o)return o}},get WorkspaceEdit(){return No},get WorkspaceFolder(){return oa},get WorkspaceSymbol(){return ps},get integer(){return Ai},get uinteger(){return Fi}},Symbol.toStringTag,{value:"Module"})));var pa={};Object.defineProperty(pa,"__esModule",{value:!0}),pa.ProtocolNotificationType=pa.ProtocolNotificationType0=pa.ProtocolRequestType=pa.ProtocolRequestType0=pa.RegistrationType=pa.MessageDirection=void 0;const ga=yr;var ma,va;(va=ma||(pa.MessageDirection=ma={})).clientToServer="clientToServer",va.serverToClient="serverToClient",va.both="both";pa.RegistrationType=class{constructor(e){this.method=e}};pa.ProtocolRequestType0=class extends ga.RequestType0{constructor(e){super(e)}};pa.ProtocolRequestType=class extends ga.RequestType{constructor(e){super(e,ga.ParameterStructures.byName)}};pa.ProtocolNotificationType0=class extends ga.NotificationType0{constructor(e){super(e)}};pa.ProtocolNotificationType=class extends ga.NotificationType{constructor(e){super(e,ga.ParameterStructures.byName)}};var ya={},ba={};function wa(e){return"string"==typeof e||e instanceof String}function xa(e){return Array.isArray(e)}Object.defineProperty(ba,"__esModule",{value:!0}),ba.objectLiteral=ba.typedArray=ba.stringArray=ba.array=ba.func=ba.error=ba.number=ba.string=ba.boolean=void 0,ba.boolean=function(e){return!0===e||!1===e},ba.string=wa,ba.number=function(e){return"number"==typeof e||e instanceof Number},ba.error=function(e){return e instanceof Error},ba.func=function(e){return"function"==typeof e},ba.array=xa,ba.stringArray=function(e){return xa(e)&&e.every((e=>wa(e)))},ba.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},ba.objectLiteral=function(e){return null!==e&&"object"==typeof e};var Ta={};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.ImplementationRequest=void 0;const Da=pa;var Sa,Ra;(Ra=Sa||(Ta.ImplementationRequest=Sa={})).method="textDocument/implementation",Ra.messageDirection=Da.MessageDirection.clientToServer,Ra.type=new Da.ProtocolRequestType(Ra.method);var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.TypeDefinitionRequest=void 0;const Ca=pa;var ja,Ea;(Ea=ja||(Oa.TypeDefinitionRequest=ja={})).method="textDocument/typeDefinition",Ea.messageDirection=Ca.MessageDirection.clientToServer,Ea.type=new Ca.ProtocolRequestType(Ea.method);var ka={};Object.defineProperty(ka,"__esModule",{value:!0}),ka.DidChangeWorkspaceFoldersNotification=ka.WorkspaceFoldersRequest=void 0;const Pa=pa;var Na,_a,Ia,Ma;(_a=Na||(ka.WorkspaceFoldersRequest=Na={})).method="workspace/workspaceFolders",_a.messageDirection=Pa.MessageDirection.serverToClient,_a.type=new Pa.ProtocolRequestType0(_a.method),(Ma=Ia||(ka.DidChangeWorkspaceFoldersNotification=Ia={})).method="workspace/didChangeWorkspaceFolders",Ma.messageDirection=Pa.MessageDirection.clientToServer,Ma.type=new Pa.ProtocolNotificationType(Ma.method);var qa={};Object.defineProperty(qa,"__esModule",{value:!0}),qa.ConfigurationRequest=void 0;const Aa=pa;var La,Fa;(Fa=La||(qa.ConfigurationRequest=La={})).method="workspace/configuration",Fa.messageDirection=Aa.MessageDirection.serverToClient,Fa.type=new Aa.ProtocolRequestType(Fa.method);var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.ColorPresentationRequest=Ha.DocumentColorRequest=void 0;const Ua=pa;var Wa,Ba,za,Va;(Ba=Wa||(Ha.DocumentColorRequest=Wa={})).method="textDocument/documentColor",Ba.messageDirection=Ua.MessageDirection.clientToServer,Ba.type=new Ua.ProtocolRequestType(Ba.method),(Va=za||(Ha.ColorPresentationRequest=za={})).method="textDocument/colorPresentation",Va.messageDirection=Ua.MessageDirection.clientToServer,Va.type=new Ua.ProtocolRequestType(Va.method);var $a={};Object.defineProperty($a,"__esModule",{value:!0}),$a.FoldingRangeRefreshRequest=$a.FoldingRangeRequest=void 0;const Ka=pa;var Ga,Ja,Xa,Ya;(Ja=Ga||($a.FoldingRangeRequest=Ga={})).method="textDocument/foldingRange",Ja.messageDirection=Ka.MessageDirection.clientToServer,Ja.type=new Ka.ProtocolRequestType(Ja.method),(Ya=Xa||($a.FoldingRangeRefreshRequest=Xa={})).method="workspace/foldingRange/refresh",Ya.messageDirection=Ka.MessageDirection.serverToClient,Ya.type=new Ka.ProtocolRequestType0(Ya.method);var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.DeclarationRequest=void 0;const Za=pa;var ec,tc;(tc=ec||(Qa.DeclarationRequest=ec={})).method="textDocument/declaration",tc.messageDirection=Za.MessageDirection.clientToServer,tc.type=new Za.ProtocolRequestType(tc.method);var nc={};Object.defineProperty(nc,"__esModule",{value:!0}),nc.SelectionRangeRequest=void 0;const rc=pa;var ic,oc;(oc=ic||(nc.SelectionRangeRequest=ic={})).method="textDocument/selectionRange",oc.messageDirection=rc.MessageDirection.clientToServer,oc.type=new rc.ProtocolRequestType(oc.method);var sc={};Object.defineProperty(sc,"__esModule",{value:!0}),sc.WorkDoneProgressCancelNotification=sc.WorkDoneProgressCreateRequest=sc.WorkDoneProgress=void 0;const ac=yr,cc=pa;var uc,lc,dc,fc,hc,pc;(lc=uc||(sc.WorkDoneProgress=uc={})).type=new ac.ProgressType,lc.is=function(e){return e===lc.type},(fc=dc||(sc.WorkDoneProgressCreateRequest=dc={})).method="window/workDoneProgress/create",fc.messageDirection=cc.MessageDirection.serverToClient,fc.type=new cc.ProtocolRequestType(fc.method),(pc=hc||(sc.WorkDoneProgressCancelNotification=hc={})).method="window/workDoneProgress/cancel",pc.messageDirection=cc.MessageDirection.clientToServer,pc.type=new cc.ProtocolNotificationType(pc.method);var gc={};Object.defineProperty(gc,"__esModule",{value:!0}),gc.CallHierarchyOutgoingCallsRequest=gc.CallHierarchyIncomingCallsRequest=gc.CallHierarchyPrepareRequest=void 0;const mc=pa;var vc,yc,bc,wc,xc,Tc;(yc=vc||(gc.CallHierarchyPrepareRequest=vc={})).method="textDocument/prepareCallHierarchy",yc.messageDirection=mc.MessageDirection.clientToServer,yc.type=new mc.ProtocolRequestType(yc.method),(wc=bc||(gc.CallHierarchyIncomingCallsRequest=bc={})).method="callHierarchy/incomingCalls",wc.messageDirection=mc.MessageDirection.clientToServer,wc.type=new mc.ProtocolRequestType(wc.method),(Tc=xc||(gc.CallHierarchyOutgoingCallsRequest=xc={})).method="callHierarchy/outgoingCalls",Tc.messageDirection=mc.MessageDirection.clientToServer,Tc.type=new mc.ProtocolRequestType(Tc.method);var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.SemanticTokensRefreshRequest=Dc.SemanticTokensRangeRequest=Dc.SemanticTokensDeltaRequest=Dc.SemanticTokensRequest=Dc.SemanticTokensRegistrationType=Dc.TokenFormat=void 0;const Sc=pa;var Rc,Oc,Cc,jc,Ec,kc,Pc,Nc,_c,Ic,Mc;(Rc||(Dc.TokenFormat=Rc={})).Relative="relative",(Cc=Oc||(Dc.SemanticTokensRegistrationType=Oc={})).method="textDocument/semanticTokens",Cc.type=new Sc.RegistrationType(Cc.method),(Ec=jc||(Dc.SemanticTokensRequest=jc={})).method="textDocument/semanticTokens/full",Ec.messageDirection=Sc.MessageDirection.clientToServer,Ec.type=new Sc.ProtocolRequestType(Ec.method),Ec.registrationMethod=Oc.method,(Pc=kc||(Dc.SemanticTokensDeltaRequest=kc={})).method="textDocument/semanticTokens/full/delta",Pc.messageDirection=Sc.MessageDirection.clientToServer,Pc.type=new Sc.ProtocolRequestType(Pc.method),Pc.registrationMethod=Oc.method,(_c=Nc||(Dc.SemanticTokensRangeRequest=Nc={})).method="textDocument/semanticTokens/range",_c.messageDirection=Sc.MessageDirection.clientToServer,_c.type=new Sc.ProtocolRequestType(_c.method),_c.registrationMethod=Oc.method,(Mc=Ic||(Dc.SemanticTokensRefreshRequest=Ic={})).method="workspace/semanticTokens/refresh",Mc.messageDirection=Sc.MessageDirection.serverToClient,Mc.type=new Sc.ProtocolRequestType0(Mc.method);var qc={};Object.defineProperty(qc,"__esModule",{value:!0}),qc.ShowDocumentRequest=void 0;const Ac=pa;var Lc,Fc;(Fc=Lc||(qc.ShowDocumentRequest=Lc={})).method="window/showDocument",Fc.messageDirection=Ac.MessageDirection.serverToClient,Fc.type=new Ac.ProtocolRequestType(Fc.method);var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.LinkedEditingRangeRequest=void 0;const Uc=pa;var Wc,Bc;(Bc=Wc||(Hc.LinkedEditingRangeRequest=Wc={})).method="textDocument/linkedEditingRange",Bc.messageDirection=Uc.MessageDirection.clientToServer,Bc.type=new Uc.ProtocolRequestType(Bc.method);var zc={};Object.defineProperty(zc,"__esModule",{value:!0}),zc.WillDeleteFilesRequest=zc.DidDeleteFilesNotification=zc.DidRenameFilesNotification=zc.WillRenameFilesRequest=zc.DidCreateFilesNotification=zc.WillCreateFilesRequest=zc.FileOperationPatternKind=void 0;const Vc=pa;var $c,Kc,Gc,Jc,Xc,Yc,Qc,Zc,eu,tu,nu,ru,iu,ou;(Kc=$c||(zc.FileOperationPatternKind=$c={})).file="file",Kc.folder="folder",(Jc=Gc||(zc.WillCreateFilesRequest=Gc={})).method="workspace/willCreateFiles",Jc.messageDirection=Vc.MessageDirection.clientToServer,Jc.type=new Vc.ProtocolRequestType(Jc.method),(Yc=Xc||(zc.DidCreateFilesNotification=Xc={})).method="workspace/didCreateFiles",Yc.messageDirection=Vc.MessageDirection.clientToServer,Yc.type=new Vc.ProtocolNotificationType(Yc.method),(Zc=Qc||(zc.WillRenameFilesRequest=Qc={})).method="workspace/willRenameFiles",Zc.messageDirection=Vc.MessageDirection.clientToServer,Zc.type=new Vc.ProtocolRequestType(Zc.method),(tu=eu||(zc.DidRenameFilesNotification=eu={})).method="workspace/didRenameFiles",tu.messageDirection=Vc.MessageDirection.clientToServer,tu.type=new Vc.ProtocolNotificationType(tu.method),(ru=nu||(zc.DidDeleteFilesNotification=nu={})).method="workspace/didDeleteFiles",ru.messageDirection=Vc.MessageDirection.clientToServer,ru.type=new Vc.ProtocolNotificationType(ru.method),(ou=iu||(zc.WillDeleteFilesRequest=iu={})).method="workspace/willDeleteFiles",ou.messageDirection=Vc.MessageDirection.clientToServer,ou.type=new Vc.ProtocolRequestType(ou.method);var su={};Object.defineProperty(su,"__esModule",{value:!0}),su.MonikerRequest=su.MonikerKind=su.UniquenessLevel=void 0;const au=pa;var cu,uu,lu,du,fu,hu;(uu=cu||(su.UniquenessLevel=cu={})).document="document",uu.project="project",uu.group="group",uu.scheme="scheme",uu.global="global",(du=lu||(su.MonikerKind=lu={})).$import="import",du.$export="export",du.local="local",(hu=fu||(su.MonikerRequest=fu={})).method="textDocument/moniker",hu.messageDirection=au.MessageDirection.clientToServer,hu.type=new au.ProtocolRequestType(hu.method);var pu={};Object.defineProperty(pu,"__esModule",{value:!0}),pu.TypeHierarchySubtypesRequest=pu.TypeHierarchySupertypesRequest=pu.TypeHierarchyPrepareRequest=void 0;const gu=pa;var mu,vu,yu,bu,wu,xu;(vu=mu||(pu.TypeHierarchyPrepareRequest=mu={})).method="textDocument/prepareTypeHierarchy",vu.messageDirection=gu.MessageDirection.clientToServer,vu.type=new gu.ProtocolRequestType(vu.method),(bu=yu||(pu.TypeHierarchySupertypesRequest=yu={})).method="typeHierarchy/supertypes",bu.messageDirection=gu.MessageDirection.clientToServer,bu.type=new gu.ProtocolRequestType(bu.method),(xu=wu||(pu.TypeHierarchySubtypesRequest=wu={})).method="typeHierarchy/subtypes",xu.messageDirection=gu.MessageDirection.clientToServer,xu.type=new gu.ProtocolRequestType(xu.method);var Tu={};Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.InlineValueRefreshRequest=Tu.InlineValueRequest=void 0;const Du=pa;var Su,Ru,Ou,Cu;(Ru=Su||(Tu.InlineValueRequest=Su={})).method="textDocument/inlineValue",Ru.messageDirection=Du.MessageDirection.clientToServer,Ru.type=new Du.ProtocolRequestType(Ru.method),(Cu=Ou||(Tu.InlineValueRefreshRequest=Ou={})).method="workspace/inlineValue/refresh",Cu.messageDirection=Du.MessageDirection.serverToClient,Cu.type=new Du.ProtocolRequestType0(Cu.method);var ju={};Object.defineProperty(ju,"__esModule",{value:!0}),ju.InlayHintRefreshRequest=ju.InlayHintResolveRequest=ju.InlayHintRequest=void 0;const Eu=pa;var ku,Pu,Nu,_u,Iu,Mu;(Pu=ku||(ju.InlayHintRequest=ku={})).method="textDocument/inlayHint",Pu.messageDirection=Eu.MessageDirection.clientToServer,Pu.type=new Eu.ProtocolRequestType(Pu.method),(_u=Nu||(ju.InlayHintResolveRequest=Nu={})).method="inlayHint/resolve",_u.messageDirection=Eu.MessageDirection.clientToServer,_u.type=new Eu.ProtocolRequestType(_u.method),(Mu=Iu||(ju.InlayHintRefreshRequest=Iu={})).method="workspace/inlayHint/refresh",Mu.messageDirection=Eu.MessageDirection.serverToClient,Mu.type=new Eu.ProtocolRequestType0(Mu.method);var qu={};Object.defineProperty(qu,"__esModule",{value:!0}),qu.DiagnosticRefreshRequest=qu.WorkspaceDiagnosticRequest=qu.DocumentDiagnosticRequest=qu.DocumentDiagnosticReportKind=qu.DiagnosticServerCancellationData=void 0;const Au=yr,Lu=ba,Fu=pa;var Hu,Uu,Wu,Bu,zu,Vu,$u,Ku,Gu;(Hu||(qu.DiagnosticServerCancellationData=Hu={})).is=function(e){const t=e;return t&&Lu.boolean(t.retriggerRequest)},(Wu=Uu||(qu.DocumentDiagnosticReportKind=Uu={})).Full="full",Wu.Unchanged="unchanged",(zu=Bu||(qu.DocumentDiagnosticRequest=Bu={})).method="textDocument/diagnostic",zu.messageDirection=Fu.MessageDirection.clientToServer,zu.type=new Fu.ProtocolRequestType(zu.method),zu.partialResult=new Au.ProgressType,($u=Vu||(qu.WorkspaceDiagnosticRequest=Vu={})).method="workspace/diagnostic",$u.messageDirection=Fu.MessageDirection.clientToServer,$u.type=new Fu.ProtocolRequestType($u.method),$u.partialResult=new Au.ProgressType,(Gu=Ku||(qu.DiagnosticRefreshRequest=Ku={})).method="workspace/diagnostic/refresh",Gu.messageDirection=Fu.MessageDirection.serverToClient,Gu.type=new Fu.ProtocolRequestType0(Gu.method);var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.DidCloseNotebookDocumentNotification=Ju.DidSaveNotebookDocumentNotification=Ju.DidChangeNotebookDocumentNotification=Ju.NotebookCellArrayChange=Ju.DidOpenNotebookDocumentNotification=Ju.NotebookDocumentSyncRegistrationType=Ju.NotebookDocument=Ju.NotebookCell=Ju.ExecutionSummary=Ju.NotebookCellKind=void 0;const Xu=ha,Yu=ba,Qu=pa;var Zu,el,tl,nl,rl,il,ol,sl,al,cl,ul,ll,dl,fl,hl,pl,gl,ml,vl;(el=Zu||(Ju.NotebookCellKind=Zu={})).Markup=1,el.Code=2,el.is=function(e){return 1===e||2===e},(nl=tl||(Ju.ExecutionSummary=tl={})).create=function(e,t){const n={executionOrder:e};return!0!==t&&!1!==t||(n.success=t),n},nl.is=function(e){const t=e;return Yu.objectLiteral(t)&&Xu.uinteger.is(t.executionOrder)&&(void 0===t.success||Yu.boolean(t.success))},nl.equals=function(e,t){return e===t||null!=e&&null!=t&&e.executionOrder===t.executionOrder&&e.success===t.success},function(e){function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(typeof e!=typeof n)return!1;if("object"!=typeof e)return!1;const r=Array.isArray(e),i=Array.isArray(n);if(r!==i)return!1;if(r&&i){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1}if(Yu.objectLiteral(e)&&Yu.objectLiteral(n)){const r=Object.keys(e),i=Object.keys(n);if(r.length!==i.length)return!1;if(r.sort(),i.sort(),!t(r,i))return!1;for(let o=0;o<r.length;o++){const i=r[o];if(!t(e[i],n[i]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const t=e;return Yu.objectLiteral(t)&&Zu.is(t.kind)&&Xu.DocumentUri.is(t.document)&&(void 0===t.metadata||Yu.objectLiteral(t.metadata))},e.diff=function(e,n){const r=new Set;return e.document!==n.document&&r.add("document"),e.kind!==n.kind&&r.add("kind"),e.executionSummary!==n.executionSummary&&r.add("executionSummary"),void 0===e.metadata&&void 0===n.metadata||t(e.metadata,n.metadata)||r.add("metadata"),void 0===e.executionSummary&&void 0===n.executionSummary||tl.equals(e.executionSummary,n.executionSummary)||r.add("executionSummary"),r}}(rl||(Ju.NotebookCell=rl={})),(ol=il||(Ju.NotebookDocument=il={})).create=function(e,t,n,r){return{uri:e,notebookType:t,version:n,cells:r}},ol.is=function(e){const t=e;return Yu.objectLiteral(t)&&Yu.string(t.uri)&&Xu.integer.is(t.version)&&Yu.typedArray(t.cells,rl.is)},(al=sl||(Ju.NotebookDocumentSyncRegistrationType=sl={})).method="notebookDocument/sync",al.messageDirection=Qu.MessageDirection.clientToServer,al.type=new Qu.RegistrationType(al.method),(ul=cl||(Ju.DidOpenNotebookDocumentNotification=cl={})).method="notebookDocument/didOpen",ul.messageDirection=Qu.MessageDirection.clientToServer,ul.type=new Qu.ProtocolNotificationType(ul.method),ul.registrationMethod=sl.method,(dl=ll||(Ju.NotebookCellArrayChange=ll={})).is=function(e){const t=e;return Yu.objectLiteral(t)&&Xu.uinteger.is(t.start)&&Xu.uinteger.is(t.deleteCount)&&(void 0===t.cells||Yu.typedArray(t.cells,rl.is))},dl.create=function(e,t,n){const r={start:e,deleteCount:t};return void 0!==n&&(r.cells=n),r},(hl=fl||(Ju.DidChangeNotebookDocumentNotification=fl={})).method="notebookDocument/didChange",hl.messageDirection=Qu.MessageDirection.clientToServer,hl.type=new Qu.ProtocolNotificationType(hl.method),hl.registrationMethod=sl.method,(gl=pl||(Ju.DidSaveNotebookDocumentNotification=pl={})).method="notebookDocument/didSave",gl.messageDirection=Qu.MessageDirection.clientToServer,gl.type=new Qu.ProtocolNotificationType(gl.method),gl.registrationMethod=sl.method,(vl=ml||(Ju.DidCloseNotebookDocumentNotification=ml={})).method="notebookDocument/didClose",vl.messageDirection=Qu.MessageDirection.clientToServer,vl.type=new Qu.ProtocolNotificationType(vl.method),vl.registrationMethod=sl.method;var yl={};Object.defineProperty(yl,"__esModule",{value:!0}),yl.InlineCompletionRequest=void 0;const bl=pa;var wl,xl;(xl=wl||(yl.InlineCompletionRequest=wl={})).method="textDocument/inlineCompletion",xl.messageDirection=bl.MessageDirection.clientToServer,xl.type=new bl.ProtocolRequestType(xl.method),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRefreshRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangesFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.InlineCompletionRequest=e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=void 0;const t=pa,n=ha,r=ba,i=Ta;Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const o=Oa;Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const s=ka;Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const a=qa;Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return a.ConfigurationRequest}});const c=Ha;Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=$a;Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}}),Object.defineProperty(e,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u.FoldingRangeRefreshRequest}});const l=Qa;Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return l.DeclarationRequest}});const d=nc;Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const f=sc;Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return f.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return f.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return f.WorkDoneProgressCancelNotification}});const h=gc;Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const p=Dc;Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return p.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return p.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return p.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return p.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return p.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return p.SemanticTokensRegistrationType}});const g=qc;Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const m=Hc;Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return m.LinkedEditingRangeRequest}});const v=zc;Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return v.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return v.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return v.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return v.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return v.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return v.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return v.WillDeleteFilesRequest}});const y=su;Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return y.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return y.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return y.MonikerRequest}});const b=pu;Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return b.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return b.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return b.TypeHierarchySupertypesRequest}});const w=Tu;Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return w.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return w.InlineValueRefreshRequest}});const x=ju;Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return x.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return x.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return x.InlayHintRefreshRequest}});const T=qu;Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return T.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return T.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return T.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return T.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return T.DiagnosticRefreshRequest}});const D=Ju;Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return D.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return D.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return D.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return D.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return D.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return D.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return D.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return D.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return D.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return D.DidCloseNotebookDocumentNotification}});const S=yl;var R,O,C,j,E,k,P,N,_,I,M,q,A,L,F,H,U,W,B,z,V,$,K,G,J,X,Y,Q,Z,ee,te,ne,re,ie,oe,se,ae,ce,ue,le,de,fe,he,pe,ge,me,ve,ye,be,we,xe,Te,De,Se,Re,Oe,Ce,je,Ee,ke,Pe,Ne,_e,Ie,Me,qe,Ae,Le,Fe,He,Ue,We,Be,ze,Ve,$e,Ke,Ge,Je,Xe,Ye,Qe,Ze,et,tt,nt,rt,it,ot,st,at,ct,ut,lt,dt,ft,ht,pt,gt,mt,vt,yt,bt,wt,xt,Tt,Dt,St,Rt,Ot,Ct,jt,Et,kt,Pt,Nt,_t,It,Mt,qt,At;Object.defineProperty(e,"InlineCompletionRequest",{enumerable:!0,get:function(){return S.InlineCompletionRequest}}),(R||(e.TextDocumentFilter=R={})).is=function(e){const t=e;return r.string(t)||r.string(t.language)||r.string(t.scheme)||r.string(t.pattern)},(O||(e.NotebookDocumentFilter=O={})).is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebookType)||r.string(t.scheme)||r.string(t.pattern))},(C||(e.NotebookCellTextDocumentFilter=C={})).is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebook)||O.is(t.notebook))&&(void 0===t.language||r.string(t.language))},(j||(e.DocumentSelector=j={})).is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!r.string(t)&&!R.is(t)&&!C.is(t))return!1;return!0},(k=E||(e.RegistrationRequest=E={})).method="client/registerCapability",k.messageDirection=t.MessageDirection.serverToClient,k.type=new t.ProtocolRequestType(k.method),(N=P||(e.UnregistrationRequest=P={})).method="client/unregisterCapability",N.messageDirection=t.MessageDirection.serverToClient,N.type=new t.ProtocolRequestType(N.method),(I=_||(e.ResourceOperationKind=_={})).Create="create",I.Rename="rename",I.Delete="delete",(q=M||(e.FailureHandlingKind=M={})).Abort="abort",q.Transactional="transactional",q.TextOnlyTransactional="textOnlyTransactional",q.Undo="undo",(L=A||(e.PositionEncodingKind=A={})).UTF8="utf-8",L.UTF16="utf-16",L.UTF32="utf-32",(F||(e.StaticRegistrationOptions=F={})).hasId=function(e){const t=e;return t&&r.string(t.id)&&t.id.length>0},(H||(e.TextDocumentRegistrationOptions=H={})).is=function(e){const t=e;return t&&(null===t.documentSelector||j.is(t.documentSelector))},(W=U||(e.WorkDoneProgressOptions=U={})).is=function(e){const t=e;return r.objectLiteral(t)&&(void 0===t.workDoneProgress||r.boolean(t.workDoneProgress))},W.hasWorkDoneProgress=function(e){const t=e;return t&&r.boolean(t.workDoneProgress)},(z=B||(e.InitializeRequest=B={})).method="initialize",z.messageDirection=t.MessageDirection.clientToServer,z.type=new t.ProtocolRequestType(z.method),(V||(e.InitializeErrorCodes=V={})).unknownProtocolVersion=1,(K=$||(e.InitializedNotification=$={})).method="initialized",K.messageDirection=t.MessageDirection.clientToServer,K.type=new t.ProtocolNotificationType(K.method),(J=G||(e.ShutdownRequest=G={})).method="shutdown",J.messageDirection=t.MessageDirection.clientToServer,J.type=new t.ProtocolRequestType0(J.method),(Y=X||(e.ExitNotification=X={})).method="exit",Y.messageDirection=t.MessageDirection.clientToServer,Y.type=new t.ProtocolNotificationType0(Y.method),(Z=Q||(e.DidChangeConfigurationNotification=Q={})).method="workspace/didChangeConfiguration",Z.messageDirection=t.MessageDirection.clientToServer,Z.type=new t.ProtocolNotificationType(Z.method),(te=ee||(e.MessageType=ee={})).Error=1,te.Warning=2,te.Info=3,te.Log=4,te.Debug=5,(re=ne||(e.ShowMessageNotification=ne={})).method="window/showMessage",re.messageDirection=t.MessageDirection.serverToClient,re.type=new t.ProtocolNotificationType(re.method),(oe=ie||(e.ShowMessageRequest=ie={})).method="window/showMessageRequest",oe.messageDirection=t.MessageDirection.serverToClient,oe.type=new t.ProtocolRequestType(oe.method),(ae=se||(e.LogMessageNotification=se={})).method="window/logMessage",ae.messageDirection=t.MessageDirection.serverToClient,ae.type=new t.ProtocolNotificationType(ae.method),(ue=ce||(e.TelemetryEventNotification=ce={})).method="telemetry/event",ue.messageDirection=t.MessageDirection.serverToClient,ue.type=new t.ProtocolNotificationType(ue.method),(de=le||(e.TextDocumentSyncKind=le={})).None=0,de.Full=1,de.Incremental=2,(he=fe||(e.DidOpenTextDocumentNotification=fe={})).method="textDocument/didOpen",he.messageDirection=t.MessageDirection.clientToServer,he.type=new t.ProtocolNotificationType(he.method),(ge=pe||(e.TextDocumentContentChangeEvent=pe={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},ge.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(ve=me||(e.DidChangeTextDocumentNotification=me={})).method="textDocument/didChange",ve.messageDirection=t.MessageDirection.clientToServer,ve.type=new t.ProtocolNotificationType(ve.method),(be=ye||(e.DidCloseTextDocumentNotification=ye={})).method="textDocument/didClose",be.messageDirection=t.MessageDirection.clientToServer,be.type=new t.ProtocolNotificationType(be.method),(xe=we||(e.DidSaveTextDocumentNotification=we={})).method="textDocument/didSave",xe.messageDirection=t.MessageDirection.clientToServer,xe.type=new t.ProtocolNotificationType(xe.method),(De=Te||(e.TextDocumentSaveReason=Te={})).Manual=1,De.AfterDelay=2,De.FocusOut=3,(Re=Se||(e.WillSaveTextDocumentNotification=Se={})).method="textDocument/willSave",Re.messageDirection=t.MessageDirection.clientToServer,Re.type=new t.ProtocolNotificationType(Re.method),(Ce=Oe||(e.WillSaveTextDocumentWaitUntilRequest=Oe={})).method="textDocument/willSaveWaitUntil",Ce.messageDirection=t.MessageDirection.clientToServer,Ce.type=new t.ProtocolRequestType(Ce.method),(Ee=je||(e.DidChangeWatchedFilesNotification=je={})).method="workspace/didChangeWatchedFiles",Ee.messageDirection=t.MessageDirection.clientToServer,Ee.type=new t.ProtocolNotificationType(Ee.method),(Pe=ke||(e.FileChangeType=ke={})).Created=1,Pe.Changed=2,Pe.Deleted=3,(Ne||(e.RelativePattern=Ne={})).is=function(e){const t=e;return r.objectLiteral(t)&&(n.URI.is(t.baseUri)||n.WorkspaceFolder.is(t.baseUri))&&r.string(t.pattern)},(Ie=_e||(e.WatchKind=_e={})).Create=1,Ie.Change=2,Ie.Delete=4,(qe=Me||(e.PublishDiagnosticsNotification=Me={})).method="textDocument/publishDiagnostics",qe.messageDirection=t.MessageDirection.serverToClient,qe.type=new t.ProtocolNotificationType(qe.method),(Le=Ae||(e.CompletionTriggerKind=Ae={})).Invoked=1,Le.TriggerCharacter=2,Le.TriggerForIncompleteCompletions=3,(He=Fe||(e.CompletionRequest=Fe={})).method="textDocument/completion",He.messageDirection=t.MessageDirection.clientToServer,He.type=new t.ProtocolRequestType(He.method),(We=Ue||(e.CompletionResolveRequest=Ue={})).method="completionItem/resolve",We.messageDirection=t.MessageDirection.clientToServer,We.type=new t.ProtocolRequestType(We.method),(ze=Be||(e.HoverRequest=Be={})).method="textDocument/hover",ze.messageDirection=t.MessageDirection.clientToServer,ze.type=new t.ProtocolRequestType(ze.method),($e=Ve||(e.SignatureHelpTriggerKind=Ve={})).Invoked=1,$e.TriggerCharacter=2,$e.ContentChange=3,(Ge=Ke||(e.SignatureHelpRequest=Ke={})).method="textDocument/signatureHelp",Ge.messageDirection=t.MessageDirection.clientToServer,Ge.type=new t.ProtocolRequestType(Ge.method),(Xe=Je||(e.DefinitionRequest=Je={})).method="textDocument/definition",Xe.messageDirection=t.MessageDirection.clientToServer,Xe.type=new t.ProtocolRequestType(Xe.method),(Qe=Ye||(e.ReferencesRequest=Ye={})).method="textDocument/references",Qe.messageDirection=t.MessageDirection.clientToServer,Qe.type=new t.ProtocolRequestType(Qe.method),(et=Ze||(e.DocumentHighlightRequest=Ze={})).method="textDocument/documentHighlight",et.messageDirection=t.MessageDirection.clientToServer,et.type=new t.ProtocolRequestType(et.method),(nt=tt||(e.DocumentSymbolRequest=tt={})).method="textDocument/documentSymbol",nt.messageDirection=t.MessageDirection.clientToServer,nt.type=new t.ProtocolRequestType(nt.method),(it=rt||(e.CodeActionRequest=rt={})).method="textDocument/codeAction",it.messageDirection=t.MessageDirection.clientToServer,it.type=new t.ProtocolRequestType(it.method),(st=ot||(e.CodeActionResolveRequest=ot={})).method="codeAction/resolve",st.messageDirection=t.MessageDirection.clientToServer,st.type=new t.ProtocolRequestType(st.method),(ct=at||(e.WorkspaceSymbolRequest=at={})).method="workspace/symbol",ct.messageDirection=t.MessageDirection.clientToServer,ct.type=new t.ProtocolRequestType(ct.method),(lt=ut||(e.WorkspaceSymbolResolveRequest=ut={})).method="workspaceSymbol/resolve",lt.messageDirection=t.MessageDirection.clientToServer,lt.type=new t.ProtocolRequestType(lt.method),(ft=dt||(e.CodeLensRequest=dt={})).method="textDocument/codeLens",ft.messageDirection=t.MessageDirection.clientToServer,ft.type=new t.ProtocolRequestType(ft.method),(pt=ht||(e.CodeLensResolveRequest=ht={})).method="codeLens/resolve",pt.messageDirection=t.MessageDirection.clientToServer,pt.type=new t.ProtocolRequestType(pt.method),(mt=gt||(e.CodeLensRefreshRequest=gt={})).method="workspace/codeLens/refresh",mt.messageDirection=t.MessageDirection.serverToClient,mt.type=new t.ProtocolRequestType0(mt.method),(yt=vt||(e.DocumentLinkRequest=vt={})).method="textDocument/documentLink",yt.messageDirection=t.MessageDirection.clientToServer,yt.type=new t.ProtocolRequestType(yt.method),(wt=bt||(e.DocumentLinkResolveRequest=bt={})).method="documentLink/resolve",wt.messageDirection=t.MessageDirection.clientToServer,wt.type=new t.ProtocolRequestType(wt.method),(Tt=xt||(e.DocumentFormattingRequest=xt={})).method="textDocument/formatting",Tt.messageDirection=t.MessageDirection.clientToServer,Tt.type=new t.ProtocolRequestType(Tt.method),(St=Dt||(e.DocumentRangeFormattingRequest=Dt={})).method="textDocument/rangeFormatting",St.messageDirection=t.MessageDirection.clientToServer,St.type=new t.ProtocolRequestType(St.method),(Ot=Rt||(e.DocumentRangesFormattingRequest=Rt={})).method="textDocument/rangesFormatting",Ot.messageDirection=t.MessageDirection.clientToServer,Ot.type=new t.ProtocolRequestType(Ot.method),(jt=Ct||(e.DocumentOnTypeFormattingRequest=Ct={})).method="textDocument/onTypeFormatting",jt.messageDirection=t.MessageDirection.clientToServer,jt.type=new t.ProtocolRequestType(jt.method),(Et||(e.PrepareSupportDefaultBehavior=Et={})).Identifier=1,(Pt=kt||(e.RenameRequest=kt={})).method="textDocument/rename",Pt.messageDirection=t.MessageDirection.clientToServer,Pt.type=new t.ProtocolRequestType(Pt.method),(_t=Nt||(e.PrepareRenameRequest=Nt={})).method="textDocument/prepareRename",_t.messageDirection=t.MessageDirection.clientToServer,_t.type=new t.ProtocolRequestType(_t.method),(Mt=It||(e.ExecuteCommandRequest=It={})).method="workspace/executeCommand",Mt.messageDirection=t.MessageDirection.clientToServer,Mt.type=new t.ProtocolRequestType(Mt.method),(At=qt||(e.ApplyWorkspaceEditRequest=qt={})).method="workspace/applyEdit",At.messageDirection=t.MessageDirection.serverToClient,At.type=new t.ProtocolRequestType("workspace/applyEdit")}(ya);var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.createProtocolConnection=void 0;const Dl=yr;Tl.createProtocolConnection=function(e,t,n,r){return Dl.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Dl.createMessageConnection)(e,t,n,r)},function(e){var t=A&&A.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=A&&A.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,n(yr,e),n(ha,e),n(pa,e),n(ya,e);var r,i,o=Tl;Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return o.createProtocolConnection}}),(i=r||(e.LSPErrorCodes=r={})).lspReservedErrorRangeStart=-32899,i.RequestFailed=-32803,i.ServerCancelled=-32802,i.ContentModified=-32801,i.RequestCancelled=-32800,i.lspReservedErrorRangeEnd=-32800}(aa),function(e){var t=A&&A.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=A&&A.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const r=sa;n(sa,e),n(aa,e),e.createProtocolConnection=function(e,t,n,i){return(0,r.createMessageConnection)(e,t,n,i)}}(vr);const Sl=1e4,Rl=Object.fromEntries(Object.entries(vr.CompletionItemKind).map((([e,t])=>[t,e]))),Ol=e=>e.reduce(((e,t)=>t),""),Cl=F.define({combine:Ol}),jl=F.define({combine:Ol}),El=F.define({combine:Ol});class kl{constructor(e){this.rootUri=e.rootUri,this.workspaceFolders=e.workspaceFolders,this.autoClose=e.autoClose,this.plugins=[],this.transport=e.transport,this.requestManager=new jt.RequestManager([this.transport]),this.client=new jt.Client(this.requestManager),this.client.onNotification((e=>{this.processNotification(e)}));const t=this.transport;t&&t.connection&&t.connection.addEventListener("message",(e=>{const n=JSON.parse(e.data);n.method&&n.id&&t.connection.send(JSON.stringify({jsonrpc:"2.0",id:n.id,result:null}))})),this.initializePromise=this.initialize()}async initialize(){const{capabilities:e}=await this.request("initialize",{capabilities:{textDocument:{hover:{dynamicRegistration:!0,contentFormat:["plaintext","markdown"]},moniker:{},synchronization:{dynamicRegistration:!0,willSave:!1,didSave:!1,willSaveWaitUntil:!1},completion:{dynamicRegistration:!0,completionItem:{snippetSupport:!1,commitCharactersSupport:!0,documentationFormat:["plaintext","markdown"],deprecatedSupport:!1,preselectSupport:!1},contextSupport:!1},signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["plaintext","markdown"]}},declaration:{dynamicRegistration:!0,linkSupport:!0},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0,linkSupport:!0},implementation:{dynamicRegistration:!0,linkSupport:!0}},workspace:{didChangeConfiguration:{dynamicRegistration:!0}}},initializationOptions:null,processId:null,rootUri:this.rootUri,workspaceFolders:this.workspaceFolders},3e4);this.capabilities=e,this.notify("initialized",{}),this.ready=!0}close(){this.client.close()}textDocumentDidOpen(e){return this.notify("textDocument/didOpen",e)}textDocumentDidChange(e){return this.notify("textDocument/didChange",e)}async textDocumentHover(e){return await this.request("textDocument/hover",e,Sl)}async textDocumentCompletion(e){return await this.request("textDocument/completion",e,Sl)}attachPlugin(e){this.plugins.push(e)}detachPlugin(e){const t=this.plugins.indexOf(e);-1!==t&&(this.plugins.splice(t,1),this.autoClose&&this.close())}request(e,t,n){return this.client.request({method:e,params:t},n)}notify(e,t){return this.client.notify({method:e,params:t})}processNotification(e){for(const t of this.plugins)t.processNotification(e)}}class Pl{constructor(e,t){this.view=e,this.allowHTMLContent=t,this.client=this.view.state.facet(Cl),this.documentUri=this.view.state.facet(jl),this.languageId=this.view.state.facet(El),this.documentVersion=0,this.changesTimeout=0,this.client.attachPlugin(this),this.initialize({documentText:this.view.state.doc.toString()})}update({docChanged:e}){e&&(this.changesTimeout&&clearTimeout(this.changesTimeout),this.changesTimeout=self.setTimeout((()=>{this.sendChange({documentText:this.view.state.doc.toString()})}),500))}destroy(){this.client.detachPlugin(this)}async initialize({documentText:e}){this.client.initializePromise&&await this.client.initializePromise,this.client.textDocumentDidOpen({textDocument:{uri:this.documentUri,languageId:this.languageId,text:e,version:this.documentVersion}})}async sendChange({documentText:e}){if(this.client.ready)try{await this.client.textDocumentDidChange({textDocument:{uri:this.documentUri,version:this.documentVersion++},contentChanges:[{text:e}]})}catch(t){console.error(t)}}requestDiagnostics(e){this.sendChange({documentText:e.state.doc.toString()})}async requestHoverTooltip(e,{line:t,character:n}){if(!this.client.ready||!this.client.capabilities.hoverProvider)return null;this.sendChange({documentText:e.state.doc.toString()});const r=await this.client.textDocumentHover({textDocument:{uri:this.documentUri},position:{line:t,character:n}});if(!r)return null;const{contents:i,range:o}=r;let s,a=Nl(e.state.doc,{line:t,character:n});if(o&&(a=Nl(e.state.doc,o.start),s=Nl(e.state.doc,o.end)),null===a)return null;const c=document.createElement("div");return c.classList.add("documentation"),this.allowHTMLContent?c.innerHTML=Il(i):c.textContent=Il(i),{pos:a,end:s,create:e=>({dom:c}),above:!0}}async requestCompletion(e,{line:t,character:n},{triggerKind:r,triggerCharacter:i}){if(!this.client.ready||!this.client.capabilities.completionProvider)return null;this.sendChange({documentText:e.state.doc.toString()});const o=await this.client.textDocumentCompletion({textDocument:{uri:this.documentUri},position:{line:t,character:n},context:{triggerKind:r,triggerCharacter:i}});if(!o)return null;let s=("items"in o?o.items:o).map((({detail:e,label:t,kind:n,textEdit:r,documentation:i,sortText:o,filterText:s})=>{var a;const c={label:t,detail:e,apply:null!==(a=null==r?void 0:r.newText)&&void 0!==a?a:t,type:n&&Rl[n].toLowerCase(),sortText:null!=o?o:t,filterText:null!=s?s:t};return i&&(c.info=Il(i)),c}));const[a,c]=function(e){const t=new Set,n=new Set;for(const{apply:i}of e){const[e,...r]=i;t.add(e);for(const t of r)n.add(t)}const r=Ml(t)+Ml(n)+"*$";return[new RegExp("^"+r),new RegExp(r)]}(s),u=e.matchBefore(c);let{pos:l}=e;if(u){l=u.from;const e=u.text.toLowerCase();/^\w+$/.test(e)&&(s=s.filter((({filterText:t})=>t.toLowerCase().startsWith(e))).sort((({apply:e},{apply:t})=>{switch(!0){case e.startsWith(u.text)&&!t.startsWith(u.text):return-1;case!e.startsWith(u.text)&&t.startsWith(u.text):return 1}return 0})))}return{from:l,options:s}}processNotification(e){try{if("textDocument/publishDiagnostics"===e.method)this.processDiagnostics(e.params)}catch(t){console.error(t)}}processDiagnostics(e){if(e.uri!==this.documentUri)return;const t=e.diagnostics.map((({range:e,message:t,severity:n})=>({from:Nl(this.view.state.doc,e.start),to:Nl(this.view.state.doc,e.end),severity:{[vr.DiagnosticSeverity.Error]:"error",[vr.DiagnosticSeverity.Warning]:"warning",[vr.DiagnosticSeverity.Information]:"info",[vr.DiagnosticSeverity.Hint]:"info"}[n],message:t}))).filter((({from:e,to:t})=>null!==e&&null!==t&&void 0!==e&&void 0!==t)).sort(((e,t)=>{switch(!0){case e.from<t.from:return-1;case e.from>t.from:return 1}return 0}));this.view.dispatch(W(this.view.state,t))}}function Nl(e,t){if(t.line>=e.lines)return;const n=e.line(t.line+1).from+t.character;return n>e.length?void 0:n}function _l(e,t){const n=e.lineAt(t);return{line:n.number-1,character:t-n.from}}function Il(e){return Array.isArray(e)?e.map((e=>Il(e)+"\n\n")).join(""):"string"==typeof e?e:e.value}function Ml(e){let t="",n=Array.from(e).join("");return/\w/.test(n)&&(t+="\\w",n=n.replace(/\w/g,"")),`[${t}${n.replace(/[^\w\s]/g,"\\$&")}]`}function ql(e){return[...B().map((t=>{const n=z(t);return n===e?null:n})).filter(Boolean).sort(((e,t)=>e.startsWith("import")&&!t.startsWith("import")?-1:!e.startsWith("import")&&t.startsWith("import")?1:0)),e].join("\n")}class Al extends kl{constructor(){super(...arguments),t(this,"documentVersion",0),t(this,"getCompletionInternal",(async(e,t)=>await this._request("getCompletions",{doc:{...e.doc,version:t}}))),t(this,"throttledGetCompletionInternal",function(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),i(e,t,{leading:o,maxWait:t,trailing:s})}(this.getCompletionInternal,200))}_request(e,t){return this.request(e,t)}isDisabled(){return!Ot()}async textDocumentDidOpen(e){return this.isDisabled()?e:super.textDocumentDidOpen(e)}async textDocumentCompletion(e){return this.isDisabled()?[]:super.textDocumentCompletion(e)}async textDocumentDidChange(e){return this.isDisabled()?e:super.textDocumentDidChange({...e,contentChanges:[{text:ql(e.contentChanges[0].text)}],textDocument:vr.VersionedTextDocumentIdentifier.create(e.textDocument.uri,++this.documentVersion)})}textDocumentHover(e){return this.isDisabled()?Promise.resolve({contents:[]}):super.textDocumentHover(e)}signOut(){return this._request("signOut",{})}signInInitiate(){return this._request("signInInitiate",{})}signInConfirm(e){return this._request("signInConfirm",e)}async signedIn(){const{status:e,user:t}=await this._request("checkStatus",{});return R.debug("Copilot#signedIn",e,t),"SignedIn"===e||"AlreadySignedIn"===e||"OK"===e}acceptCompletion(e){return this._request("notifyAccepted",e)}rejectCompletions(e){return this._request("notifyRejected",e)}async getCompletion(e){if(this.isDisabled())return{completions:[]};const t=this.documentVersion;if(e.doc.version=t,0===t)return{completions:[]};var n;n=t,_.set(Rt,n);const r=await this.throttledGetCompletionInternal(e,t);var i;return i=t,_.get(Rt)===i&&_.set(Rt,null),t!==this.documentVersion?{completions:[]}:r||{completions:[]}}}async function Ll(e){return new Promise(((t,n)=>{const r=new WebSocket(e);r.onopen=()=>{r.close(),t(e)},r.onerror=t=>{r.close(),n(new Error(`Failed to connect to ${e}: ${t.type}`))}}))}const Fl="/marimo.py",Hl="copilot",Ul=`file://${Fl}`,Wl=x((()=>new Bl));class Bl extends Zt{constructor(){super(),t(this,"delegate"),this.delegate=void 0}async connect(){return await M(q,(e=>"github"===e.completion.copilot)),await async function(e,t=5){for(let n=0;n<t;n++)try{return await Ll(e)}catch{await new Promise((e=>setTimeout(e,1e3*(n+1))))}throw new Error(`Failed to connect to ${e}`)}(Kl(),3),this.delegate||(this.delegate=new jt.WebSocketTransport(Kl())),this.delegate.connect()}close(){var e;null==(e=this.delegate)||e.close()}async sendData(e,t){var n;return null==(n=this.delegate)?void 0:n.sendData(e,t)}}const zl=x((()=>new Al({rootUri:Ul,documentUri:Ul,languageId:Hl,workspaceFolders:null,transport:Wl()})));function Vl(){return function(e){let t=null;return[Cl.of(e.client||new kl({...e,autoClose:!0})),jl.of(e.documentUri),El.of(e.languageId),w.define((n=>t=new Pl(n,e.allowHTMLContent))),H(((e,n)=>{var r;return null!==(r=null==t?void 0:t.requestHoverTooltip(e,_l(e.state.doc,n)))&&void 0!==r?r:null})),U({override:[async e=>{var n,r,i;if(null==t)return null;const{state:o,pos:s,explicit:a}=e,c=o.doc.lineAt(s);let u,l=vr.CompletionTriggerKind.Invoked;return!a&&(null===(i=null===(r=null===(n=t.client.capabilities)||void 0===n?void 0:n.completionProvider)||void 0===r?void 0:r.triggerCharacters)||void 0===i?void 0:i.includes(c.text[s-c.from-1]))&&(l=vr.CompletionTriggerKind.TriggerCharacter,u=c.text[s-c.from-1]),l!==vr.CompletionTriggerKind.Invoked||e.matchBefore(/\w+$/)?await t.requestCompletion(e,_l(o.doc,s),{triggerKind:l,triggerCharacter:u}):null}]})]}({rootUri:Ul,documentUri:Ul,workspaceFolders:[],transport:Wl(),client:zl(),languageId:Hl})}const $l=27180;function Kl(){const e=window.location.port?`${window.location.port}0`:$l;return`${"https:"===window.location.protocol?"wss":"ws"}://${window.location.hostname}:${e}/copilot`}const Gl=o.memo((()=>{const[e,t]=V(St),[n,r]=o.useState(),[i,s]=o.useState(),[a,u]=o.useState(!1);o.useEffect((()=>{const e=zl();e.initializePromise.catch((()=>{t(!1),r("notConnected")})),e.signedIn().then((e=>{t(e),r(e?"signedIn":"signedOut")})).catch((()=>{t(!1),r("notConnected")}))}),[]);const l=async e=>{e.preventDefault(),u(!0);try{const e=zl(),{verificationUri:n,status:i,userCode:o}=await e.signInInitiate();"OK"===i||"AlreadySignedIn"===i?t(!0):(r("signingIn"),s({url:n,code:o}))}finally{u(!1)}},d=async e=>{if(e.preventDefault(),!i)return;const n=zl();try{u(!0);const{status:e}=await n.signInConfirm({userCode:i.code});"OK"===e||"AlreadySignedIn"===e?(t(!0),r("signedIn")):r("signInFailed")}catch{for(let e=0;e<3;e++){await new Promise((e=>setTimeout(e,1e3)));if(await n.signedIn())return t(!0),void r("signedIn")}r("signInFailed")}finally{u(!1)}},f=async e=>{e.preventDefault();const n=zl();t(!1),r("signedOut"),await n.signOut()};return(()=>{switch(n??(e?"signedIn":"connecting")){case"connecting":return c.jsx($,{className:"font-normal flex",children:"Connecting..."});case"signedOut":return c.jsx(G,{onClick:l,size:"xs",variant:"link",children:"Sign in to GitHub Copilot"});case"signingIn":return c.jsxs("ol",{className:"ml-4 text-sm list-decimal [&>li]:mt-2",children:[c.jsx("li",{children:c.jsxs("div",{className:"flex items-center",children:["Copy this code:",c.jsx("strong",{className:"ml-2",children:null==i?void 0:i.code}),c.jsx(X,{className:"ml-2 cursor-pointer opacity-60 hover:opacity-100 h-3 w-3",onClick:()=>{i&&(navigator.clipboard.writeText(i.code),Y({description:"Copied to clipboard"}))}})]})}),c.jsxs("li",{children:["Enter the code at this link:",c.jsx("a",{href:null==i?void 0:i.url,target:"_blank",rel:"noreferrer",className:Q({variant:"link",size:"xs"}),children:null==i?void 0:i.url})]}),c.jsxs("li",{children:["Click here when done:",c.jsxs(G,{size:"xs",onClick:d,className:"ml-1",children:[a&&c.jsx(J,{className:"h-3 w-3 mr-1 animate-spin"}),"Done"]})]})]});case"signInFailed":return c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("div",{className:"text-destructive text-sm",children:"Sign in failed. Please try again."}),a?c.jsx(J,{className:"h-3 w-3 mr-1 animate-spin"}):c.jsx(G,{onClick:l,size:"xs",variant:"link",children:"Connect to GitHub Copilot"})]});case"signedIn":return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs($,{className:"font-normal flex",children:[c.jsx(K,{className:"h-4 w-4 mr-1"}),"Connected"]}),c.jsx(G,{onClick:f,size:"xs",variant:"text",children:"Disconnect"})]});case"notConnected":return c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs($,{className:"font-normal flex",children:[c.jsx(h,{className:"h-4 w-4 mr-1"}),"Unable to connect"]}),c.jsxs("div",{className:"text-sm",children:["For troubleshooting, see the"," ",c.jsx("a",{className:"hyperlink",href:"https://docs.marimo.io/getting_started/index.html#github-copilot",target:"_blank",rel:"noreferrer",children:"docs"}),"."]})]})}})()}));Gl.displayName="CopilotConfig";const Jl=({children:e})=>c.jsx("div",{className:"text-md font-semibold text-muted-foreground uppercase tracking-wide  mb-1",children:e}),Xl=({children:e})=>c.jsx("div",{className:"text-sm font-semibold underline-offset-2 text-accent-foreground uppercase tracking-wide",children:e}),Yl=({children:e})=>c.jsx("p",{className:"text-sm text-muted-foreground",children:e}),Ql=e=>c.jsx("kbd",{className:u(e.className,"rounded-md bg-muted/40 px-2 text-[0.75rem] font-prose center border border-foreground/20 text-muted-foreground block"),children:e.children}),Zl=N({});function ed(){return Z(Zl)}function td(e,t){const{registerAction:n,unregisterAction:r}=function(){const e=ee(Zl);return{registerAction:(t,n)=>{e((e=>({...e,[t]:n})))},unregisterAction:t=>{e((e=>{const{[t]:n,...r}=e;return r}))}}}(),i=Z(te),s=t===ie.NOOP,a=ne((()=>t())),c=ne((n=>{const r=i.getHotkey(e).key;if(re(r)(n)){!1!==t()&&(n.preventDefault(),n.stopPropagation())}}));g(document,"keydown",c),o.useEffect((()=>{if(!s)return n(e,a),()=>r(e)}),[a,e,s])}function nd(e,t){const n=Z(te);g(e,"keydown",(e=>{for(const[r,i]of oe.entries(t)){const t=n.getHotkey(r).key;if(re(t)(e)){R.debug("Satisfied",t,e);!1!==i()&&(e.preventDefault(),e.stopPropagation())}}}))}function rd(e,t){g(e,"keydown",(e=>{for(const[n,r]of oe.entries(t))if(re(n)(e)){R.debug("Satisfied",n,e);!1!==r()&&(e.preventDefault(),e.stopPropagation())}}))}function id(e){return c.jsx(od,{shortcut:e})}const od=({shortcut:e})=>{const t=Z(te).getHotkey(e);return c.jsxs("span",{className:"flex",children:[c.jsx("span",{className:"mr-2",children:t.name}),c.jsx(sd,{shortcut:t.key})]})},sd=({shortcut:e,className:t})=>{const n=e.split("-");return c.jsx("div",{className:se("flex gap-1",t),children:n.map(ld).map((([e,t])=>t?c.jsx(d,{asChild:!1,tabIndex:-1,content:e,delayDuration:300,children:c.jsx(Ql,{children:t},e)},e):c.jsx(Ql,{children:fd(e)},e)))})};function ad(e){return c.jsx(cd,{shortcut:e})}const cd=({className:e,shortcut:t})=>{const n=Z(te).getHotkey(t);return c.jsx(ud,{shortcut:n.key,className:e})},ud=({shortcut:e,className:t})=>{const n=e.split("-");return c.jsx(ce,{className:se("flex gap-1 items-center",t),children:n.map(ld).map((([e,t])=>t?c.jsx(d,{content:e,delayDuration:300,tabIndex:-1,children:c.jsx("span",{children:t},e)},e):c.jsx("span",{children:fd(e)},e)))})};function ld(e){const t=ae()?"mac":"default",n=e.toLowerCase(),r=dd[e.toLowerCase()];if(r){const e=r.symbols[t]||r.symbols.default;return[r.label,e]}return[n]}const dd={ctrl:{symbols:{mac:"⌃",default:"Ctrl"},label:"Control"},control:{symbols:{mac:"⌃",default:"Ctrl"},label:"Control"},shift:{symbols:{mac:"⇧",default:"Shift"},label:"Shift"},alt:{symbols:{mac:"⌥",default:"Alt"},label:"Alt/Option"},escape:{symbols:{mac:"⎋",default:"Esc"},label:"Escape"},arrowup:{symbols:{default:"↑"},label:"Arrow Up"},arrowdown:{symbols:{default:"↓"},label:"Arrow Down"},arrowleft:{symbols:{default:"←"},label:"Arrow Left"},arrowright:{symbols:{default:"→"},label:"Arrow Right"},backspace:{symbols:{mac:"⌫",default:"⟵"},label:"Backspace"},tab:{symbols:{mac:"⇥",default:"⭾"},label:"Tab"},capslock:{symbols:{default:"⇪"},label:"Caps Lock"},fn:{symbols:{default:"Fn"},label:"Fn"},cmd:{symbols:{mac:"⌘",windows:"⊞ Win",default:"Command"},label:"Command"},insert:{symbols:{default:"Ins"},label:"Insert"},delete:{symbols:{mac:"⌦",default:"Del"},label:"Delete"},home:{symbols:{mac:"↖",default:"Home"},label:"Home"},end:{symbols:{mac:"↘",default:"End"},label:"End"}};function fd(e){return e.charAt(0).toUpperCase()+e.slice(1)}const hd=N(!1),pd=()=>{const[e,t]=V(hd),[n,r]=o.useState(null),[i,s]=o.useState([]),[a,u]=ue(),l=Z(te);td("global.showHelp",(()=>t((e=>!e))));const d=async e=>{const t={...a};u(e),await me({config:e}).catch((e=>{throw u(t),e}))},f=async()=>{if(!n)return;const e={...a,keymap:{...a.keymap,overrides:{...a.keymap.overrides}}};delete e.keymap.overrides[n],r(null),s([]),await d(e)};if(!e)return null;const p=e=>{const t=l.getHotkey(e);if(n===e){const o=ve(e);return c.jsxs("div",{children:[c.jsx(ye,{defaultValue:i.join("+"),placeholder:t.name,onKeyDown:e=>{e.preventDefault();const t=[];if("Meta"===e.key||"Control"===e.key||"Alt"===e.key||"Shift"===e.key)return;if(e.metaKey&&t.push(ae()?"Cmd":"Meta"),e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),"-"===e.key)return;if("Escape"===e.key&&0===t.length)return r(null),void s([]);let i=e.key.toLowerCase();" "===e.key&&(i="Space"),t.push(i),(async e=>{if(!n)return;const t=e.join("-"),i={...a,keymap:{...a.keymap,overrides:{...a.keymap.overrides,[n]:t}}};r(null),s([]),await d(i)})(t)},autoFocus:!0,endAdornment:c.jsx(G,{variant:"text",size:"xs",className:"mb-0",onClick:()=>{r(null),s([])},children:c.jsx(h,{className:"w-4 h-4"})})}),c.jsxs("div",{className:"flex items-center justify-between w-full",children:[c.jsx("span",{className:"text-muted-foreground text-xs",children:"Press a key combination"}),o.key!==t.key&&c.jsxs("span",{className:"text-xs cursor-pointer text-primary",onClick:f,children:["Reset to default:"," ",c.jsx("span",{className:"font-mono",children:o.key})]})]})]},e)}return c.jsxs("div",{className:"grid grid-cols-[auto,2fr,3fr] gap-2 items-center",children:[c.jsx(be,{className:"cursor-pointer opacity-60 hover:opacity-100 text-muted-foreground w-3 h-3",onClick:()=>{s([]),r(e)}}),c.jsx(sd,{className:"justify-end",shortcut:t.key}),c.jsx("span",{children:t.name.toLowerCase()})]},e)},g=l.getHotkeyGroups(),m=e=>{const t=g[e];return c.jsxs("div",{className:"keyboard-shortcut-group gap-2 flex flex-col",children:[c.jsx("h3",{className:"text-lg font-medium",children:e}),t.map((e=>p(e)))]})};return c.jsx(le,{open:e,onOpenChange:e=>t(e),children:c.jsxs(de,{className:"sm:items-center sm:top-0",children:[c.jsx(fe,{}),c.jsxs(he,{usePortal:!1,className:"max-h-screen sm:max-h-[90vh] overflow-y-auto sm:max-w-[850px]",children:[c.jsx(pe,{children:c.jsx(ge,{children:"Shortcuts"})}),c.jsxs("div",{className:"flex flex-row gap-3",children:[c.jsxs("div",{className:"w-1/2",children:[m("Editing"),m("Markdown")]}),c.jsxs("div",{className:"w-1/2",children:[m("Navigation"),m("Running Cells"),m("Creation and Ordering"),m("Other"),c.jsx(G,{className:"mt-4 hover:bg-destructive/10 hover:border-destructive",variant:"outline",size:"xs",onClick:async()=>{if(!window.confirm("Are you sure you want to reset all shortcuts to their default values?"))return;const e={...a,keymap:{...a.keymap,overrides:{}}};r(null),s([]),await d(e)},tabIndex:-1,children:c.jsx("span",{className:"text-destructive",children:"Reset all to default"})})]})]})]})]})})},gd="flex flex-row items-center space-x-1 space-y-0",md=()=>{const[e,t]=ue(),n=o.useRef(null),r=ee(hd),{t:i,i18n:s}=lt(),a=we({resolver:xe(qe),defaultValues:e}),u=async e=>{await me({config:e}).then((()=>{t(e)}))},l=Te();return c.jsx(De,{...a,children:c.jsxs("form",{ref:n,onChange:a.handleSubmit(u),className:"flex flex-col gap-5",children:[c.jsxs("div",{children:[c.jsx(Jl,{children:i("userConfig")}),c.jsx(Yl,{children:i("settingsAppliedToAllMarimoNotebooks")})]}),c.jsxs(vd,{title:i("editor"),children:[c.jsx(Se,{control:a.control,name:"save.autosave",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("autosave")}),c.jsx(Ce,{children:c.jsx(je,{"data-testid":"autosave-checkbox",checked:"after_delay"===e.value,disabled:e.disabled,onCheckedChange:t=>{e.onChange(t?"after_delay":"off")}})})]})}),c.jsx(Se,{control:a.control,name:"save.autosave_delay",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("autosaveDelaySeconds")}),c.jsx(Ce,{children:c.jsx("span",{className:"inline-flex mr-2",children:c.jsx(Ee,{"data-testid":"autosave-delay-input",className:"m-0 w-24",isDisabled:"after_delay"!==a.getValues("save.autosave"),...e,value:e.value/1e3,minValue:1,onChange:t=>{e.onChange(1e3*t),u(a.getValues())}})})}),c.jsx(ke,{})]})}),c.jsx(Se,{control:a.control,name:"save.format_on_save",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("formatOnSave")}),c.jsx(Ce,{children:c.jsx(je,{"data-testid":"format-on-save-checkbox",checked:e.value,disabled:e.disabled,onCheckedChange:t=>{e.onChange(t)}})})]})}),c.jsx(Se,{control:a.control,name:"formatting.line_length",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("lineLength")}),c.jsx(Ce,{children:c.jsx("span",{className:"inline-flex mr-2",children:c.jsx(Ee,{"data-testid":"line-length-input",className:"m-0 w-24",...e,value:e.value,minValue:1,maxValue:1e3,onChange:t=>{e.onChange(t),u(a.getValues())}})})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:i("maximumLineLengthWhenFormattingCode")})]})}),c.jsx(Se,{control:a.control,name:"completion.activate_on_typing",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("autocomplete")}),c.jsx(Ce,{children:c.jsx(je,{"data-testid":"autocomplete-checkbox",checked:e.value,disabled:e.disabled,onCheckedChange:t=>{e.onChange(Boolean(t))}})})]}),c.jsx(Pe,{children:i("whenUncheckedCodeCompletionIsStillAvailableThroughAHotkey")})]})}),c.jsx(Se,{control:a.control,name:"keymap.preset",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("keymap")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"keymap-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:wt.map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]}),c.jsx("div",{children:c.jsx(G,{variant:"link",size:"xs",className:"mb-0 px-0",type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(!0)},children:i("editKeyboardShortcuts")})})]})})]}),c.jsxs(vd,{title:i("display"),children:[c.jsx(Se,{control:a.control,name:"display.default_width",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("defaultWidth")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"user-config-width-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:_e.map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:i("theDefaultAppWidthForNewNotebooks")})]})}),c.jsx(Se,{control:a.control,name:"display.theme",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("theme")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"theme-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:Ie.map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]})}),c.jsx(Se,{control:a.control,name:"display.cell_output",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("cellOutputArea")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"cell-output-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:["above","below"].map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:i("whereToDisplayCellsOutput")})]})}),c.jsx(Se,{control:a.control,name:"display.dataframes",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("dataframeViewer")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"display-dataframes-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:["rich","plain"].map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:i("whetherToUseMarimosRichDataframeViewer")})]})}),c.jsx(Se,{control:a.control,name:"display.code_editor_font_size",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("codeEditorFontSize")}),c.jsx(Ce,{children:c.jsx("span",{className:"inline-flex mr-2",children:c.jsx(Ee,{"data-testid":"code-editor-font-size-input",className:"m-0 w-24",...e,value:e.value,minValue:8,maxValue:32,onChange:t=>{e.onChange(t),u(a.getValues())}})})}),c.jsx(ke,{})]})})]}),c.jsx(vd,{title:i("packageManagement"),children:c.jsx(Se,{control:a.control,disabled:l,name:"package_management.manager",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("manager")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"package-manager-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:Me.map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]})})}),c.jsxs(vd,{title:i("runtime"),children:[c.jsx(Se,{control:a.control,name:"runtime.auto_instantiate",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("autorunOnStartup")}),c.jsx(Ce,{children:c.jsx(je,{"data-testid":"auto-instantiate-checkbox",disabled:e.disabled,checked:e.value,onCheckedChange:e.onChange})})]})}),c.jsx(Se,{control:a.control,name:"runtime.on_cell_change",render:({field:e})=>c.jsxs("div",{className:"flex flex-col gap-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("onCellChange")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"on-cell-change-select",onChange:t=>e.onChange(t.target.value),value:e.value,className:"inline-flex mr-2",children:["lazy","autorun"].map((e=>c.jsx("option",{value:e,children:e},e)))})})]}),c.jsx(Pe,{children:i("onCellChangeDescription")})]})}),c.jsx(Se,{control:a.control,name:"runtime.auto_reload",render:({field:e})=>c.jsxs("div",{className:"flex flex-col gap-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{className:"font-normal",children:i("onModuleChange")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"auto-reload-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:l,className:"inline-flex mr-2",children:["off","lazy","autorun"].map((e=>c.jsx("option",{value:e,children:e},e)))})})]}),c.jsx(Pe,{children:i("onModuleChangeDescription")})]})})]}),c.jsxs(vd,{title:i("aiAssist"),children:[c.jsxs("p",{className:"text-sm text-muted-secondary",children:[i("addApiKey")," ",c.jsx(Ql,{className:"inline",children:"~/.marimo.toml"})," ",i("toActivate"),c.jsx("a",{className:"text-link hover:underline",href:"https://docs.marimo.io/guides/editor_features/ai_completion.html",target:"_blank",rel:"noreferrer",children:i("docs")})," ",i("forMoreInfo")]}),c.jsx(Se,{control:a.control,disabled:l,name:"ai.open_ai.base_url",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("baseUrl")}),c.jsx(Ce,{children:c.jsx(ye,{"data-testid":"ai-base-url-input",className:"m-0 inline-flex",placeholder:"https://api.openai.com/v1",...e})}),c.jsx(ke,{})]})}),c.jsx(Se,{control:a.control,disabled:l,name:"ai.open_ai.model",render:({field:e})=>c.jsxs("div",{className:"flex flex-col space-y-1",children:[c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("model")}),c.jsx(Ce,{children:c.jsx(ye,{"data-testid":"ai-model-input",className:"m-0 inline-flex",placeholder:"gpt-4-turbo",...e})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:i("modelDescription")})]})})]}),c.jsxs(vd,{title:i("aiCodeCompletion"),children:[c.jsx("p",{className:"text-sm text-muted-secondary",children:i("aiCodeCompletionDescription")}),c.jsx(Se,{control:a.control,name:"completion.copilot",render:({field:e})=>c.jsx("div",{className:"flex flex-col space-y-1",children:c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("provider")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"copilot-select",onChange:t=>{"none"===t.target.value?e.onChange(!1):e.onChange(t.target.value)},value:!0===e.value?"github":!1===e.value?"none":e.value,disabled:e.disabled,className:"inline-flex mr-2",children:["none","github","codeium"].map((e=>c.jsx("option",{value:e,children:i(e)},e)))})}),c.jsx(ke,{})]})})}),(()=>{const e=a.getValues("completion.copilot");return!1===e?null:"codeium"===e?c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-sm text-muted-secondary",children:[i("aiAssist")," ",c.jsx("a",{className:"text-link hover:underline",href:"https://docs.marimo.io/guides/editor_features/ai_completion.html#codeium-copilot",target:"_blank",rel:"noreferrer",children:i("aiCodeCompletion")}),"."]}),c.jsx(Se,{control:a.control,name:"completion.codeium_api_key",render:({field:e})=>c.jsxs(Re,{className:gd,children:[c.jsx(Oe,{children:i("apiKey")}),c.jsx(Ce,{children:c.jsx(ye,{"data-testid":"codeium-api-key-input",className:"m-0 inline-flex",placeholder:i("apiKey"),...e,value:e.value||""})}),c.jsx(ke,{})]})})]}):"github"===e?c.jsx(Gl,{}):void 0})()]}),c.jsxs(vd,{title:i("languageSettings"),children:[c.jsx(Oe,{children:i("selectLanguage")}),c.jsxs(Ne,{onChange:e=>{s.changeLanguage(e.target.value)},defaultValue:s.language,children:[c.jsx("option",{value:"en",children:"English"}),c.jsx("option",{value:"zh",children:"中文"})]})]})]})})},vd=({title:e,children:t})=>c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx(Xl,{children:e}),t]}),yd=()=>{const{t:e}=lt(),[t,n]=Ae(),r=we({resolver:xe(He),defaultValues:t});return o.useEffect((()=>{window.dispatchEvent(new Event("resize"))}),[t.width]),c.jsx(De,{...r,children:c.jsxs("form",{onChange:r.handleSubmit((async e=>{await Ue({config:e}).then((()=>{n(e)})).catch((()=>{n(e)}))})),className:"flex flex-col gap-4",children:[c.jsxs("div",{children:[c.jsx(Jl,{children:e("appConfig")}),c.jsx(Yl,{children:e("settingsApplied")})]}),c.jsx(Se,{control:r.control,name:"width",render:({field:t})=>c.jsxs(Re,{className:"flex flex-row items-center space-x-1 space-y-0",children:[c.jsx(Oe,{children:e("width")}),c.jsx(Ce,{children:c.jsx(Ne,{"data-testid":"app-width-select",onChange:e=>t.onChange(e.target.value),value:t.value,disabled:t.disabled,className:"inline-flex mr-2",children:_e.map((e=>c.jsx("option",{value:e,children:e},e)))})}),c.jsx(ke,{})]})}),c.jsx(Se,{control:r.control,name:"app_title",render:({field:t})=>c.jsxs("div",{className:"flex flex-col gap-y-1",children:[c.jsxs(Re,{className:"flex flex-row items-center space-x-1 space-y-0",children:[c.jsx(Oe,{children:e("appTitle")}),c.jsx(Ce,{children:c.jsx(ye,{...t,value:t.value??"",onChange:e=>{t.onChange(e.target.value),Le.safeParse(e.target.value).success&&(document.title=e.target.value)}})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:e("appTitleDescription")})]})}),c.jsx(Se,{control:r.control,name:"css_file",render:({field:t})=>c.jsxs("div",{className:"flex flex-col gap-y-1",children:[c.jsxs(Re,{className:"flex flex-row items-center space-x-1 space-y-0",children:[c.jsx(Oe,{className:"flex-shrink-0",children:e("customCSS")}),c.jsx(Ce,{children:c.jsx(ye,{...t,value:t.value??"",placeholder:"custom.css",onChange:e=>{t.onChange(e.target.value),Le.safeParse(e.target.value).success&&(document.title=e.target.value)}})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:e("customCSSDescription")})]})}),c.jsx(Se,{control:r.control,name:"auto_download",render:({field:t})=>c.jsxs("div",{className:"flex flex-col gap-y-1",children:[c.jsxs(Re,{className:"flex flex-col gap-2",children:[c.jsx(Ce,{children:c.jsx("div",{className:"flex gap-2",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(je,{id:"html-checkbox",checked:t.value.includes("html"),onCheckedChange:()=>{t.onChange(Fe(t.value,"html"))}}),c.jsx(Oe,{htmlFor:"html-checkbox",children:e("autoDownloadHTML")})]})})}),c.jsx(ke,{})]}),c.jsx(Pe,{children:e("autoDownloadHTMLDescription")})]})})]})})},bd=({showAppConfig:e=!0})=>c.jsxs(We,{children:[c.jsx(Be,{asChild:!0,children:c.jsx(ht,{"aria-label":"Config","data-testid":"app-config-button",shape:"circle",size:"small",className:"h-[27px] w-[27px]",color:"hint-green",children:c.jsx(d,{content:"Settings",children:c.jsx(Xe,{strokeWidth:1.8})})})}),c.jsxs(ze,{className:"w-80 h-[90vh] overflow-auto",align:"end",side:"bottom",onFocusOutside:e=>e.preventDefault(),children:[e&&c.jsxs(c.Fragment,{children:[c.jsx(yd,{}),c.jsx("div",{className:"h-px bg-border my-4"})]}),c.jsx(md,{})]})]}),wd=e=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 448 512",...e,children:c.jsx("path",{d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"})}),xd=e=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 640 512",fill:"currentColor",...e,children:c.jsx("path",{d:"M593.8 59.1H46.2C20.7 59.1 0 79.8 0 105.2v301.5c0 25.5 20.7 46.2 46.2 46.2h547.7c25.5 0 46.2-20.7 46.1-46.1V105.2c0-25.4-20.7-46.1-46.2-46.1zM338.5 360.6H277v-120l-61.5 76.9-61.5-76.9v120H92.3V151.4h61.5l61.5 76.9 61.5-76.9h61.5v209.2zm135.3 3.1L381.5 256H443V151.4h61.5V256H566z"})}),Td=o.createContext(null);function Dd(){const e=o.useContext(Td);if(null===e)throw new Error("No Tree Api Provided");return e}const Sd=o.createContext(null);const Rd=o.createContext(null);const Od=o.createContext(0);function Cd(){o.useContext(Od)}function jd(e,t,n){return Math.max(Math.min(e,n),t)}function Ed(e){return e&&e.isLeaf}function kd(e){return e&&e.isInternal&&!e.isOpen}function Pd(e){var t;return e&&e.isOpen&&!(null===(t=e.children)||void 0===t?void 0:t.length)}const Nd=(e,t)=>{let n=e;for(;n;){if(n.id===t.id)return!0;n=n.parent}return!1},_d=e=>{if(!e.parent)throw Error("Node does not have a parent");return e.parent.children.findIndex((t=>t.id===e.id))};function Id(e,t){if(!e)return null;if(e.id===t)return e;if(e.children)for(let n of e.children){const e=Id(n,t);if(e)return e}return null}function Md(e,t){if(t(e),e.children)for(let n of e.children)Md(n,t)}function qd(e){const t=Hd(e);let n;for(let r=0;r<t.length;++r){if(t[r]===e){n=Ld(t,r);break}}null==n||n.focus()}function Ad(e){const t=Hd(e);let n;for(let r=0;r<t.length;++r){if(t[r]===e){n=Fd(t,r);break}}null==n||n.focus()}function Ld(e,t){return t+1<e.length?e[t+1]:e[0]}function Fd(e,t){return t-1>=0?e[t-1]:e[e.length-1]}function Hd(e){return Array.from(document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled]), summary:not(:disabled)')).filter((t=>t===e||!e.contains(t)))}function Ud(e,t){return"boolean"==typeof t?t:"string"==typeof t?e[t]:t(e)}function Wd(e){return null===e?null:Bd(e)}function Bd(e){return"string"==typeof e?e:e.id}function zd(e,...t){if(e)return e(...t)}function Vd(e){return new Promise(((t,n)=>{let r=0;!function i(){r+=1,100===r&&n(),e()?t():setTimeout(i,10)}()}))}function $d(e){var t,n;const r=e.focusedNode;return r?r.isOpen?0:r.parent?r.childIndex+1:0:null!==(n=null===(t=e.root.children)||void 0===t?void 0:t.length)&&void 0!==n?n:0}function Kd(e){const t=e.focusedNode;return t?t.isOpen?t.id:t.parent&&!t.parent.isRoot?t.parent.id:null:null}const Gd=Object.freeze(Object.defineProperty({__proto__:null,access:Ud,bound:jd,dfs:Id,focusNextElement:qd,focusPrevElement:Ad,getInsertIndex:$d,getInsertParentId:Kd,identify:Bd,identifyNull:Wd,indexOf:_d,isClosed:kd,isDescendant:Nd,isItem:Ed,isOpenWithEmptyChildren:Pd,mergeRefs:function(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}},noop:function(){},safeRun:zd,waitFor:Vd,walk:Md},Symbol.toStringTag,{value:"Module"})),Jd={display:"flex",alignItems:"center",zIndex:1},Xd={flex:1,height:"2px",background:"#4B91E2",borderRadius:"1px"},Yd={width:"4px",height:"4px",boxShadow:"0 0 0 3px #4B91E2",borderRadius:"50%"},Qd=a.memo((function({top:e,left:t,indent:n}){const r={position:"absolute",pointerEvents:"none",top:e-2+"px",left:t+"px",right:n+"px"};return c.jsxs("div",{style:Object.assign(Object.assign({},Jd),r),children:[c.jsx("div",{style:Object.assign({},Yd)}),c.jsx("div",{style:Object.assign({},Xd)})]})}));function Zd({node:e,attrs:t,innerRef:n,children:r}){return c.jsx("div",Object.assign({},t,{ref:n,onFocus:e=>e.stopPropagation(),onClick:e.handleClick,children:r}))}function ef(e){return c.jsxs("div",{ref:e.dragHandle,style:e.style,children:[c.jsx("span",{onClick:t=>{t.stopPropagation(),e.node.toggle()},children:e.node.isLeaf?"🌳":e.node.isOpen?"🗁":"🗀"})," ",e.node.isEditing?c.jsx(nf,Object.assign({},e)):c.jsx(tf,Object.assign({},e))]})}function tf(e){return c.jsx(c.Fragment,{children:c.jsx("span",{children:e.node.data.name})})}function nf({node:e}){const t=o.useRef();return o.useEffect((()=>{var e,n;null===(e=t.current)||void 0===e||e.focus(),null===(n=t.current)||void 0===n||n.select()}),[]),c.jsx("input",{ref:t,defaultValue:e.data.name,onBlur:()=>e.reset(),onKeyDown:n=>{var r;"Escape"===n.key&&e.reset(),"Enter"===n.key&&e.submit((null===(r=t.current)||void 0===r?void 0:r.value)||"")}})}function rf(e){return{type:"EDIT",id:e}}function of(e){return{type:"FOCUS",id:e}}class sf{constructor(e){this.handleClick=e=>{e.metaKey&&!this.tree.props.disableMultiSelection?this.isSelected?this.deselect():this.selectMulti():e.shiftKey&&!this.tree.props.disableMultiSelection?this.selectContiguous():(this.select(),this.activate())},this.tree=e.tree,this.id=e.id,this.data=e.data,this.level=e.level,this.children=e.children,this.parent=e.parent,this.isDraggable=e.isDraggable,this.rowIndex=e.rowIndex}get isRoot(){return this.id===af}get isLeaf(){return!Array.isArray(this.children)}get isInternal(){return!this.isLeaf}get isOpen(){return!this.isLeaf&&this.tree.isOpen(this.id)}get isClosed(){return!this.isLeaf&&!this.tree.isOpen(this.id)}get isEditable(){return this.tree.isEditable(this.data)}get isEditing(){return this.tree.editingId===this.id}get isSelected(){return this.tree.isSelected(this.id)}get isOnlySelection(){return this.isSelected&&this.tree.hasOneSelection}get isSelectedStart(){var e;return this.isSelected&&!(null===(e=this.prev)||void 0===e?void 0:e.isSelected)}get isSelectedEnd(){var e;return this.isSelected&&!(null===(e=this.next)||void 0===e?void 0:e.isSelected)}get isFocused(){return this.tree.isFocused(this.id)}get isDragging(){return this.tree.isDragging(this.id)}get willReceiveDrop(){return this.tree.willReceiveDrop(this.id)}get state(){return{isClosed:this.isClosed,isDragging:this.isDragging,isEditing:this.isEditing,isFocused:this.isFocused,isInternal:this.isInternal,isLeaf:this.isLeaf,isOpen:this.isOpen,isSelected:this.isSelected,isSelectedEnd:this.isSelectedEnd,isSelectedStart:this.isSelectedStart,willReceiveDrop:this.willReceiveDrop}}get childIndex(){return this.parent&&this.parent.children?this.parent.children.findIndex((e=>e.id===this.id)):-1}get next(){return null===this.rowIndex?null:this.tree.at(this.rowIndex+1)}get prev(){return null===this.rowIndex?null:this.tree.at(this.rowIndex-1)}get nextSibling(){var e,t;const n=this.childIndex;return null!==(t=null===(e=this.parent)||void 0===e?void 0:e.children[n+1])&&void 0!==t?t:null}isAncestorOf(e){if(!e)return!1;let t=e;for(;t;){if(t.id===this.id)return!0;t=t.parent}return!1}select(){this.tree.select(this)}deselect(){this.tree.deselect(this)}selectMulti(){this.tree.selectMulti(this)}selectContiguous(){this.tree.selectContiguous(this)}activate(){this.tree.activate(this)}focus(){this.tree.focus(this)}toggle(){this.tree.toggle(this)}open(){this.tree.open(this)}openParents(){this.tree.openParents(this)}close(){this.tree.close(this)}submit(e){this.tree.submit(this,e)}reset(){this.tree.reset()}clone(){return new sf(Object.assign({},this))}edit(){return this.tree.edit(this)}}const af="__REACT_ARBORIST_INTERNAL_ROOT__";function cf(e){var t;function n(t,r,i){const o=e.accessId(t),s=new sf({tree:e,data:t,level:r,parent:i,id:o,children:null,isDraggable:e.isDraggable(t),rowIndex:null}),a=e.accessChildren(t);return a&&(s.children=a.map((e=>n(e,r+1,s)))),s}const r=new sf({tree:e,id:af,data:{id:af},level:-1,parent:null,children:null,isDraggable:!0,rowIndex:null}),i=null!==(t=e.props.data)&&void 0!==t?t:[];return r.children=i.map((e=>n(e,0,r))),r}const uf={open:(e,t)=>({type:"VISIBILITY_OPEN",id:e,filtered:t}),close:(e,t)=>({type:"VISIBILITY_CLOSE",id:e,filtered:t}),toggle:(e,t)=>({type:"VISIBILITY_TOGGLE",id:e,filtered:t}),clear:e=>({type:"VISIBILITY_CLEAR",filtered:e})};function lf(e={},t){if("VISIBILITY_OPEN"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!0});if("VISIBILITY_CLOSE"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!1});if("VISIBILITY_TOGGLE"===t.type){const n=e[t.id];return Object.assign(Object.assign({},e),{[t.id]:!n})}return"VISIBILITY_CLEAR"===t.type?{}:e}const df=e=>{var t;return{nodes:{open:{filtered:{},unfiltered:null!==(t=null==e?void 0:e.initialOpenState)&&void 0!==t?t:{}},focus:{id:null,treeFocused:!1},edit:{id:null},drag:{id:null,selectedIds:[],destinationParentId:null,destinationIndex:null},selection:{ids:new Set,anchor:null,mostRecent:null}},dnd:{cursor:{type:"none"},dragId:null,dragIds:[],parentId:null,index:-1}}},ff=e=>({type:"SELECTION_ONLY",id:Bd(e)}),hf=e=>({type:"SELECTION_ADD",ids:(Array.isArray(e)?e:[e]).map(Bd)}),pf=e=>({type:"SELECTION_REMOVE",ids:(Array.isArray(e)?e:[e]).map(Bd)}),gf=e=>Object.assign({type:"SELECTION_SET"},e),mf=e=>({type:"SELECTION_MOST_RECENT",id:null===e?null:Bd(e)}),vf=e=>({type:"SELECTION_ANCHOR",id:null===e?null:Bd(e)});const yf={cursor:e=>({type:"DND_CURSOR",cursor:e}),dragStart:(e,t)=>({type:"DND_DRAG_START",id:e,dragIds:t}),dragEnd:()=>({type:"DND_DRAG_END"}),hovering:(e,t)=>({type:"DND_HOVERING",parentId:e,index:t})};const bf={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},wf=e=>{if(!e)return{display:"none"};const{x:t,y:n}=e;return{transform:`translate(${t}px, ${n}px)`}},xf=e=>{if(!e)return{display:"none"};const{x:t,y:n}=e;return{transform:`translate(${t+10}px, ${n+10}px)`}};function Tf({offset:e,mouse:t,id:n,dragIds:r,isDragging:i}){return c.jsxs(Df,{isDragging:i,children:[c.jsx(Sf,{offset:e,children:c.jsx(Of,{id:n,dragIds:r})}),c.jsx(Rf,{mouse:t,count:r.length})]})}const Df=o.memo((function(e){return e.isDragging?c.jsx("div",{style:bf,children:e.children}):null}));function Sf(e){return c.jsx("div",{className:"row preview",style:wf(e.offset),children:e.children})}function Rf(e){const{count:t,mouse:n}=e;return t>1?c.jsx("div",{className:"selected-count",style:xf(n),children:t}):null}const Of=o.memo((function(e){const t=Dd(),n=t.get(e.id);return n?c.jsx(t.renderNode,{preview:!0,node:n,style:{paddingLeft:n.level*t.indent,opacity:.2,background:"transparent"},tree:t}):null}));function Cf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jf(e,t){return(jf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Ef=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function kf(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||Ef(r)&&Ef(i)))return!1;var r,i;return!0}function Pf(e,t){var n;void 0===t&&(t=kf);var r,i=[],o=!1;return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return o&&n===this&&t(s,i)||(r=e.apply(this,s),o=!0,n=this,i=s),r}}var Nf="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function _f(e){cancelAnimationFrame(e.id)}var If=-1;function Mf(e){if(void 0===e&&(e=!1),-1===If||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),If=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return If}var qf=null;function Af(e){if(void 0===e&&(e=!1),null===qf||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",t.appendChild(r),document.body.appendChild(t),t.scrollLeft>0?qf="positive-descending":(t.scrollLeft=1,qf=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),qf}return qf}var Lf=function(e,t){return e};function Ff(e){var t,n=e.getItemOffset,r=e.getEstimatedTotalSize,i=e.getItemSize,s=e.getOffsetForIndexAndAlignment,a=e.getStartIndexForOffset,c=e.getStopIndexForStartIndex,u=e.initInstanceProps,l=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return(t=function(e){var t,f;function h(t){var r;return(r=e.call(this,t)||this)._instanceProps=u(r.props,Cf(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:Cf(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Pf((function(e,t,n,i){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:i})})),r._callOnScroll=void 0,r._callOnScroll=Pf((function(e,t,n){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n})})),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,o=r.props,s=o.direction,a=o.itemSize,c=o.layout,u=r._getItemStyleCache(l&&a,l&&c,l&&s);if(u.hasOwnProperty(e))t=u[e];else{var d=n(r.props,e,r._instanceProps),f=i(r.props,e,r._instanceProps),h="horizontal"===s||"horizontal"===c,p="rtl"===s,g=h?d:0;u[e]=t={position:"absolute",left:p?void 0:g,right:p?g:void 0,top:h?0:d,height:h?"100%":f,width:h?f:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=Pf((function(e,t,n){return{}})),r._onScrollHorizontal=function(e){var t=e.currentTarget,n=t.clientWidth,i=t.scrollLeft,o=t.scrollWidth;r.setState((function(e){if(e.scrollOffset===i)return null;var t=r.props.direction,s=i;if("rtl"===t)switch(Af()){case"negative":s=-i;break;case"positive-descending":s=o-n-i}return s=Math.max(0,Math.min(s,o-n)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:s,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,n=t.clientHeight,i=t.scrollHeight,o=t.scrollTop;r.setState((function(e){if(e.scrollOffset===o)return null;var t=Math.max(0,Math.min(o,i-n));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){var e,t,n,i;null!==r._resetIsScrollingTimeoutId&&_f(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=(e=r._resetIsScrolling,t=150,n=Nf(),i={id:requestAnimationFrame((function r(){Nf()-n>=t?e.call(null):i.id=requestAnimationFrame(r)}))})},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1,null)}))},r}f=e,(t=h).prototype=Object.create(f.prototype),t.prototype.constructor=t,jf(t,f),h.getDerivedStateFromProps=function(e,t){return Hf(e,t),d(e),null};var p=h.prototype;return p.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},p.scrollToItem=function(e,t){void 0===t&&(t="auto");var n=this.props,r=n.itemCount,i=n.layout,o=this.state.scrollOffset;e=Math.max(0,Math.min(e,r-1));var a=0;if(this._outerRef){var c=this._outerRef;a="vertical"===i?c.scrollWidth>c.clientWidth?Mf():0:c.scrollHeight>c.clientHeight?Mf():0}this.scrollTo(s(this.props,e,t,o,this._instanceProps,a))},p.componentDidMount=function(){var e=this.props,t=e.direction,n=e.initialScrollOffset,r=e.layout;if("number"==typeof n&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===r?i.scrollLeft=n:i.scrollTop=n}this._callPropsCallbacks()},p.componentDidUpdate=function(){var e=this.props,t=e.direction,n=e.layout,r=this.state,i=r.scrollOffset;if(r.scrollUpdateWasRequested&&null!=this._outerRef){var o=this._outerRef;if("horizontal"===t||"horizontal"===n)if("rtl"===t)switch(Af()){case"negative":o.scrollLeft=-i;break;case"positive-ascending":o.scrollLeft=i;break;default:var s=o.clientWidth,a=o.scrollWidth;o.scrollLeft=a-s-i}else o.scrollLeft=i;else o.scrollTop=i}this._callPropsCallbacks()},p.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&_f(this._resetIsScrollingTimeoutId)},p.render=function(){var e=this.props,t=e.children,n=e.className,i=e.direction,s=e.height,a=e.innerRef,c=e.innerElementType,u=e.innerTagName,l=e.itemCount,d=e.itemData,f=e.itemKey,h=void 0===f?Lf:f,p=e.layout,g=e.outerElementType,m=e.outerTagName,v=e.style,y=e.useIsScrolling,b=e.width,w=this.state.isScrolling,x="horizontal"===i||"horizontal"===p,T=x?this._onScrollHorizontal:this._onScrollVertical,D=this._getRangeToRender(),S=D[0],R=D[1],O=[];if(l>0)for(var C=S;C<=R;C++)O.push(o.createElement(t,{data:d,key:h(C,d),index:C,isScrolling:y?w:void 0,style:this._getItemStyle(C)}));var j=r(this.props,this._instanceProps);return o.createElement(g||m||"div",{className:n,onScroll:T,ref:this._outerRefSetter,style:Ve({position:"relative",height:s,width:b,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:i},v)},o.createElement(c||u||"div",{children:O,ref:a,style:{height:x?"100%":j,pointerEvents:w?"none":void 0,width:x?j:"100%"}}))},p._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],n=e[1],r=e[2],i=e[3];this._callOnItemsRendered(t,n,r,i)}if("function"==typeof this.props.onScroll){var o=this.state,s=o.scrollDirection,a=o.scrollOffset,c=o.scrollUpdateWasRequested;this._callOnScroll(s,a,c)}},p._getRangeToRender=function(){var e=this.props,t=e.itemCount,n=e.overscanCount,r=this.state,i=r.isScrolling,o=r.scrollDirection,s=r.scrollOffset;if(0===t)return[0,0,0,0];var u=a(this.props,s,this._instanceProps),l=c(this.props,u,s,this._instanceProps),d=i&&"backward"!==o?1:Math.max(1,n),f=i&&"forward"!==o?1:Math.max(1,n);return[Math.max(0,u-d),Math.max(0,Math.min(t-1,l+f)),u,l]},h}(o.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var Hf=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Uf=Ff({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,n,r,i,o){var s=e.direction,a=e.height,c=e.itemCount,u=e.itemSize,l=e.layout,d=e.width,f="horizontal"===s||"horizontal"===l?d:a,h=Math.max(0,c*u-f),p=Math.min(h,t*u),g=Math.max(0,t*u-f+u+o);switch("smart"===n&&(n=r>=g-f&&r<=p+f?"auto":"center"),n){case"start":return p;case"end":return g;case"center":var m=Math.round(g+(p-g)/2);return m<Math.ceil(f/2)?0:m>h+Math.floor(f/2)?h:m;default:return r>=g&&r<=p?r:r<g?g:p}},getStartIndexForOffset:function(e,t){var n=e.itemCount,r=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/r)))},getStopIndexForStartIndex:function(e,t,n){var r=e.direction,i=e.height,o=e.itemCount,s=e.itemSize,a=e.layout,c=e.width,u=t*s,l="horizontal"===r||"horizontal"===a?c:i,d=Math.ceil((l+n-u)/s);return Math.max(0,Math.min(o-1,t+d-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function Wf(){var e,t;const n=Dd(),r=function(){const e=o.useContext(Rd);if(null===e)throw new Error("Provide a DnDContext");return e}().cursor;if(!r||"line"!==r.type)return null;const i=n.indent,s=n.rowHeight*r.index+(null!==(t=null!==(e=n.props.padding)&&void 0!==e?e:n.props.paddingTop)&&void 0!==t?t:0),a=i*r.level,u=n.renderCursor;return c.jsx(u,{top:s,left:a,indent:i})}const Bf=o.forwardRef((function(e,t){const{children:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["children"]),i=Dd();return c.jsxs("div",Object.assign({ref:t},r,{onClick:e=>{e.currentTarget===e.target&&i.deselectAll()},children:[c.jsx(zf,{}),n]}))})),zf=()=>{const e=Dd();return c.jsx("div",{style:{height:e.visibleNodes.length*e.rowHeight,width:"100%",position:"absolute",left:"0",right:"0"},children:c.jsx(Wf,{})})};const Vf=o.forwardRef((function(e,t){var n,r,i,o,{style:s}=e,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["style"]);const u=Dd(),l=null!==(r=null!==(n=u.props.padding)&&void 0!==n?n:u.props.paddingTop)&&void 0!==r?r:0,d=null!==(o=null!==(i=u.props.padding)&&void 0!==i?i:u.props.paddingBottom)&&void 0!==o?o:0;return c.jsx("div",Object.assign({ref:t,style:Object.assign(Object.assign({},s),{height:`${parseFloat(s.height)+l+d}px`})},a))}));var $f,Kf,Gf=o.createContext({dragDropManager:void 0});function Jf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e){var o;if(void 0===t)o=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;(o=new Error(t.replace(/%s/g,(function(){return r[s++]})))).name="Invariant Violation"}throw o.framesToPop=1,o}}(Kf=$f||($f={})).SOURCE="SOURCE",Kf.TARGET="TARGET";var Xf="dnd-core/INIT_COORDS",Yf="dnd-core/BEGIN_DRAG",Qf="dnd-core/PUBLISH_DRAG_SOURCE",Zf="dnd-core/HOVER",eh="dnd-core/DROP",th="dnd-core/END_DRAG";function nh(e,t){return{type:Xf,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function rh(e){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ih(e){return"object"===rh(e)}var oh={type:Xf,payload:{clientOffset:null,sourceClientOffset:null}};function sh(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,i=void 0===r||r,o=n.clientOffset,s=n.getSourceClientOffset,a=e.getMonitor(),c=e.getRegistry();e.dispatch(nh(o)),function(e,t,n){Jf(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){Jf(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,a,c);var u=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,a);if(null!==u){var l=null;if(o){if(!s)throw new Error("getSourceClientOffset must be defined");!function(e){Jf("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(s),l=s(u)}e.dispatch(nh(o,l));var d=c.getSource(u).beginDrag(a,u);if(null!=d){!function(e){Jf(ih(e),"Item must be an object.")}(d),c.pinSource(u);var f=c.getSourceType(u);return{type:Yf,payload:{itemType:f,item:d,sourceId:u,clientOffset:o||null,sourceClientOffset:l||null,isSourcePublic:!!i}}}}else e.dispatch(oh)}}function ah(e){return function(){if(e.getMonitor().isDragging())return{type:Qf}}}function ch(e,t){return null===t?null===e:Array.isArray(e)?e.some((function(e){return e===t})):e===t}function uh(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){Jf(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),i=e.getMonitor(),o=e.getRegistry();return function(e,t,n){Jf(t.isDragging(),"Cannot call hover while not dragging."),Jf(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var i=e[r];Jf(e.lastIndexOf(i)===r,"Expected targetIds to be unique in the passed array."),Jf(n.getTarget(i),"Expected targetIds to be registered.")}}(r,i,o),function(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r];ch(t.getTargetType(i),n)||e.splice(r,1)}}(r,o,i.getItemType()),function(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,i,o),{type:Zf,payload:{targetIds:r,clientOffset:n||null}}}}function lh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lh(Object(n),!0).forEach((function(t){fh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hh(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){Jf(e.isDragging(),"Cannot call drop while not dragging."),Jf(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var i=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);i.forEach((function(i,o){var s=function(e,t,n,r){var i=n.getTarget(e),o=i?i.drop(r,e):void 0;(function(e){Jf(void 0===e||ih(e),"Drop result must either be an object or undefined.")})(o),void 0===o&&(o=0===t?{}:r.getDropResult());return o}(i,o,r,n),a={type:eh,payload:{dropResult:dh(dh({},t),s)}};e.dispatch(a)}))}}function ph(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){Jf(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:th}}}function gh(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vh=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),mh(this,"store",void 0),mh(this,"monitor",void 0),mh(this,"backend",void 0),mh(this,"isSetUp",!1),mh(this,"handleRefCountChange",(function(){var e=r.store.getState().refCount>0;r.backend&&(e&&!r.isSetUp?(r.backend.setup(),r.isSetUp=!0):!e&&r.isSetUp&&(r.backend.teardown(),r.isSetUp=!1))})),this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}return gh(e,[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch;var n=function(e){return{beginDrag:sh(e),publishDragSource:ah(e),hover:uh(e),drop:hh(e),endDrag:ph(e)}}(this);return Object.keys(n).reduce((function(r,i){var o,s=n[i];return r[i]=(o=s,function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=o.apply(e,r);void 0!==s&&t(s)}),r}),{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}]),e}();function yh(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var bh="function"==typeof Symbol&&Symbol.observable||"@@observable",wh=function(){return Math.random().toString(36).substring(7).split("").join(".")},xh={INIT:"@@redux/INIT"+wh(),REPLACE:"@@redux/REPLACE"+wh(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+wh()}};function Th(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(yh(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(yh(1));return n(Th)(e,t)}if("function"!=typeof e)throw new Error(yh(2));var i=e,o=t,s=[],a=s,c=!1;function u(){a===s&&(a=s.slice())}function l(){if(c)throw new Error(yh(3));return o}function d(e){if("function"!=typeof e)throw new Error(yh(4));if(c)throw new Error(yh(5));var t=!0;return u(),a.push(e),function(){if(t){if(c)throw new Error(yh(6));t=!1,u();var n=a.indexOf(e);a.splice(n,1),s=null}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(yh(7));if(void 0===e.type)throw new Error(yh(8));if(c)throw new Error(yh(9));try{c=!0,o=i(o,e)}finally{c=!1}for(var t=s=a,n=0;n<t.length;n++){(0,t[n])()}return e}return f({type:xh.INIT}),(r={dispatch:f,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error(yh(10));i=e,f({type:xh.REPLACE})}})[bh]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(yh(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[bh]=function(){return this},e},r}var Dh=function(e,t){return e===t};function Sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sh(Object(n),!0).forEach((function(t){Oh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ch={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function jh(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ch,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case Xf:case Yf:return{initialSourceClientOffset:i.sourceClientOffset,initialClientOffset:i.clientOffset,clientOffset:i.clientOffset};case Zf:return e=n.clientOffset,t=i.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:Rh(Rh({},n),{},{clientOffset:i.clientOffset});case th:case eh:return Ch;default:return n}}var Eh="dnd-core/ADD_SOURCE",kh="dnd-core/ADD_TARGET",Ph="dnd-core/REMOVE_SOURCE",Nh="dnd-core/REMOVE_TARGET";function _h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ih(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_h(Object(n),!0).forEach((function(t){Mh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qh={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Ah(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qh,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case Yf:return Ih(Ih({},n),{},{itemType:i.itemType,item:i.item,sourceId:i.sourceId,isSourcePublic:i.isSourcePublic,dropResult:null,didDrop:!1});case Qf:return Ih(Ih({},n),{},{isSourcePublic:!0});case Zf:return Ih(Ih({},n),{},{targetIds:i.targetIds});case Nh:return-1===n.targetIds.indexOf(i.targetId)?n:Ih(Ih({},n),{},{targetIds:(e=n.targetIds,t=i.targetId,e.filter((function(e){return e!==t})))});case eh:return Ih(Ih({},n),{},{dropResult:i.dropResult,didDrop:!0,targetIds:[]});case th:return Ih(Ih({},n),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function Lh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case Eh:case kh:return e+1;case Ph:case Nh:return e-1;default:return e}}var Fh=[],Hh=[];function Uh(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case Zf:break;case Eh:case kh:case Nh:case Ph:return Fh;default:return Hh}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,i=t.prevTargetIds,o=void 0===i?[]:i,s=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var i=[];return n.forEach((function(e,t){1===e&&i.push(t)})),i}(r,o),a=s.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dh;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,o);if(!a)return Fh;var c=o[o.length-1],u=r[r.length-1];return c!==u&&(c&&s.push(c),u&&s.push(u)),s}function Wh(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function Bh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bh(Object(n),!0).forEach((function(t){Vh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $h(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:Uh(r.dirtyHandlerIds,{type:i.type,payload:zh(zh({},i.payload),{},{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:n||null}),e))})}),dragOffset:jh(r.dragOffset,i),refCount:Lh(r.refCount,i),dragOperation:Ah(r.dragOperation,i),stateId:Wh(r.stateId)}}function Kh(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Gh(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Jh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Fh.__IS_NONE__=!0,Hh.__IS_ALL__=!0;var Xh=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Jh(this,"store",void 0),Jh(this,"registry",void 0),this.store=t,this.registry=n}return Gh(e,[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0}).handlerIds;Jf("function"==typeof e,"listener must be a function."),Jf(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe((function(){var i=t.store.getState(),o=i.stateId;try{var s=o===r||o===r+1&&!function(e,t){return e!==Fh&&(e===Hh||void 0===t||(n=e,t.filter((function(e){return n.indexOf(e)>-1}))).length>0);var n}(i.dirtyHandlerIds,n);s||e()}finally{r=o}}))}},{key:"subscribeToOffsetChange",value:function(e){var t=this;Jf("function"==typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return Jf(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return Jf(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&(ch(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e))}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return Jf(t,"Expected to find a valid source. sourceId=".concat(e)),!(!this.isDragging()||!this.isSourcePublic())&&(this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e))}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!ch(n,r))return!1;var i=this.getTargetIds();if(!i.length)return!1;var o=i.indexOf(e);return t?o===i.length-1:o>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return e=this.store.getState().dragOffset,r=e.clientOffset,i=e.initialClientOffset,o=e.initialSourceClientOffset,r&&i&&o?Kh((n=o,{x:(t=r).x+n.x,y:t.y+n.y}),i):null;var e,t,n,r,i,o}},{key:"getDifferenceFromInitialOffset",value:function(){return e=this.store.getState().dragOffset,t=e.clientOffset,n=e.initialClientOffset,t&&n?Kh(t,n):null;var e,t,n}}]),e}(),Yh=0;function Qh(e){return(Qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zh(e,t){t&&Array.isArray(e)?e.forEach((function(e){return Zh(e,!1)})):Jf("string"==typeof e||"symbol"===Qh(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}const ep="undefined"!=typeof global?global:self,tp=ep.MutationObserver||ep.WebKitMutationObserver;function np(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const rp="function"==typeof tp?function(e){let t=1;const n=new tp(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:np;class ip{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const op=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=rp(this.flush),this.requestErrorThrow=np((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},sp=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new ip(this.onError,(e=>t[t.length]=e));return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(op.registerPendingError);function ap(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function cp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function up(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return lp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dp(e){var t=(Yh++).toString();switch(e){case $f.SOURCE:return"S".concat(t);case $f.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function fp(e){switch(e[0]){case"S":return $f.SOURCE;case"T":return $f.TARGET;default:Jf(!1,"Cannot parse handler ID: ".concat(e))}}function hp(e,t){var n=e.entries(),r=!1;do{var i=n.next(),o=i.done;if(up(i.value,2)[1]===t)return!0;r=!!o}while(!r);return!1}var pp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),cp(this,"types",new Map),cp(this,"dragSources",new Map),cp(this,"dropTargets",new Map),cp(this,"pinnedSourceId",null),cp(this,"pinnedSource",null),cp(this,"store",void 0),this.store=t}return ap(e,[{key:"addSource",value:function(e,t){Zh(e),function(e){Jf("function"==typeof e.canDrag,"Expected canDrag to be a function."),Jf("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),Jf("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler($f.SOURCE,e,t);return this.store.dispatch(function(e){return{type:Eh,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){Zh(e,!0),function(e){Jf("function"==typeof e.canDrop,"Expected canDrop to be a function."),Jf("function"==typeof e.hover,"Expected hover to be a function."),Jf("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler($f.TARGET,e,t);return this.store.dispatch(function(e){return{type:kh,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return hp(this.dragSources,e)||hp(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Jf(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return Jf(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return Jf(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return Jf(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return fp(e)===$f.SOURCE}},{key:"isTargetId",value:function(e){return fp(e)===$f.TARGET}},{key:"removeSource",value:function(e){var t,n=this;Jf(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:Ph,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},op.enqueueTask(sp.create(t))}},{key:"removeTarget",value:function(e){Jf(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:Nh,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);Jf(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){Jf(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=dp(e);return this.types.set(r,t),e===$f.SOURCE?this.dragSources.set(r,n):e===$f.TARGET&&this.dropTargets.set(r,n),r}}]),e}();function gp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return Th($h,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),i=new Xh(r,new pp(r)),o=new vh(r,i),s=e(o,t,n);return o.receiveBackend(s),o}var mp=["children"];function vp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bp(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var wp=0,xp=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),Tp=o.memo((function(e){var t=e.children,n=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dp(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=t;i[xp]||(i[xp]={dragDropManager:gp(e,t,n,r)});return i[xp]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(bp(e,mp)),r=vp(n,2),i=r[0],s=r[1];return o.useEffect((function(){if(s){var e=Dp();return++wp,function(){0==--wp&&(e[xp]=null)}}}),[]),c.jsx(Gf.Provider,Object.assign({value:i},{children:t}),void 0)}));function Dp(){return"undefined"!=typeof global?global:window}function Sp(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Rp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Op=!1,Cp=!1,jp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Rp(this,"internalMonitor",void 0),Rp(this,"sourceId",null),this.internalMonitor=t.getMonitor()}return Sp(e,[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){Jf(!Op,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Op=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Op=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;Jf(!Cp,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Cp=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Cp=!1}}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"isDraggingSource",value:function(e){return this.internalMonitor.isDraggingSource(e)}},{key:"isOverTarget",value:function(e,t){return this.internalMonitor.isOverTarget(e,t)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(e){return this.internalMonitor.subscribeToOffsetChange(e)}},{key:"canDragSource",value:function(e){return this.internalMonitor.canDragSource(e)}},{key:"canDropOnTarget",value:function(e){return this.internalMonitor.canDropOnTarget(e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}();function Ep(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function kp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pp=!1,Np=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),kp(this,"internalMonitor",void 0),kp(this,"targetId",null),this.internalMonitor=t.getMonitor()}return Ep(e,[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;Jf(!Pp,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Pp=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Pp=!1}}},{key:"isOver",value:function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}();function _p(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!o.isValidElement(t)){var r=t;return e(r,n),r}var i=t;return function(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}(i),function(e,t){var n=e.ref;return Jf("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?o.cloneElement(e,{ref:function(e){Mp(n,e),Mp(t,e)}}):o.cloneElement(e,{ref:t})}(i,n?function(t){return e(t,n)}:e)}}function Ip(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{var i=_p(r);t[n]=function(){return i}}})),t}function Mp(e,t){"function"==typeof e?e(t):e.current=t}function qp(e){return(qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ap(e){return null!==e&&"object"===qp(e)&&Object.prototype.hasOwnProperty.call(e,"current")}function Lp(e,t,n,r){var i=void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<o.length;c++){var u=o[c];if(!a(u))return!1;var l=e[u],d=t[u];if(!1===(i=void 0)||void 0===i&&l!==d)return!1}return!0}function Fp(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Hp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Up=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Hp(this,"hooks",Ip({dragSource:function(e,t){n.clearDragSource(),n.dragSourceOptions=t||null,Ap(e)?n.dragSourceRef=e:n.dragSourceNode=e,n.reconnectDragSource()},dragPreview:function(e,t){n.clearDragPreview(),n.dragPreviewOptions=t||null,Ap(e)?n.dragPreviewRef=e:n.dragPreviewNode=e,n.reconnectDragPreview()}})),Hp(this,"handlerId",null),Hp(this,"dragSourceRef",null),Hp(this,"dragSourceNode",void 0),Hp(this,"dragSourceOptionsInternal",null),Hp(this,"dragSourceUnsubscribe",void 0),Hp(this,"dragPreviewRef",null),Hp(this,"dragPreviewNode",void 0),Hp(this,"dragPreviewOptionsInternal",null),Hp(this,"dragPreviewUnsubscribe",void 0),Hp(this,"lastConnectedHandlerId",null),Hp(this,"lastConnectedDragSource",null),Hp(this,"lastConnectedDragSourceOptions",null),Hp(this,"lastConnectedDragPreview",null),Hp(this,"lastConnectedDragPreviewOptions",null),Hp(this,"backend",void 0),this.backend=t}return Fp(e,[{key:"receiveHandlerId",value:function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e)}},{key:"reconnectDragPreview",value:function(){var e=this.dragPreview,t=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();t&&this.disconnectDragPreview(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=e,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,e,this.dragPreviewOptions)):this.lastConnectedDragPreview=e)}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!Lp(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!Lp(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}]),e}();function Wp(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Bp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zp=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Bp(this,"hooks",Ip({dropTarget:function(e,t){n.clearDropTarget(),n.dropTargetOptions=t,Ap(e)?n.dropTargetRef=e:n.dropTargetNode=e,n.reconnect()}})),Bp(this,"handlerId",null),Bp(this,"dropTargetRef",null),Bp(this,"dropTargetNode",void 0),Bp(this,"dropTargetOptionsInternal",null),Bp(this,"unsubscribeDropTarget",void 0),Bp(this,"lastConnectedHandlerId",null),Bp(this,"lastConnectedDropTarget",null),Bp(this,"lastConnectedDropTargetOptions",null),Bp(this,"backend",void 0),this.backend=t}return Wp(e,[{key:"connectTarget",get:function(){return this.dropTarget}},{key:"reconnect",value:function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}},{key:"receiveHandlerId",value:function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!Lp(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}}]),e}();var Vp="undefined"!=typeof window?o.useLayoutEffect:o.useEffect;function $p(e){return($p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kp(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Gp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jp=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Gp(this,"spec",void 0),Gp(this,"monitor",void 0),Gp(this,"connector",void 0),this.spec=t,this.monitor=n,this.connector=r}return Kp(e,[{key:"beginDrag",value:function(){var e,t=this.spec,n=this.monitor;return null!==(e="object"===$p(t.item)?t.item:"function"==typeof t.item?t.item(n):{})&&void 0!==e?e:null}},{key:"canDrag",value:function(){var e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}},{key:"isDragging",value:function(e,t){var n=this.spec,r=this.monitor,i=n.isDragging;return i?i(r):t===e.getSourceId()}},{key:"endDrag",value:function(){var e=this.spec,t=this.monitor,n=this.connector,r=e.end;r&&r(t.getItem(),t),n.reconnect()}}]),e}();function Xp(){var e=o.useContext(Gf).dragDropManager;return Jf(null!=e,"Expected drag drop context"),e}function Yp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zp(e,t,n){var r=Xp(),i=function(e,t,n){var r=o.useMemo((function(){return new Jp(e,t,n)}),[t,n]);return o.useEffect((function(){r.spec=e}),[e]),r}(e,t,n),s=function(e){return o.useMemo((function(){var t=e.type;return Jf(null!=t,"spec.type must be defined"),t}),[e])}(e);Vp((function(){if(null!=s){var e=function(e,t,n){var r=n.getRegistry(),i=r.addSource(e,t);return[i,function(){return r.removeSource(i)}]}(s,i,r),o=Yp(e,2),a=o[0],c=o[1];return t.receiveHandlerId(a),n.receiveHandlerId(a),c}}),[r,t,n,i,s])}function eg(e){return function(e){if(Array.isArray(e))return tg(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return tg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tg(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ng(e,t){var n=eg(t||[]);return null==t&&"function"!=typeof e&&n.push(e),o.useMemo((function(){return"function"==typeof e?e():e}),n)}function rg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ig(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ig(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ig(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function og(e,t,n){var r=rg(o.useState((function(){return t(e)})),2),i=r[0],s=r[1],a=o.useCallback((function(){var r=t(e);Ke(i,r)||(s(r),n&&n())}),[i,e,n]);return Vp(a),[i,a]}function sg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ag(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ag(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ag(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cg(e,t,n){return function(e,t,n){var r=sg(og(e,t,n),2),i=r[0],o=r[1];return Vp((function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(o,{handlerIds:[t]})}),[e,o]),i}(t,e||function(){return{}},(function(){return n.reconnect()}))}function ug(e){return o.useMemo((function(){return e.hooks.dragSource()}),[e])}function lg(e){return o.useMemo((function(){return e.hooks.dragPreview()}),[e])}function dg(e,t){var n=ng(e,t);Jf(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var r,i=(r=Xp(),o.useMemo((function(){return new jp(r)}),[r])),s=function(e,t){var n=Xp(),r=o.useMemo((function(){return new Up(n.getBackend())}),[n]);return Vp((function(){return r.dragSourceOptions=e||null,r.reconnect(),function(){return r.disconnectDragSource()}}),[r,e]),Vp((function(){return r.dragPreviewOptions=t||null,r.reconnect(),function(){return r.disconnectDragPreview()}}),[r,t]),r}(n.options,n.previewOptions);return Zp(n,i,s),[cg(n.collect,i,s),ug(s),lg(s)]}function fg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function hg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pg=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),hg(this,"spec",void 0),hg(this,"monitor",void 0),this.spec=t,this.monitor=n}return fg(e,[{key:"canDrop",value:function(){var e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}},{key:"hover",value:function(){var e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}},{key:"drop",value:function(){var e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}}]),e}();function gg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vg(e,t,n){var r=Xp(),i=function(e,t){var n=o.useMemo((function(){return new pg(e,t)}),[t]);return o.useEffect((function(){n.spec=e}),[e]),n}(e,t),s=function(e){var t=e.accept;return o.useMemo((function(){return Jf(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t]}),[t])}(e);Vp((function(){var e=function(e,t,n){var r=n.getRegistry(),i=r.addTarget(e,t);return[i,function(){return r.removeTarget(i)}]}(s,i,r),o=gg(e,2),a=o[0],c=o[1];return t.receiveHandlerId(a),n.receiveHandlerId(a),c}),[r,t,i,n,s.map((function(e){return e.toString()})).join("|")])}function yg(e){return o.useMemo((function(){return e.hooks.dropTarget()}),[e])}function bg(e,t){var n,r=ng(e,t),i=(n=Xp(),o.useMemo((function(){return new Np(n)}),[n])),s=function(e){var t=Xp(),n=o.useMemo((function(){return new zp(t.getBackend())}),[t]);return Vp((function(){return n.dropTargetOptions=e||null,n.reconnect(),function(){return n.disconnectDropTarget()}}),[e]),n}(r.options);return vg(r,i,s),[cg(r.collect,i,s),yg(s)]}function wg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(Fm){a=!0,i=Fm}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tg(e){var t=null;return function(){return null==t&&(t=e()),t}}function Dg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Sg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Sg(this,"entered",[]),Sg(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}return Dg(e,[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var i=[];return n.forEach((function(e){return i.push(e)})),i}(this.entered.filter((function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))})),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter((function(e){return e!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}]),e}(),Og=Tg((function(){return/firefox/i.test(navigator.userAgent)})),Cg=Tg((function(){return Boolean(window.safari)}));function jg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Eg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kg=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Eg(this,"xs",void 0),Eg(this,"ys",void 0),Eg(this,"c1s",void 0),Eg(this,"c2s",void 0),Eg(this,"c3s",void 0);for(var r=t.length,i=[],o=0;o<r;o++)i.push(o);i.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var s,a,c=[],u=[],l=0;l<r-1;l++)s=t[l+1]-t[l],a=n[l+1]-n[l],c.push(s),u.push(a/s);for(var d=[u[0]],f=0;f<c.length-1;f++){var h=u[f],p=u[f+1];if(h*p<=0)d.push(0);else{s=c[f];var g=c[f+1],m=s+g;d.push(3*m/((m+g)/h+(m+s)/p))}}d.push(u[u.length-1]);for(var v,y=[],b=[],w=0;w<d.length-1;w++){v=u[w];var x=d[w],T=1/c[w],D=x+d[w+1]-v-v;y.push((v-x-D)*T),b.push(D*T*T)}this.xs=t,this.ys=n,this.c1s=d,this.c2s=y,this.c3s=b}return jg(e,[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,i=this.c2s,o=this.c3s,s=t.length-1;if(e===t[s])return n[s];for(var a,c=0,u=o.length-1;c<=u;){var l=t[a=Math.floor(.5*(c+u))];if(l<e)c=a+1;else{if(!(l>e))return n[a];u=a-1}}var d=e-t[s=Math.max(0,u)],f=d*d;return n[s]+r[s]*d+i[s]*f+o[s]*d*f}}]),e}(),Pg=1;function Ng(e){var t=e.nodeType===Pg?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function _g(e){return{x:e.clientX,y:e.clientY}}function Ig(e,t,n,r,i){var o,s,a,c="IMG"===(o=t).nodeName&&(Og()||!(null!==(s=document.documentElement)&&void 0!==s&&s.contains(o))),u=Ng(c?e:t),l={x:n.x-u.x,y:n.y-u.y},d=e.offsetWidth,f=e.offsetHeight,h=r.anchorX,p=r.anchorY,g=function(e,t,n,r){var i=e?t.width:n,o=e?t.height:r;return Cg()&&e&&(o/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:o}}(c,t,d,f),m=g.dragPreviewWidth,v=g.dragPreviewHeight,y=i.offsetX,b=i.offsetY,w=0===b||b;return{x:0===y||y?y:new kg([0,.5,1],[l.x,l.x/d*m,l.x+m-d]).interpolate(h),y:w?b:(a=new kg([0,.5,1],[l.y,l.y/f*v,l.y+v-f]).interpolate(p),Cg()&&c&&(a+=(window.devicePixelRatio-1)*v),a)}}var Mg="__NATIVE_FILE__",qg="__NATIVE_URL__",Ag="__NATIVE_TEXT__",Lg="__NATIVE_HTML__";const Fg=Object.freeze(Object.defineProperty({__proto__:null,FILE:Mg,HTML:Lg,TEXT:Ag,URL:qg},Symbol.toStringTag,{value:"Module"}));function Hg(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),"");return null!=r?r:n}var Ug;function Wg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bg=(Wg(Ug={},Mg,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),Wg(Ug,Lg,{exposeProperties:{html:function(e,t){return Hg(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),Wg(Ug,qg,{exposeProperties:{urls:function(e,t){return Hg(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),Wg(Ug,Ag,{exposeProperties:{text:function(e,t){return Hg(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]}),Ug);function zg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Vg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Vg(this,"item",void 0),Vg(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}return zg(e,[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach((function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}]),e}();function Kg(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(Bg).filter((function(e){return Bg[e].matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null}function Gg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function Jg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xg=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Jg(this,"ownerDocument",null),Jg(this,"globalContext",void 0),Jg(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=n}return Gg(e,[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}},{key:"document",get:function(){var e;return null!==(e=this.globalContext)&&void 0!==e&&e.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}}]),e}();function Yg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yg(Object(n),!0).forEach((function(t){em(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zg(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function em(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tm,nm=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),em(this,"options",void 0),em(this,"actions",void 0),em(this,"monitor",void 0),em(this,"registry",void 0),em(this,"enterLeaveCounter",void 0),em(this,"sourcePreviewNodes",new Map),em(this,"sourcePreviewNodeOptions",new Map),em(this,"sourceNodes",new Map),em(this,"sourceNodeOptions",new Map),em(this,"dragStartSourceIds",null),em(this,"dropTargetIds",[]),em(this,"dragEnterTargetIds",[]),em(this,"currentNativeSource",null),em(this,"currentNativeHandle",null),em(this,"currentDragSourceNode",null),em(this,"altKeyPressed",!1),em(this,"mouseMoveTimeoutTimer",null),em(this,"asyncEndDragFrameId",null),em(this,"dragOverTargetIds",null),em(this,"lastClientOffset",null),em(this,"hoverRafId",null),em(this,"getSourceClientOffset",(function(e){var t=i.sourceNodes.get(e);return t&&Ng(t)||null})),em(this,"endDragNativeItem",(function(){i.isDraggingNativeItem()&&(i.actions.endDrag(),i.currentNativeHandle&&i.registry.removeSource(i.currentNativeHandle),i.currentNativeHandle=null,i.currentNativeSource=null)})),em(this,"isNodeInDocument",(function(e){return Boolean(e&&i.document&&i.document.body&&i.document.body.contains(e))})),em(this,"endDragIfSourceWasRemovedFromDOM",(function(){var e=i.currentDragSourceNode;null==e||i.isNodeInDocument(e)||i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag()})),em(this,"handleTopDragStartCapture",(function(){i.clearCurrentDragSourceNode(),i.dragStartSourceIds=[]})),em(this,"handleTopDragStart",(function(e){if(!e.defaultPrevented){var t=i.dragStartSourceIds;i.dragStartSourceIds=null;var n=_g(e);i.monitor.isDragging()&&i.actions.endDrag(),i.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:i.getSourceClientOffset,clientOffset:n});var r=e.dataTransfer,o=Kg(r);if(i.monitor.isDragging()){if(r&&"function"==typeof r.setDragImage){var s=i.monitor.getSourceId(),a=i.sourceNodes.get(s),c=i.sourcePreviewNodes.get(s)||a;if(c){var u=i.getCurrentSourcePreviewNodeOptions(),l=Ig(a,c,n,{anchorX:u.anchorX,anchorY:u.anchorY},{offsetX:u.offsetX,offsetY:u.offsetY});r.setDragImage(c,l.x,l.y)}}try{null==r||r.setData("application/json",{})}catch(Fm){}i.setCurrentDragSourceNode(e.target),i.getCurrentSourcePreviewNodeOptions().captureDraggingState?i.actions.publishDragSource():setTimeout((function(){return i.actions.publishDragSource()}),0)}else if(o)i.beginDragNativeItem(o);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}})),em(this,"handleTopDragEndCapture",(function(){i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag()})),em(this,"handleTopDragEnterCapture",(function(e){if(i.dragEnterTargetIds=[],i.enterLeaveCounter.enter(e.target)&&!i.monitor.isDragging()){var t=e.dataTransfer,n=Kg(t);n&&i.beginDragNativeItem(n,t)}})),em(this,"handleTopDragEnter",(function(e){var t=i.dragEnterTargetIds;(i.dragEnterTargetIds=[],i.monitor.isDragging())&&(i.altKeyPressed=e.altKey,t.length>0&&i.actions.hover(t,{clientOffset:_g(e)}),t.some((function(e){return i.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())))})),em(this,"handleTopDragOverCapture",(function(){i.dragOverTargetIds=[]})),em(this,"handleTopDragOver",(function(e){var t=i.dragOverTargetIds;if(i.dragOverTargetIds=[],!i.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));i.altKeyPressed=e.altKey,i.lastClientOffset=_g(e),null===i.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(i.hoverRafId=requestAnimationFrame((function(){i.monitor.isDragging()&&i.actions.hover(t||[],{clientOffset:i.lastClientOffset}),i.hoverRafId=null}))),(t||[]).some((function(e){return i.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())):i.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))})),em(this,"handleTopDragLeaveCapture",(function(e){i.isDraggingNativeItem()&&e.preventDefault(),i.enterLeaveCounter.leave(e.target)&&i.isDraggingNativeItem()&&setTimeout((function(){return i.endDragNativeItem()}),0)})),em(this,"handleTopDropCapture",(function(e){var t;(i.dropTargetIds=[],i.isDraggingNativeItem())?(e.preventDefault(),null===(t=i.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):Kg(e.dataTransfer)&&e.preventDefault();i.enterLeaveCounter.reset()})),em(this,"handleTopDrop",(function(e){var t=i.dropTargetIds;i.dropTargetIds=[],i.actions.hover(t,{clientOffset:_g(e)}),i.actions.drop({dropEffect:i.getCurrentDropEffect()}),i.isDraggingNativeItem()?i.endDragNativeItem():i.monitor.isDragging()&&i.actions.endDrag()})),em(this,"handleSelectStart",(function(e){var t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))})),this.options=new Xg(n,r),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new Rg(this.isNodeInDocument)}return Zg(e,[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(e=this.window)||void 0===e||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var i=function(t){return r.handleDragStart(t,e)},o=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",i),t.addEventListener("selectstart",o),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",i),t.removeEventListener("selectstart",o),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},i=function(t){return n.handleDragOver(t,e)},o=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",i),t.addEventListener("drop",o),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",i),t.removeEventListener("drop",o)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return Qg({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return Qg({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(Fg).some((function(t){return Fg[t]===e}))}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new $g(Bg[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout((function(){var e;return null===(e=t.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}]),e}();var rm=function(e,t,n){return new nm(e,t,n)};function im(e){const t=Dd(),n=t.selectedIds,[r,i,s]=dg((()=>({canDrag:()=>e.isDraggable,type:"NODE",item:()=>{const r=t.isSelected(e.id)?Array.from(n):[e.id];return t.dispatch(yf.dragStart(e.id,r)),{id:e.id}},end:()=>{t.hideCursor();let{parentId:e,index:n,dragIds:r}=t.state.dnd;t.canDrop()&&(zd(t.props.onMove,{dragIds:r,parentId:e===af?null:e,index:null===n?0:n,dragNodes:t.dragNodes,parentNode:t.get(e)}),t.open(e)),t.dispatch(yf.dragEnd())}})),[n,e]);return o.useEffect((()=>{s((tm||((tm=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),tm))}),[s]),i}function om(e,t){return{parentId:e||null,index:t}}function sm(e,t){return{type:"line",index:e,level:t}}function am(e,t){var n;let r=e;for(;r.parent&&r.level>t;)r=r.parent;return{parentId:(null===(n=r.parent)||void 0===n?void 0:n.id)||null,index:_d(r)+1}}function cm(e){var t;const n=function(e,t){const n=e.getBoundingClientRect(),r=t.x-Math.round(n.x),i=t.y-Math.round(n.y),o=n.height,s=i<o/2,a=!s,c=o/4,u=i>c&&i<o-c;return{x:r,inTopHalf:s,inBottomHalf:a,inMiddle:u,atTop:!u&&s,atBottom:!u&&a}}(e.element,e.offset),r=e.indent,i=Math.round(Math.max(0,n.x-r)/r),{node:o,nextNode:s,prevNode:a}=e,[c,u]=function(e,t,n,r){return e?e.isInternal?r.atTop?[t,e]:r.inMiddle?[e,e]:[e,n]:r.inTopHalf?[t,e]:[e,n]:[t,null]}(o,a,s,n);if(o&&o.isInternal&&n.inMiddle)return{drop:om(o.id,null),cursor:(l=o.id,{type:"highlight",id:l})};var l;if(!c)return{drop:om(null===(t=null==u?void 0:u.parent)||void 0===t?void 0:t.id,0),cursor:sm(0,0)};if(Ed(c)){const e=jd(i,(null==u?void 0:u.level)||0,c.level);return{drop:am(c,e),cursor:sm(c.rowIndex+1,e)}}if(kd(c)){const e=jd(i,(null==u?void 0:u.level)||0,c.level);return{drop:am(c,e),cursor:sm(c.rowIndex+1,e)}}if(Pd(c)){const e=jd(i,0,c.level+1);return e>c.level?{drop:om(c.id,0),cursor:sm(c.rowIndex+1,e)}:{drop:am(c,e),cursor:sm(c.rowIndex+1,e)}}return{drop:om(null==c?void 0:c.id,0),cursor:sm(c.rowIndex+1,c.level+1)}}const um=a.memo((function({index:e,style:t}){Cd(),function(){const e=o.useContext(Sd);if(null===e)throw new Error("Provide a NodesContext")}();const n=Dd(),r=function(e){const t=Dd(),n=t.at(e);if(!n)throw new Error(`Could not find node for index: ${e}`);return o.useMemo((()=>{const r=n.clone();return t.visibleNodes[e]=r,r}),[...Object.values(n.state),n])}(e),i=o.useRef(null),s=im(r),a=function(e,t){const n=Dd(),[r,i]=bg((()=>({accept:"NODE",canDrop:()=>n.canDrop(),hover:(r,i)=>{const o=i.getClientOffset();if(!e.current||!o)return;const{cursor:s,drop:a}=cm({element:e.current,offset:o,indent:n.indent,node:t,prevNode:t.prev,nextNode:t.next});a&&n.dispatch(yf.hovering(a.parentId,a.index)),i.canDrop()?s&&n.showCursor(s):n.hideCursor()},drop:(e,t)=>{if(!t.canDrop())return null}})),[t,e.current,n.props]);return i}(i,r),u=o.useCallback((e=>{i.current=e,a(e)}),[a]),l=n.indent*r.level,d=o.useMemo((()=>({paddingLeft:l})),[l]),f=o.useMemo((()=>{var e,r;return Object.assign(Object.assign({},t),{top:parseFloat(t.top)+(null!==(r=null!==(e=n.props.padding)&&void 0!==e?e:n.props.paddingTop)&&void 0!==r?r:0)})}),[t,n.props.padding,n.props.paddingTop]),h={role:"treeitem","aria-level":r.level+1,"aria-selected":r.isSelected,style:f,tabIndex:-1,className:n.props.rowClassName};o.useEffect((()=>{var e;!r.isEditing&&r.isFocused&&(null===(e=i.current)||void 0===e||e.focus({preventScroll:!0}))}),[r.isEditing,r.isFocused,i.current]);const p=n.renderNode,g=n.renderRow;return c.jsx(g,{node:r,innerRef:u,attrs:h,children:c.jsx(p,{node:r,tree:n,style:d,dragHandle:s})})}));let lm="",dm=null;function fm(){Cd();const e=Dd();return c.jsx("div",{role:"tree",style:{height:e.height,width:e.width,minHeight:0,minWidth:0},onContextMenu:e.props.onContextMenu,onClick:e.props.onClick,tabIndex:0,onFocus:t=>{t.currentTarget.contains(t.relatedTarget)||e.onFocus()},onBlur:t=>{t.currentTarget.contains(t.relatedTarget)||e.onBlur()},onKeyDown:t=>{var n;if(e.isEditing)return;if("Backspace"===t.key){if(!e.props.onDelete)return;const t=Array.from(e.selectedIds);if(t.length>1){let n=e.mostRecentNode;for(;n&&n.isSelected;)n=n.nextSibling;n||(n=e.lastNode),e.focus(n,{scroll:!1}),e.delete(Array.from(t))}else{const t=e.focusedNode;if(t){const n=t.nextSibling,r=t.parent;e.focus(n||r,{scroll:!1}),e.delete(t)}}return}if("Tab"===t.key&&!t.shiftKey)return t.preventDefault(),void qd(t.currentTarget);if("Tab"===t.key&&t.shiftKey)return t.preventDefault(),void Ad(t.currentTarget);if("ArrowDown"===t.key){t.preventDefault();const n=e.nextNode;if(t.metaKey)return e.select(e.focusedNode),void e.activate(e.focusedNode);if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);{if(!n)return;const t=e.focusedNode;return void(t?t.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.firstNode))}}if("ArrowUp"===t.key){t.preventDefault();const n=e.prevNode;if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);{if(!n)return;const t=e.focusedNode;return void(t?t.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.lastNode))}}if("ArrowRight"===t.key){const t=e.focusedNode;if(!t)return;return void(t.isInternal&&t.isOpen?e.focus(e.nextNode):t.isInternal&&e.open(t.id))}if("ArrowLeft"===t.key){const t=e.focusedNode;if(!t||t.isRoot)return;return void(t.isInternal&&t.isOpen?e.close(t.id):(null===(n=t.parent)||void 0===n?void 0:n.isRoot)||e.focus(t.parent))}if("a"===t.key&&t.metaKey&&!e.props.disableMultiSelection)return t.preventDefault(),void e.selectAll();if("a"===t.key&&!t.metaKey&&e.props.onCreate)return void e.createLeaf();if("A"===t.key&&!t.metaKey){if(!e.props.onCreate)return;return void e.createInternal()}if("Home"===t.key)return t.preventDefault(),void e.focus(e.firstNode);if("End"===t.key)return t.preventDefault(),void e.focus(e.lastNode);if("Enter"===t.key){const t=e.focusedNode;if(!t)return;if(!t.isEditable||!e.props.onRename)return;return void setTimeout((()=>{t&&e.edit(t)}))}if(" "===t.key){t.preventDefault();const n=e.focusedNode;if(!n)return;return void(n.isLeaf?(n.select(),n.activate()):n.toggle())}if("*"===t.key){const t=e.focusedNode;if(!t)return;return void e.openSiblings(t)}if("PageUp"===t.key)return t.preventDefault(),void e.pageUp();"PageDown"===t.key&&(t.preventDefault(),e.pageDown()),clearTimeout(dm),lm+=t.key,dm=setTimeout((()=>{lm=""}),600);const r=e.visibleNodes.find((e=>{const t=e.data.name;return"string"==typeof t&&t.toLowerCase().startsWith(lm)}));r&&e.focus(r.id)},children:c.jsx(Uf,{className:e.props.className,outerRef:e.listEl,itemCount:e.visibleNodes.length,height:e.height,width:e.width,itemSize:e.rowHeight,overscanCount:e.overscanCount,itemKey:t=>{var n;return(null===(n=e.visibleNodes[t])||void 0===n?void 0:n.id)||t},outerElementType:Bf,innerElementType:Vf,onScroll:e.props.onScroll,onItemsRendered:e.onItemsRendered.bind(e),ref:e.list,children:um})})}function hm(e){return e.isFiltered?function(e,t){const n={},r=[];function i(e){if(!e.isRoot&&t(e)){n[e.id]=!0;let t=e.parent;for(;t;)n[t.id]=!0,t=t.parent}if(e.children)for(let t of e.children)i(t)}function o(e){var t;e.level>=0&&n[e.id]&&r.push(e),e.isOpen&&(null===(t=e.children)||void 0===t||t.forEach(o))}return i(e),o(e),r.forEach(pm),r}(e.root,e.isMatch.bind(e)):function(e){const t=[];function n(e){var r;e.level>=0&&t.push(e),e.isOpen&&(null===(r=e.children)||void 0===r||r.forEach(n))}return n(e),t.forEach(pm),t}(e.root)}function pm(e,t){e.rowIndex=t}const gm=e=>e.reduce(((e,t,n)=>(e[t.id]=n,e)),{});var mm=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const{safeRun:vm,identify:ym,identifyNull:bm}=Gd;class wm{constructor(e,t,n,r){this.store=e,this.props=t,this.list=n,this.listEl=r,this.visibleStartIndex=0,this.visibleStopIndex=0,this.root=cf(this),this.visibleNodes=hm(this),this.idToIndex=gm(this.visibleNodes)}update(e){this.props=e,this.root=cf(this),this.visibleNodes=hm(this),this.idToIndex=gm(this.visibleNodes)}dispatch(e){return this.store.dispatch(e)}get state(){return this.store.getState()}get openState(){return this.state.nodes.open.unfiltered}get width(){var e;return null!==(e=this.props.width)&&void 0!==e?e:300}get height(){var e;return null!==(e=this.props.height)&&void 0!==e?e:500}get indent(){var e;return null!==(e=this.props.indent)&&void 0!==e?e:24}get rowHeight(){var e;return null!==(e=this.props.rowHeight)&&void 0!==e?e:24}get overscanCount(){var e;return null!==(e=this.props.overscanCount)&&void 0!==e?e:1}get searchTerm(){return(this.props.searchTerm||"").trim()}get matchFn(){var e;const t=null!==(e=this.props.searchMatch)&&void 0!==e?e:(e,t)=>JSON.stringify(Object.values(e.data)).toLocaleLowerCase().includes(t.toLocaleLowerCase());return e=>t(e,this.searchTerm)}accessChildren(e){var t;return null!==(t=Ud(e,this.props.childrenAccessor||"children"))&&void 0!==t?t:null}accessId(e){const t=Ud(e,this.props.idAccessor||"id");if(!t)throw new Error("Data must contain an 'id' property or props.idAccessor must return a string");return t}get firstNode(){var e;return null!==(e=this.visibleNodes[0])&&void 0!==e?e:null}get lastNode(){var e;return null!==(e=this.visibleNodes[this.visibleNodes.length-1])&&void 0!==e?e:null}get focusedNode(){var e;return null!==(e=this.get(this.state.nodes.focus.id))&&void 0!==e?e:null}get mostRecentNode(){var e;return null!==(e=this.get(this.state.nodes.selection.mostRecent))&&void 0!==e?e:null}get nextNode(){const e=this.indexOf(this.focusedNode);return null===e?null:this.at(e+1)}get prevNode(){const e=this.indexOf(this.focusedNode);return null===e?null:this.at(e-1)}get(e){return e&&e in this.idToIndex&&this.visibleNodes[this.idToIndex[e]]||null}at(e){return this.visibleNodes[e]||null}nodesBetween(e,t){var n;if(null===e||null===t)return[];const r=null!==(n=this.indexOf(e))&&void 0!==n?n:0,i=this.indexOf(t);if(null===i)return[];const o=Math.min(r,i),s=Math.max(r,i);return this.visibleNodes.slice(o,s+1)}indexOf(e){const t=Wd(e);return t?this.idToIndex[t]:null}get editingId(){return this.state.nodes.edit.id}createInternal(){return this.create({type:"internal"})}createLeaf(){return this.create({type:"leaf"})}create(e={}){var t,n;return mm(this,void 0,void 0,(function*(){const r=void 0===e.parentId?Kd(this):e.parentId,i=null!==(t=e.index)&&void 0!==t?t:$d(this),o=null!==(n=e.type)&&void 0!==n?n:"leaf",s=yield vm(this.props.onCreate,{type:o,parentId:r,index:i,parentNode:this.get(r)});s&&(this.focus(s),setTimeout((()=>{this.edit(s).then((()=>{this.select(s),this.activate(s)}))})))}))}delete(e){return mm(this,void 0,void 0,(function*(){if(!e)return;const t=(Array.isArray(e)?e:[e]).map(ym),n=t.map((e=>this.get(e))).filter((e=>!!e));yield vm(this.props.onDelete,{nodes:n,ids:t})}))}edit(e){const t=ym(e);return this.resolveEdit({cancelled:!0}),this.scrollTo(t),this.dispatch(rf(t)),new Promise((e=>{wm.editPromise=e}))}submit(e,t){return mm(this,void 0,void 0,(function*(){if(!e)return;const n=ym(e);yield vm(this.props.onRename,{id:n,name:t,node:this.get(n)}),this.dispatch(rf(null)),this.resolveEdit({cancelled:!1,value:t}),setTimeout((()=>this.onFocus()))}))}reset(){this.dispatch(rf(null)),this.resolveEdit({cancelled:!0}),setTimeout((()=>this.onFocus()))}activate(e){const t=this.get(bm(e));t&&vm(this.props.onActivate,t)}resolveEdit(e){const t=wm.editPromise;t&&t(e),wm.editPromise=null}get selectedIds(){return this.state.nodes.selection.ids}get selectedNodes(){let e=[];for(let t of Array.from(this.selectedIds)){const n=this.get(t);n&&e.push(n)}return e}focus(e,t={}){e&&(this.props.selectionFollowsFocus?this.select(e):(this.dispatch(of(ym(e))),!1!==t.scroll&&this.scrollTo(e),this.focusedNode&&vm(this.props.onFocus,this.focusedNode)))}pageUp(){var e,t;const n=this.visibleStartIndex,r=this.visibleStopIndex-n;let i=null!==(t=null===(e=this.focusedNode)||void 0===e?void 0:e.rowIndex)&&void 0!==t?t:0;i=i>n?n:Math.max(n-r,0),this.focus(this.at(i))}pageDown(){var e,t;const n=this.visibleStartIndex,r=this.visibleStopIndex,i=r-n;let o=null!==(t=null===(e=this.focusedNode)||void 0===e?void 0:e.rowIndex)&&void 0!==t?t:0;o=o<r?r:Math.min(o+i,this.visibleNodes.length-1),this.focus(this.at(o))}select(e,t={}){if(!e)return;const n=!1!==t.focus,r=ym(e);n&&this.dispatch(of(r)),this.dispatch(ff(r)),this.dispatch(vf(r)),this.dispatch(mf(r)),this.scrollTo(r,t.align),this.focusedNode&&n&&vm(this.props.onFocus,this.focusedNode),vm(this.props.onSelect,this.selectedNodes)}deselect(e){if(!e)return;const t=ym(e);this.dispatch(pf(t))}selectMulti(e){const t=this.get(bm(e));t&&(this.dispatch(of(t.id)),this.dispatch(hf(t.id)),this.dispatch(vf(t.id)),this.dispatch(mf(t.id)),this.scrollTo(t),this.focusedNode&&vm(this.props.onFocus,this.focusedNode),vm(this.props.onSelect,this.selectedNodes))}selectContiguous(e){if(!e)return;const t=ym(e),{anchor:n,mostRecent:r}=this.state.nodes.selection;this.dispatch(of(t)),this.dispatch(pf(this.nodesBetween(n,r))),this.dispatch(hf(this.nodesBetween(n,bm(t)))),this.dispatch(mf(t)),this.scrollTo(t),this.focusedNode&&vm(this.props.onFocus,this.focusedNode),vm(this.props.onSelect,this.selectedNodes)}deselectAll(){this.setSelection({ids:[],anchor:null,mostRecent:null}),vm(this.props.onSelect,this.selectedNodes)}selectAll(){var e;this.setSelection({ids:Object.keys(this.idToIndex),anchor:this.firstNode,mostRecent:this.lastNode}),this.dispatch(of(null===(e=this.lastNode)||void 0===e?void 0:e.id)),this.focusedNode&&vm(this.props.onFocus,this.focusedNode),vm(this.props.onSelect,this.selectedNodes)}setSelection(e){var t;const n=new Set(null===(t=e.ids)||void 0===t?void 0:t.map(ym)),r=bm(e.anchor),i=bm(e.mostRecent);this.dispatch(gf({ids:n,anchor:r,mostRecent:i})),vm(this.props.onSelect,this.selectedNodes)}get cursorParentId(){const{cursor:e}=this.state.dnd;return"highlight"===e.type?e.id:null}get cursorOverFolder(){return"highlight"===this.state.dnd.cursor.type}get dragNodes(){return this.state.dnd.dragIds.map((e=>this.get(e))).filter((e=>!!e))}get dragNode(){return this.get(this.state.nodes.drag.id)}get dragDestinationParent(){return this.get(this.state.nodes.drag.destinationParentId)}get dragDestinationIndex(){return this.state.nodes.drag.destinationIndex}canDrop(){var e;if(this.isFiltered)return!1;const t=null!==(e=this.get(this.state.dnd.parentId))&&void 0!==e?e:this.root,n=this.dragNodes,r=this.props.disableDrop;for(const i of n){if(!i)return!1;if(!t)return!1;if(i.isInternal&&Nd(t,i))return!1}return"function"==typeof r?!r({parentNode:t,dragNodes:this.dragNodes,index:this.state.dnd.index||0}):"string"==typeof r?!t.data[r]:"boolean"!=typeof r||!r}hideCursor(){this.dispatch(yf.cursor({type:"none"}))}showCursor(e){this.dispatch(yf.cursor(e))}open(e){const t=bm(e);t&&(this.isOpen(t)||(this.dispatch(uf.open(t,this.isFiltered)),vm(this.props.onToggle,t)))}close(e){const t=bm(e);t&&this.isOpen(t)&&(this.dispatch(uf.close(t,this.isFiltered)),vm(this.props.onToggle,t))}toggle(e){const t=bm(e);if(t)return this.isOpen(t)?this.close(t):this.open(t)}openParents(e){const t=bm(e);if(!t)return;const n=Id(this.root,t);let r=null==n?void 0:n.parent;for(;r;)this.open(r.id),r=r.parent}openSiblings(e){const t=e.parent;if(t){if(t.children){const n=e.isOpen;for(let e of t.children)e.isInternal&&(n?this.close(e.id):this.open(e.id));this.scrollTo(this.focusedNode)}}else this.toggle(e.id)}openAll(){Md(this.root,(e=>{e.isInternal&&e.open()}))}closeAll(){Md(this.root,(e=>{e.isInternal&&e.close()}))}scrollTo(e,t="smart"){if(!e)return;const n=ym(e);return this.openParents(n),Vd((()=>n in this.idToIndex)).then((()=>{var e;const r=this.idToIndex[n];void 0!==r&&(null===(e=this.list.current)||void 0===e||e.scrollToItem(r,t))})).catch((()=>{}))}get isEditing(){return null!==this.state.nodes.edit.id}get isFiltered(){var e;return!!(null===(e=this.props.searchTerm)||void 0===e?void 0:e.trim())}get hasFocus(){return this.state.nodes.focus.treeFocused}get hasNoSelection(){return 0===this.state.nodes.selection.ids.size}get hasOneSelection(){return 1===this.state.nodes.selection.ids.size}get hasMultipleSelections(){return this.state.nodes.selection.ids.size>1}isSelected(e){return!!e&&this.state.nodes.selection.ids.has(e)}isOpen(e){var t,n,r;if(!e)return!1;if(e===af)return!0;const i=null===(t=this.props.openByDefault)||void 0===t||t;return this.isFiltered?null===(n=this.state.nodes.open.filtered[e])||void 0===n||n:null!==(r=this.state.nodes.open.unfiltered[e])&&void 0!==r?r:i}isEditable(e){var t;return null===(t=!Ud(e,this.props.disableEdit||(()=>!1)))||void 0===t||t}isDraggable(e){var t;return null===(t=!Ud(e,this.props.disableDrag||(()=>!1)))||void 0===t||t}isDragging(e){const t=bm(e);return!!t&&this.state.nodes.drag.id===t}isFocused(e){return this.hasFocus&&this.state.nodes.focus.id===e}isMatch(e){return this.matchFn(e)}willReceiveDrop(e){const t=bm(e);if(!t)return!1;const{destinationParentId:n,destinationIndex:r}=this.state.nodes.drag;return t===n&&null===r}onFocus(){const e=this.focusedNode||this.firstNode;e&&this.dispatch(of(e.id))}onBlur(){this.dispatch({type:"TREE_BLUR"})}onItemsRendered(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleStopIndex=e.visibleStopIndex}get renderContainer(){return this.props.renderContainer||fm}get renderRow(){return this.props.renderRow||Zd}get renderNode(){return this.props.children||ef}get renderDragPreview(){return this.props.renderDragPreview||Tf}get renderCursor(){return this.props.renderCursor||Qd}}function xm(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Tm=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),Dm=()=>Math.random().toString(36).substring(7).split("").join("."),Sm={INIT:`@@redux/INIT${Dm()}`,REPLACE:`@@redux/REPLACE${Dm()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Dm()}`};function Rm(e,t,n){if("function"!=typeof e)throw new Error(xm(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(xm(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(xm(1));return n(Rm)(e,t)}let r=e,i=t,o=new Map,s=o,a=0,c=!1;function u(){s===o&&(s=new Map,o.forEach(((e,t)=>{s.set(t,e)})))}function l(){if(c)throw new Error(xm(3));return i}function d(e){if("function"!=typeof e)throw new Error(xm(4));if(c)throw new Error(xm(5));let t=!0;u();const n=a++;return s.set(n,e),function(){if(t){if(c)throw new Error(xm(6));t=!1,u(),s.delete(n),o=null}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}(e))throw new Error(xm(7));if(void 0===e.type)throw new Error(xm(8));if("string"!=typeof e.type)throw new Error(xm(17));if(c)throw new Error(xm(9));try{c=!0,i=r(i,e)}finally{c=!1}return(o=s).forEach((e=>{e()})),e}f({type:Sm.INIT});return{dispatch:f,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error(xm(10));r=e,f({type:Sm.REPLACE})},[Tm]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(xm(11));function n(){const e=t;e.next&&e.next(l())}n();return{unsubscribe:e(n)}},[Tm](){return this}}}}}function Om(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const r=t[s];"function"==typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:Sm.INIT}))throw new Error(xm(12));if(void 0===n(void 0,{type:Sm.PROBE_UNKNOWN_ACTION()}))throw new Error(xm(13))}))}(n)}catch(o){i=o}return function(e={},t){if(i)throw i;let o=!1;const s={};for(let i=0;i<r.length;i++){const a=r[i],c=n[a],u=e[a],l=c(u,t);if(void 0===l)throw t&&t.type,new Error(xm(14));s[a]=l,o=o||l!==u}return o=o||r.length!==Object.keys(e).length,o?s:e}}const Cm=Om({nodes:Om({focus:function(e={id:null,treeFocused:!1},t){return"FOCUS"===t.type?Object.assign(Object.assign({},e),{id:t.id,treeFocused:!0}):"TREE_BLUR"===t.type?Object.assign(Object.assign({},e),{treeFocused:!1}):e},edit:function(e={id:null},t){return"EDIT"===t.type?Object.assign(Object.assign({},e),{id:t.id}):e},open:function(e={filtered:{},unfiltered:{}},t){return t.type.startsWith("VISIBILITY")?t.filtered?Object.assign(Object.assign({},e),{filtered:lf(e.filtered,t)}):Object.assign(Object.assign({},e),{unfiltered:lf(e.unfiltered,t)}):e},selection:function(e=df().nodes.selection,t){const n=e.ids;switch(t.type){case"SELECTION_CLEAR":return Object.assign(Object.assign({},e),{ids:new Set});case"SELECTION_ONLY":return Object.assign(Object.assign({},e),{ids:new Set([t.id])});case"SELECTION_ADD":return 0===t.ids.length?e:(t.ids.forEach((e=>n.add(e))),Object.assign(Object.assign({},e),{ids:new Set(n)}));case"SELECTION_REMOVE":return 0===t.ids.length?e:(t.ids.forEach((e=>n.delete(e))),Object.assign(Object.assign({},e),{ids:new Set(n)}));case"SELECTION_SET":return Object.assign(Object.assign({},e),{ids:t.ids,mostRecent:t.mostRecent,anchor:t.anchor});case"SELECTION_MOST_RECENT":return Object.assign(Object.assign({},e),{mostRecent:t.id});case"SELECTION_ANCHOR":return Object.assign(Object.assign({},e),{anchor:t.id});default:return e}},drag:function(e=df().nodes.drag,t){switch(t.type){case"DND_DRAG_START":return Object.assign(Object.assign({},e),{id:t.id,selectedIds:t.dragIds});case"DND_DRAG_END":return Object.assign(Object.assign({},e),{id:null,destinationParentId:null,destinationIndex:null,selectedIds:[]});case"DND_HOVERING":return t.parentId!==e.destinationParentId||t.index!=e.destinationIndex?Object.assign(Object.assign({},e),{destinationParentId:t.parentId,destinationIndex:t.index}):e;default:return e}}}),dnd:function(e=df().dnd,t){switch(t.type){case"DND_CURSOR":return Object.assign(Object.assign({},e),{cursor:t.cursor});case"DND_DRAG_START":return Object.assign(Object.assign({},e),{dragId:t.id,dragIds:t.dragIds});case"DND_DRAG_END":return df().dnd;case"DND_HOVERING":return Object.assign(Object.assign({},e),{parentId:t.parentId,index:t.index});default:return e}}}),jm=df();function Em({treeProps:e,imperativeHandle:t,children:n}){const r=o.useRef(null),i=o.useRef(null),s=o.useRef(Rm(Cm,df(e))),a=$e.useSyncExternalStore(s.current.subscribe,s.current.getState,(()=>jm)),u=o.useMemo((()=>new wm(s.current,e,r,i)),[]),l=o.useRef(0);return o.useMemo((()=>{l.current+=1,u.update(e)}),[...Object.values(e),a.nodes.open]),o.useImperativeHandle(t,(()=>u)),o.useEffect((()=>{u.props.selection?u.select(u.props.selection,{focus:!1}):u.deselectAll()}),[u.props.selection]),o.useEffect((()=>{u.props.searchTerm||s.current.dispatch(uf.clear(!0))}),[u.props.searchTerm]),c.jsx(Td.Provider,{value:u,children:c.jsx(Od.Provider,{value:l.current,children:c.jsx(Sd.Provider,{value:a.nodes,children:c.jsx(Rd.Provider,{value:a.dnd,children:c.jsx(Tp,Object.assign({backend:rm,options:{rootElement:u.props.dndRootElement||void 0}},e.dndManager&&{manager:e.dndManager},{children:n}))})})})})}function km(e){return function(){const e=Dd(),[,t]=bg((()=>({accept:"NODE",canDrop:(t,n)=>!!n.isOver({shallow:!0})&&e.canDrop(),hover:(t,n)=>{if(!n.isOver({shallow:!0}))return;const r=n.getClientOffset();if(!e.listEl.current||!r)return;const{cursor:i,drop:o}=cm({element:e.listEl.current,offset:r,indent:e.indent,node:null,prevNode:e.visibleNodes[e.visibleNodes.length-1],nextNode:null});o&&e.dispatch(yf.hovering(o.parentId,o.index)),n.canDrop()?i&&e.showCursor(i):e.hideCursor()}})),[e]);t(e.listEl)}(),e.children}function Pm(){const e=Dd().props.renderContainer||fm;return c.jsx(c.Fragment,{children:c.jsx(e,{})})}function Nm(){const e=Dd(),{offset:t,mouse:n,item:r,isDragging:i}=(s=e=>({offset:e.getSourceClientOffset(),mouse:e.getClientOffset(),item:e.getItem(),isDragging:e.isDragging()}),a=Xp().getMonitor(),u=wg(og(a,s),2),l=u[0],d=u[1],o.useEffect((function(){return a.subscribeToOffsetChange(d)})),o.useEffect((function(){return a.subscribeToStateChange(d)})),l);var s,a,u,l,d;const f=e.props.renderDragPreview||Tf;return c.jsx(f,{offset:t,mouse:n,id:(null==r?void 0:r.id)||null,dragIds:(null==r?void 0:r.dragIds)||[],isDragging:i})}class _m{constructor(e){this.root=function(e){const t=new Mm({id:"ROOT"},null);return t.children=e.map((e=>Im(e,t))),t}(e)}get data(){var e,t;return null!==(t=null===(e=this.root.children)||void 0===e?void 0:e.map((e=>e.data)))&&void 0!==t?t:[]}create(e){const t=e.parentId?this.find(e.parentId):this.root;if(!t)return null;t.addChild(e.data,e.index)}move(e){const t=this.find(e.id),n=e.parentId?this.find(e.parentId):this.root;t&&n&&(n.addChild(t.data,e.index),t.drop())}update(e){const t=this.find(e.id);t&&t.update(e.changes)}drop(e){const t=this.find(e.id);t&&t.drop()}find(e,t=this.root){if(!t)return null;if(t.id===e)return t;if(t.children){for(let n of t.children){const t=this.find(e,n);if(t)return t}return null}return null}}function Im(e,t){const n=new Mm(e,t);return e.children&&(n.children=e.children.map((e=>Im(e,n)))),n}class Mm{constructor(e,t){this.data=e,this.parent=t,this.id=e.id}hasParent(){return!!this.parent}get childIndex(){return this.hasParent()?this.parent.children.indexOf(this):-1}addChild(e,t){var n,r;const i=Im(e,this);this.children=null!==(n=this.children)&&void 0!==n?n:[],this.children.splice(t,0,i),this.data.children=null!==(r=this.data.children)&&void 0!==r?r:[],this.data.children.splice(t,0,e)}removeChild(e){var t,n;null===(t=this.children)||void 0===t||t.splice(e,1),null===(n=this.data.children)||void 0===n||n.splice(e,1)}update(e){if(this.hasParent()){const t=this.childIndex;this.parent.addChild(Object.assign(Object.assign({},this.data),e),t),this.drop()}}drop(){this.hasParent()&&this.parent.removeChild(this.childIndex)}}let qm=0;function Am(e){if(e.initialData&&e.data)throw new Error("React Arborist Tree => Provide either a data or initialData prop, but not both.");if(e.initialData&&(e.onCreate||e.onDelete||e.onMove||e.onRename))throw new Error("React Arborist Tree => You passed the initialData prop along with a data handler.\nUse the data prop if you want to provide your own handlers.");if(e.initialData){const[t,n]=function(e){const[t,n]=o.useState(e),r=o.useMemo((()=>new _m(t)),[t]);return[t,{onMove:e=>{for(const t of e.dragIds)r.move({id:t,parentId:e.parentId,index:e.index});n(r.data)},onRename:({name:e,id:t})=>{r.update({id:t,changes:{name:e}}),n(r.data)},onCreate:({parentId:e,index:t,type:i})=>{const o={id:"simple-tree-id-"+qm++,name:""};return"internal"===i&&(o.children=[]),r.create({parentId:e,index:t,data:o}),n(r.data),o},onDelete:e=>{e.ids.forEach((e=>r.drop({id:e}))),n(r.data)}}]}(e.initialData);return Object.assign(Object.assign(Object.assign({},e),n),{data:t})}return e}const Lm=o.forwardRef((function(e,t){const n=Am(e);return c.jsxs(Em,{treeProps:n,imperativeHandle:t,children:[c.jsx(km,{children:c.jsx(Pm,{})}),c.jsx(Nm,{})]})}));export{ht as B,bd as C,Ge as G,sd as K,Hl as L,xd as M,Je as P,pt as S,Lm as T,td as a,ud as b,wd as c,ed as d,lt as e,cd as f,pd as g,ql as h,Vl as i,Ot as j,hd as k,zl as l,Fl as m,xt as n,ad as o,nd as p,rd as q,id as r,Ql as s,St as t,gt as u,Rt as v,Xe as w,_m as x};
